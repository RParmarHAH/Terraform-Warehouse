resource "snowflake_view" "DISC_DATA_CLEANSING_CLIENT_STANDARDIZED_ADDRESSES_INCNSTNT" {
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "DATA_CLEANSING"
	name = "CLIENT_STANDARDIZED_ADDRESSES_INCNSTNT"
	statement = <<-SQL
	 (
SELECT X.ADDRESS ,X.CITY,X.STATE,X.ZIP ,count(*) FROM  
	(SELECT DISTINCT 
	ADDRESS,
	CITY,
	STATE,
	ZIP,
	POINTS,
	LATITUDE,
	LONGITUDE,
	LABEL,
	ADDRESS_NUMBER,
	STREET,
	MUNICIPALITY,
	REGION,
	SUB_REGION,
	COUNTRY_CODE,
	ZIPCODE,
	PLUS_FOUR_CODE,
	RELEVANCE
	FROM DISC_${var.SF_ENVIRONMENT}.DATA_CLEANSING.CLIENT_STANDARDIZED_ADDRESSES 
	WHERE zip = ZIPCODE )X 
	GROUP BY 1,2,3,4 HAVING count(*) > 1);
SQL
	or_replace = true 
	is_secure = false 
}

