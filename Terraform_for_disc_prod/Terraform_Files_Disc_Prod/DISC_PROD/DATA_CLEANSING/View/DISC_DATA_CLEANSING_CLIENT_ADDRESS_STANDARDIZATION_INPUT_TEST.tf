resource "snowflake_view" "DISC_DATA_CLEANSING_CLIENT_ADDRESS_STANDARDIZATION_INPUT_TEST" {
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "DATA_CLEANSING"
	name = "CLIENT_ADDRESS_STANDARDIZATION_INPUT_TEST"
	statement = <<-SQL
	 SELECT SOURCE_SYSTEM_ID, SYSTEM_CODE, CLIENT_ID, 
       CLIENT_FIRST_NAME, CLIENT_LAST_NAME, 
       SRC_CLIENT_ADDRESS AS Address, SRC_CLIENT_CITY AS City, SRC_CLIENT_STATE_CODE AS State, TRIM( LEFT( SRC_CLIENT_ZIP, 5)) AS Zip
FROM DISC_Prod.Data_Cleansing.Client_Src_Attributes
WHERE SRC_CLIENT_MAX_ACTIVITY_DATE >= CAST( '2022-09-01' AS DATE)
AND SRC_Client_Address_Processed_Flag = 'FALSE'
AND SRC_CLIENT_Address_Processed_Flag = 'FALSE'
AND Src_CLIENT_Address IS NOT NULL AND TRIM(Src_CLIENT_Address) <> ''
AND ((Src_CLIENT_City IS NOT NULL AND TRIM(Src_CLIENT_City) <> '' 
AND Src_CLIENT_State_Code IS NOT NULL AND TRIM(Src_CLIENT_State_Code) <> '') 
OR (Src_CLIENT_Zip IS NOT NULL AND TRIM(Src_CLIENT_Zip) <> '' AND TRIM(Src_CLIENT_Zip) <> 'None'))
AND CLIENT_ID IS NOT NULL AND CLIENT_ID <> ''
AND CLIENT_FIRST_NAME IS NOT NULL AND CLIENT_FIRST_NAME <> ''
AND CLIENT_LAST_NAME IS NOT NULL AND CLIENT_LAST_NAME <> ''
ORDER BY System_Code, Client_Last_Name;
SQL
	or_replace = true 
	is_secure = false 
}

