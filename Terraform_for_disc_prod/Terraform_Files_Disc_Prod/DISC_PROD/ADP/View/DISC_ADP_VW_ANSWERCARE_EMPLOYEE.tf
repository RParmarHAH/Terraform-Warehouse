resource "snowflake_view" "DISC_ADP_VW_ANSWERCARE_EMPLOYEE" {
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "ADP"
	name = "VW_ANSWERCARE_EMPLOYEE"
	statement = <<-SQL
	 
SELECT DISTINCT 
	FILE_NUMBER AS ID,
	FILE_NUMBER AS EMPLOYEE_NUMBER,
	'ADP-ANSWERCARE' AS COMPANY,
	TRIM(REPLACE(TAX_ID, '-')) AS EMPLOYEE_SSN,
	TRIM(UPPER(SPLIT_PART(NAME, ',', 2))) AS EMPLOYEE_FIRST_NAME,
	UPPER(TRIM(SPLIT_PART(SPLIT_PART(AP."NAME", ',', 2), ' ', 3))) AS EMPLOYEE_MIDDLE_NAME,
	REPLACE(TRIM(UPPER(SPLIT_PART(NAME, ',', 1))), '-', ' ') AS EMPLOYEE_LAST_NAME,
	HIRE_DATE::DATE AS EMPLOYEE_HIRE_DATE,
	REHIRE_DATE::DATE AS EMPLOYEE_REHIRE_DATE,
	TERMINATION_DATE::DATE AS EMPLOYEE_TERMINATE_DATE,
	CASE
		WHEN AP.STATUS = 'T-Terminated' THEN FALSE
		WHEN AP.STATUS IN ('A-Active', 'L-Leave') THEN TRUE
		ELSE NULL
	END AS ACTIVE_EMPLOYEE_FLAG
FROM DISC_${var.SF_ENVIRONMENT}.ADP.ANSWERCARE_PAYROLL AP;
SQL
	or_replace = true 
	is_secure = false 
}

