resource "snowflake_procedure" "DISC_PARADOX_GET_CANDIDATE_SPECIFIC" {
	name ="GET_CANDIDATE_SPECIFIC"
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "PARADOX"
	language  = "SQL"

	arguments {
		name = "TASKKEY"
		type = "VARCHAR(16777216)"
}	
	return_type = "VARCHAR(16777216)"
	execute_as = "OWNER"
	statement = <<-EOT

--*****************************************************************************************************************************
-- NAME:  GET_CANDIDATE_SPECIFIC 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE				AUTHOR										NOTES:
-- ----------		-------------------							-----------------------------------------------------------------------------------------------
-- 2023-11-20		KOMAL DHOKAI/RAVI SUTHAR					INITIAL DEVELOPMENT
--*****************************************************************************************************************************

 
BEGIN 
    --TARGETSQL
    COPY INTO DISC_${var.SF_ENVIRONMENT}.PARADOX.HIST_CANDIDATE_SPECIFIC FROM (SELECT  A.$1 CANDIDATE_FIRST_NAME, A.$2 CANDIDATE_LAST_NAME, A.$3 CANDIDATE_PHONE, A.$4 CANDIDATE_EMAIL, A.$5 CANDIDATE_ID, A.$6 APPLICATION_ID, A.$7 REQUISITION_ID, A.$8 CAPTURE_START_DATE, A.$9 CAPTURE_COMPLETE_DATE, A.$10 TALK_TIME, A.$11 JOB_CATEGORY, A.$12 PAST_JOB_CATEGORY, A.$13 CONVERSATION, A.$14 CONVERSATION_TYPE, A.$15 KEYWORD, A.$16 LOCATION_NAME, A.$17 PAST_LOCATION_NAME, A.$18 REPLIED_TO, A.$19 DATE_TIME_REPLIED_TO, A.$20 SCHEDULED, A.$21 DATE_TIME_REQUEST_SENT, A.$22 TIME_FROM_START_TO_SCHEDULE, A.$23 DATE_TIME_SCHEDULED, A.$24 RECRUITER, A.$25 STATUS, A.$26 SOURCE, A.$27 CANDIDATE_SOURCED_FROM_NAME, A.$28 SOURCE_ID, A.$29 CANDIDATE_EXTERNAL_ID_1, A.$30 CANDIDATE_EXTERNAL_ID_2, A.$31 CANDIDATE_EXTERNAL_ID_3, A.$32 RESUME, A.$33 CHAT_TO_APPLY, A.$34 SCHEDULING_OPTIN_PENDING, A.$35 CANDIDATE_LANGUAGE, A.$36 SMS_REMINDERS_SENT, A.$37 EMAIL_REMINDERS_SENT, A.$38 CONVERSATION_REMINDER_OPTOUT, A.$39 JOB_TITLE, A.$40 JOB_CITY, A.$41 JOB_STATE, A.$42 CANDIDATE_LOCATION_ID, A.$43 CANDIDATE_LOCATION_CITY, A.$44 CANDIDATE_LOCATION_STATE, A.$45 CANDIDATE_LOCATION_STATE_CODE, A.$46 CANDIDATE_LOCATION_COUNTRY, A.$47 CANDIDATE_LOCATION__LEVEL_1, A.$48 CANDIDATE_LOCATION__LEVEL_2, A.$49 CANDIDATE_LOCATION__LEVEL_3, A.$50 UNSUBSCRIBED, A.$51 CANDIDATE_ASSOCIATED_TO__USERS_FULL_NAME, A.$52 CANDIDATE_ASSOCIATED_TO__USERS_EMAIL, A.$53 CANDIDATE_ASSOCIATED_TO__USERS_PHONE_NUMBER, A.$54 CANDIDATE_TIMEZONE, A.$55 MEDIUM_ID, A.$56 CAMPAIGN_ID, A.$57 TERM_ID, A.$58 CONTENT_ID, A.$59 REFERRALS__PROFILE_ID_MATCH, A.$60 RECORDED_VIDEO_INTERVIEW, A.$61 RECORDED_VIDEO_RESPONSE_COUNT, A.$62 RECORDED_VIDEO_QUESTIONS_SENT, A.$63 ALL_RECORDED_VIDEO_ANSWERS_WITHIN_24_HOURS, A.$64 ASSISTANT_NAME, A.$65 ENGAGED_RECRUITER_TA_USERS, A.$66 TOTAL_PARADOX_VIDEO_MEETINGS, A.$67 TOTAL_PARADOX_VIDEO_DURATION_IN_MINUTES, A.$68 CURRENT_CANDIDATE_JOURNEY_STATUS, A.$69 SHORTCODE_PHONE_NUMBER, A.$70 PROFILE_ID, A.$71 MULTIPLE_RECORDS, A.$72 PRIMARY_IDENTIFIER, A.$73 REAPPLY_IN_CAPTURE, A.$74 REAPPLY_IN_JOB_SEARCH, A.$75 REAPPLY_IN_CAMPAIGN, A.$76 PAY_RATE, A.$77 STREET_ADDRESS, A.$78 STREET_ADDRESS_LINE_2, A.$79 CITY, A.$80 STATE, A.$81 ZIP_CODE, A.$82 SSN, A.$83 COMPANY_BRAND, A.$84 COUNTRY, A.$85 EDUCATION_1_CURRENT, A.$86 EDUCATION_2_CURRENT, A.$87 EDUCATION_3_CURRENT, A.$88 EDUCATION_1_DEGREE, A.$89 EDUCATION_2_DEGREE, A.$90 EDUCATION_3_DEGREE, TRY_TO_DATE(A.$91) EDUCATION_1_END_DATE, TRY_TO_DATE(A.$92) EDUCATION_2_END_DATE, TRY_TO_DATE(A.$93) EDUCATION_3_END_DATE, A.$94 EDUCATION_1_MAJOR, A.$95 EXPERIENCE_3_JOB_TYPE, A.$96 EDUCATION_2_MAJOR, A.$97 EDUCATION_3_MAJOR, A.$98 EDUCATION_1_INSTITUTION, A.$99 EDUCATION_2_INSTITUTION, A.$100 EDUCATION_3_INSTITUTION, TRY_TO_DATE(A.$101) EDUCATION_1_START_DATE, TRY_TO_DATE(A.$102) EDUCATION_2_START_DATE, TRY_TO_DATE(A.$103) EDUCATION_3_START_DATE, A.$104 EEO_DISABILITY, A.$105 EEO_ETHNICITY, A.$106 EEO_GENDER, A.$107 EEO_RACE, A.$108 EEO_VETERAN, A.$109 EMAIL, A.$110 EXPERIENCE_1_COMPANY, A.$111 EXPERIENCE_2_COMPANY, A.$112 EXPERIENCE_3_COMPANY, A.$113 EXPERIENCE_1_CURRENT, A.$114 EXPERIENCE_2_CURRENT, A.$115 EXPERIENCE_3_CURRENT, TRY_TO_DATE(A.$116) EXPERIENCE_1_END_DATE, TRY_TO_DATE(A.$117) EXPERIENCE_2_END_DATE, TRY_TO_DATE(A.$118) EXPERIENCE_3_END_DATE, A.$119 EXPERIENCE_1_LOCATION, A.$120 EXPERIENCE_2_LOCATION, A.$121 EXPERIENCE_3_LOCATION, TRY_TO_DATE(A.$122) EXPERIENCE_1_START_DATE, TRY_TO_DATE(A.$123) EXPERIENCE_2_START_DATE, TRY_TO_DATE(A.$124) EXPERIENCE_3_START_DATE, A.$125 EXPERIENCE_1_TITLE, A.$126 EXPERIENCE_2_TITLE, A.$127 EXPERIENCE_3_TITLE, A.$128 EXPERIENCE_1_JOB_TYPE, A.$129 EXPERIENCE_2_JOB_TYPE, A.$130 INTERNAL_CANDIDATE, A.$131 INTERNAL_JOB, TRY_TO_DATE(A.$132) OFFER_ACCEPTED_DATE, TRY_TO_DATE(A.$133) OFFER_CREATED_DATE, A.$134 ONBOARDING_ASSIGNMENT, A.$135 PHONE_NUMBER, TRY_TO_DATE(A.$136) START_DATE, A.$137 __APPLICATION_ID, A.$138 __EX_ID_1, :TASKKEY AS ETL_TASK_KEY, :TASKKEY AS ETL_INSERTED_TASK_KEY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, CURRENT_USER() AS ETL_INSERTED_BY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, CURRENT_USER() AS ETL_LAST_UPDATED_BY,0 AS ETL_DELETED_FLAG FROM @DISC_${var.SF_ENVIRONMENT}.STAGE.AWSAZSTAGEPROD/PARADOX/Upload_file/CaptureCandidate.Specific(FILE_FORMAT => DISC_${var.SF_ENVIRONMENT}.STAGE.CSV_FORMAT) A);

    --VIEWSQL
    MERGE INTO DISC_${var.SF_ENVIRONMENT}.PARADOX.CANDIDATE_SPECIFIC TGT  USING ( SELECT * FROM DISC_${var.SF_ENVIRONMENT}.PARADOX.HIST_CANDIDATE_SPECIFIC WHERE CANDIDATE_ID <> 0 AND ETL_LAST_UPDATED_DATE = ( SELECT MAX(ETL_LAST_UPDATED_DATE) FROM DISC_${var.SF_ENVIRONMENT}.PARADOX.HIST_CANDIDATE_SPECIFIC) ) STAGE  ON TGT.CANDIDATE_ID = STAGE.CANDIDATE_ID WHEN MATCHED THEN  UPDATE SET  TGT.CANDIDATE_FIRST_NAME = STAGE.CANDIDATE_FIRST_NAME, TGT.CANDIDATE_LAST_NAME = STAGE.CANDIDATE_LAST_NAME, TGT.CANDIDATE_PHONE = STAGE.CANDIDATE_PHONE, TGT.CANDIDATE_EMAIL = STAGE.CANDIDATE_EMAIL, TGT.CANDIDATE_ID = STAGE.CANDIDATE_ID, TGT.APPLICATION_ID = STAGE.APPLICATION_ID, TGT.REQUISITION_ID = STAGE.REQUISITION_ID, TGT.CAPTURE_START_DATE = STAGE.CAPTURE_START_DATE, TGT.CAPTURE_COMPLETE_DATE = STAGE.CAPTURE_COMPLETE_DATE, TGT.TALK_TIME = STAGE.TALK_TIME, TGT.JOB_CATEGORY = STAGE.JOB_CATEGORY, TGT.PAST_JOB_CATEGORY = STAGE.PAST_JOB_CATEGORY, TGT.CONVERSATION = STAGE.CONVERSATION, TGT.CONVERSATION_TYPE = STAGE.CONVERSATION_TYPE, TGT.KEYWORD = STAGE.KEYWORD, TGT.LOCATION_NAME = STAGE.LOCATION_NAME, TGT.PAST_LOCATION_NAME = STAGE.PAST_LOCATION_NAME, TGT.REPLIED_TO = STAGE.REPLIED_TO, TGT.DATE_TIME_REPLIED_TO = STAGE.DATE_TIME_REPLIED_TO, TGT.SCHEDULED = STAGE.SCHEDULED, TGT.DATE_TIME_REQUEST_SENT = STAGE.DATE_TIME_REQUEST_SENT, TGT.TIME_FROM_START_TO_SCHEDULE = STAGE.TIME_FROM_START_TO_SCHEDULE, TGT.DATE_TIME_SCHEDULED = STAGE.DATE_TIME_SCHEDULED, TGT.RECRUITER = STAGE.RECRUITER, TGT.STATUS = STAGE.STATUS, TGT.SOURCE = STAGE.SOURCE, TGT.CANDIDATE_SOURCED_FROM_NAME = STAGE.CANDIDATE_SOURCED_FROM_NAME, TGT.SOURCE_ID = STAGE.SOURCE_ID, TGT.CANDIDATE_EXTERNAL_ID_1 = STAGE.CANDIDATE_EXTERNAL_ID_1, TGT.CANDIDATE_EXTERNAL_ID_2 = STAGE.CANDIDATE_EXTERNAL_ID_2, TGT.CANDIDATE_EXTERNAL_ID_3 = STAGE.CANDIDATE_EXTERNAL_ID_3, TGT.RESUME = STAGE.RESUME, TGT.CHAT_TO_APPLY = STAGE.CHAT_TO_APPLY, TGT.SCHEDULING_OPTIN_PENDING = STAGE.SCHEDULING_OPTIN_PENDING, TGT.CANDIDATE_LANGUAGE = STAGE.CANDIDATE_LANGUAGE, TGT.SMS_REMINDERS_SENT = STAGE.SMS_REMINDERS_SENT, TGT.EMAIL_REMINDERS_SENT = STAGE.EMAIL_REMINDERS_SENT, TGT.CONVERSATION_REMINDER_OPTOUT = STAGE.CONVERSATION_REMINDER_OPTOUT, TGT.JOB_TITLE = STAGE.JOB_TITLE, TGT.JOB_CITY = STAGE.JOB_CITY, TGT.JOB_STATE = STAGE.JOB_STATE, TGT.CANDIDATE_LOCATION_ID = STAGE.CANDIDATE_LOCATION_ID, TGT.CANDIDATE_LOCATION_CITY = STAGE.CANDIDATE_LOCATION_CITY, TGT.CANDIDATE_LOCATION_STATE = STAGE.CANDIDATE_LOCATION_STATE, TGT.CANDIDATE_LOCATION_STATE_CODE = STAGE.CANDIDATE_LOCATION_STATE_CODE, TGT.CANDIDATE_LOCATION_COUNTRY = STAGE.CANDIDATE_LOCATION_COUNTRY, TGT.CANDIDATE_LOCATION__LEVEL_1 = STAGE.CANDIDATE_LOCATION__LEVEL_1, TGT.CANDIDATE_LOCATION__LEVEL_2 = STAGE.CANDIDATE_LOCATION__LEVEL_2, TGT.CANDIDATE_LOCATION__LEVEL_3 = STAGE.CANDIDATE_LOCATION__LEVEL_3, TGT.UNSUBSCRIBED = STAGE.UNSUBSCRIBED, TGT.CANDIDATE_ASSOCIATED_TO__USERS_FULL_NAME = STAGE.CANDIDATE_ASSOCIATED_TO__USERS_FULL_NAME, TGT.CANDIDATE_ASSOCIATED_TO__USERS_EMAIL = STAGE.CANDIDATE_ASSOCIATED_TO__USERS_EMAIL, TGT.CANDIDATE_ASSOCIATED_TO__USERS_PHONE_NUMBER = STAGE.CANDIDATE_ASSOCIATED_TO__USERS_PHONE_NUMBER, TGT.CANDIDATE_TIMEZONE = STAGE.CANDIDATE_TIMEZONE, TGT.MEDIUM_ID = STAGE.MEDIUM_ID, TGT.CAMPAIGN_ID = STAGE.CAMPAIGN_ID, TGT.TERM_ID = STAGE.TERM_ID, TGT.CONTENT_ID = STAGE.CONTENT_ID, TGT.REFERRALS__PROFILE_ID_MATCH = STAGE.REFERRALS__PROFILE_ID_MATCH, TGT.RECORDED_VIDEO_INTERVIEW = STAGE.RECORDED_VIDEO_INTERVIEW, TGT.RECORDED_VIDEO_RESPONSE_COUNT = STAGE.RECORDED_VIDEO_RESPONSE_COUNT, TGT.RECORDED_VIDEO_QUESTIONS_SENT = STAGE.RECORDED_VIDEO_QUESTIONS_SENT, TGT.ALL_RECORDED_VIDEO_ANSWERS_WITHIN_24_HOURS = STAGE.ALL_RECORDED_VIDEO_ANSWERS_WITHIN_24_HOURS, TGT.ASSISTANT_NAME = STAGE.ASSISTANT_NAME, TGT.ENGAGED_RECRUITER_TA_USERS = STAGE.ENGAGED_RECRUITER_TA_USERS, TGT.TOTAL_PARADOX_VIDEO_MEETINGS = STAGE.TOTAL_PARADOX_VIDEO_MEETINGS, TGT.TOTAL_PARADOX_VIDEO_DURATION_IN_MINUTES = STAGE.TOTAL_PARADOX_VIDEO_DURATION_IN_MINUTES, TGT.CURRENT_CANDIDATE_JOURNEY_STATUS = STAGE.CURRENT_CANDIDATE_JOURNEY_STATUS, TGT.SHORTCODE_PHONE_NUMBER = STAGE.SHORTCODE_PHONE_NUMBER, TGT.PROFILE_ID = STAGE.PROFILE_ID, TGT.MULTIPLE_RECORDS = STAGE.MULTIPLE_RECORDS, TGT.PRIMARY_IDENTIFIER = STAGE.PRIMARY_IDENTIFIER, TGT.REAPPLY_IN_CAPTURE = STAGE.REAPPLY_IN_CAPTURE, TGT.REAPPLY_IN_JOB_SEARCH = STAGE.REAPPLY_IN_JOB_SEARCH, TGT.REAPPLY_IN_CAMPAIGN = STAGE.REAPPLY_IN_CAMPAIGN, TGT.PAY_RATE = STAGE.PAY_RATE, TGT.STREET_ADDRESS = STAGE.STREET_ADDRESS, TGT.STREET_ADDRESS_LINE_2 = STAGE.STREET_ADDRESS_LINE_2, TGT.CITY = STAGE.CITY, TGT.STATE = STAGE.STATE, TGT.ZIP_CODE = STAGE.ZIP_CODE, TGT.SSN = STAGE.SSN, TGT.COMPANY_BRAND = STAGE.COMPANY_BRAND, TGT.COUNTRY = STAGE.COUNTRY, TGT.EDUCATION_1_CURRENT = STAGE.EDUCATION_1_CURRENT, TGT.EDUCATION_2_CURRENT = STAGE.EDUCATION_2_CURRENT, TGT.EDUCATION_3_CURRENT = STAGE.EDUCATION_3_CURRENT, TGT.EDUCATION_1_DEGREE = STAGE.EDUCATION_1_DEGREE, TGT.EDUCATION_2_DEGREE = STAGE.EDUCATION_2_DEGREE, TGT.EDUCATION_3_DEGREE = STAGE.EDUCATION_3_DEGREE, TGT.EDUCATION_1_END_DATE = STAGE.EDUCATION_1_END_DATE, TGT.EDUCATION_2_END_DATE = STAGE.EDUCATION_2_END_DATE, TGT.EDUCATION_3_END_DATE = STAGE.EDUCATION_3_END_DATE, TGT.EDUCATION_1_MAJOR = STAGE.EDUCATION_1_MAJOR, TGT.EXPERIENCE_3_JOB_TYPE = STAGE.EXPERIENCE_3_JOB_TYPE, TGT.EDUCATION_2_MAJOR = STAGE.EDUCATION_2_MAJOR, TGT.EDUCATION_3_MAJOR = STAGE.EDUCATION_3_MAJOR, TGT.EDUCATION_1_INSTITUTION = STAGE.EDUCATION_1_INSTITUTION, TGT.EDUCATION_2_INSTITUTION = STAGE.EDUCATION_2_INSTITUTION, TGT.EDUCATION_3_INSTITUTION = STAGE.EDUCATION_3_INSTITUTION, TGT.EDUCATION_1_START_DATE = STAGE.EDUCATION_1_START_DATE, TGT.EDUCATION_2_START_DATE = STAGE.EDUCATION_2_START_DATE, TGT.EDUCATION_3_START_DATE = STAGE.EDUCATION_3_START_DATE, TGT.EEO_DISABILITY = STAGE.EEO_DISABILITY, TGT.EEO_ETHNICITY = STAGE.EEO_ETHNICITY, TGT.EEO_GENDER = STAGE.EEO_GENDER, TGT.EEO_RACE = STAGE.EEO_RACE, TGT.EEO_VETERAN = STAGE.EEO_VETERAN, TGT.EMAIL = STAGE.EMAIL, TGT.EXPERIENCE_1_COMPANY = STAGE.EXPERIENCE_1_COMPANY, TGT.EXPERIENCE_2_COMPANY = STAGE.EXPERIENCE_2_COMPANY, TGT.EXPERIENCE_3_COMPANY = STAGE.EXPERIENCE_3_COMPANY, TGT.EXPERIENCE_1_CURRENT = STAGE.EXPERIENCE_1_CURRENT, TGT.EXPERIENCE_2_CURRENT = STAGE.EXPERIENCE_2_CURRENT, TGT.EXPERIENCE_3_CURRENT = STAGE.EXPERIENCE_3_CURRENT, TGT.EXPERIENCE_1_END_DATE = STAGE.EXPERIENCE_1_END_DATE, TGT.EXPERIENCE_2_END_DATE = STAGE.EXPERIENCE_2_END_DATE, TGT.EXPERIENCE_3_END_DATE = STAGE.EXPERIENCE_3_END_DATE, TGT.EXPERIENCE_1_LOCATION = STAGE.EXPERIENCE_1_LOCATION, TGT.EXPERIENCE_2_LOCATION = STAGE.EXPERIENCE_2_LOCATION, TGT.EXPERIENCE_3_LOCATION = STAGE.EXPERIENCE_3_LOCATION, TGT.EXPERIENCE_1_START_DATE = STAGE.EXPERIENCE_1_START_DATE, TGT.EXPERIENCE_2_START_DATE = STAGE.EXPERIENCE_2_START_DATE, TGT.EXPERIENCE_3_START_DATE = STAGE.EXPERIENCE_3_START_DATE, TGT.EXPERIENCE_1_TITLE = STAGE.EXPERIENCE_1_TITLE, TGT.EXPERIENCE_2_TITLE = STAGE.EXPERIENCE_2_TITLE, TGT.EXPERIENCE_3_TITLE = STAGE.EXPERIENCE_3_TITLE, TGT.EXPERIENCE_1_JOB_TYPE = STAGE.EXPERIENCE_1_JOB_TYPE, TGT.EXPERIENCE_2_JOB_TYPE = STAGE.EXPERIENCE_2_JOB_TYPE, TGT.INTERNAL_CANDIDATE = STAGE.INTERNAL_CANDIDATE, TGT.INTERNAL_JOB = STAGE.INTERNAL_JOB, TGT.OFFER_ACCEPTED_DATE = STAGE.OFFER_ACCEPTED_DATE, TGT.OFFER_CREATED_DATE = STAGE.OFFER_CREATED_DATE, TGT.ONBOARDING_ASSIGNMENT = STAGE.ONBOARDING_ASSIGNMENT, TGT.PHONE_NUMBER = STAGE.PHONE_NUMBER, TGT.START_DATE = STAGE.START_DATE, TGT.__APPLICATION_ID = STAGE.__APPLICATION_ID, TGT.__EX_ID_1 = STAGE.__EX_ID_1 ,TGT.ETL_TASK_KEY= STAGE.ETL_TASK_KEY ,TGT.ETL_LAST_UPDATED_DATE= STAGE.ETL_LAST_UPDATED_DATE ,TGT.ETL_LAST_UPDATED_BY= STAGE.ETL_LAST_UPDATED_BY ,TGT.ETL_DELETED_FLAG= STAGE.ETL_DELETED_FLAG::NUMBER WHEN NOT MATCHED THEN  INSERT ( CANDIDATE_FIRST_NAME, CANDIDATE_LAST_NAME, CANDIDATE_PHONE, CANDIDATE_EMAIL, CANDIDATE_ID, APPLICATION_ID, REQUISITION_ID, CAPTURE_START_DATE, CAPTURE_COMPLETE_DATE, TALK_TIME, JOB_CATEGORY, PAST_JOB_CATEGORY, CONVERSATION, CONVERSATION_TYPE, KEYWORD, LOCATION_NAME, PAST_LOCATION_NAME, REPLIED_TO, DATE_TIME_REPLIED_TO, SCHEDULED, DATE_TIME_REQUEST_SENT, TIME_FROM_START_TO_SCHEDULE, DATE_TIME_SCHEDULED, RECRUITER, STATUS, SOURCE, CANDIDATE_SOURCED_FROM_NAME, SOURCE_ID, CANDIDATE_EXTERNAL_ID_1, CANDIDATE_EXTERNAL_ID_2, CANDIDATE_EXTERNAL_ID_3, RESUME, CHAT_TO_APPLY, SCHEDULING_OPTIN_PENDING, CANDIDATE_LANGUAGE, SMS_REMINDERS_SENT, EMAIL_REMINDERS_SENT, CONVERSATION_REMINDER_OPTOUT, JOB_TITLE, JOB_CITY, JOB_STATE, CANDIDATE_LOCATION_ID, CANDIDATE_LOCATION_CITY, CANDIDATE_LOCATION_STATE, CANDIDATE_LOCATION_STATE_CODE, CANDIDATE_LOCATION_COUNTRY, CANDIDATE_LOCATION__LEVEL_1, CANDIDATE_LOCATION__LEVEL_2, CANDIDATE_LOCATION__LEVEL_3, UNSUBSCRIBED, CANDIDATE_ASSOCIATED_TO__USERS_FULL_NAME, CANDIDATE_ASSOCIATED_TO__USERS_EMAIL, CANDIDATE_ASSOCIATED_TO__USERS_PHONE_NUMBER, CANDIDATE_TIMEZONE, MEDIUM_ID, CAMPAIGN_ID, TERM_ID, CONTENT_ID, REFERRALS__PROFILE_ID_MATCH, RECORDED_VIDEO_INTERVIEW, RECORDED_VIDEO_RESPONSE_COUNT, RECORDED_VIDEO_QUESTIONS_SENT, ALL_RECORDED_VIDEO_ANSWERS_WITHIN_24_HOURS, ASSISTANT_NAME, ENGAGED_RECRUITER_TA_USERS, TOTAL_PARADOX_VIDEO_MEETINGS, TOTAL_PARADOX_VIDEO_DURATION_IN_MINUTES, CURRENT_CANDIDATE_JOURNEY_STATUS, SHORTCODE_PHONE_NUMBER, PROFILE_ID, MULTIPLE_RECORDS, PRIMARY_IDENTIFIER, REAPPLY_IN_CAPTURE, REAPPLY_IN_JOB_SEARCH, REAPPLY_IN_CAMPAIGN, PAY_RATE, STREET_ADDRESS, STREET_ADDRESS_LINE_2, CITY, STATE, ZIP_CODE, SSN, COMPANY_BRAND, COUNTRY, EDUCATION_1_CURRENT, EDUCATION_2_CURRENT, EDUCATION_3_CURRENT, EDUCATION_1_DEGREE, EDUCATION_2_DEGREE, EDUCATION_3_DEGREE, EDUCATION_1_END_DATE, EDUCATION_2_END_DATE, EDUCATION_3_END_DATE, EDUCATION_1_MAJOR, EXPERIENCE_3_JOB_TYPE, EDUCATION_2_MAJOR, EDUCATION_3_MAJOR, EDUCATION_1_INSTITUTION, EDUCATION_2_INSTITUTION, EDUCATION_3_INSTITUTION, EDUCATION_1_START_DATE, EDUCATION_2_START_DATE, EDUCATION_3_START_DATE, EEO_DISABILITY, EEO_ETHNICITY, EEO_GENDER, EEO_RACE, EEO_VETERAN, EMAIL, EXPERIENCE_1_COMPANY, EXPERIENCE_2_COMPANY, EXPERIENCE_3_COMPANY, EXPERIENCE_1_CURRENT, EXPERIENCE_2_CURRENT, EXPERIENCE_3_CURRENT, EXPERIENCE_1_END_DATE, EXPERIENCE_2_END_DATE, EXPERIENCE_3_END_DATE, EXPERIENCE_1_LOCATION, EXPERIENCE_2_LOCATION, EXPERIENCE_3_LOCATION, EXPERIENCE_1_START_DATE, EXPERIENCE_2_START_DATE, EXPERIENCE_3_START_DATE, EXPERIENCE_1_TITLE, EXPERIENCE_2_TITLE, EXPERIENCE_3_TITLE, EXPERIENCE_1_JOB_TYPE, EXPERIENCE_2_JOB_TYPE, INTERNAL_CANDIDATE, INTERNAL_JOB, OFFER_ACCEPTED_DATE, OFFER_CREATED_DATE, ONBOARDING_ASSIGNMENT, PHONE_NUMBER, START_DATE, __APPLICATION_ID, __EX_ID_1, ETL_TASK_KEY, ETL_INSERTED_TASK_KEY, ETL_INSERTED_DATE, ETL_INSERTED_BY, ETL_LAST_UPDATED_DATE, ETL_LAST_UPDATED_BY, ETL_DELETED_FLAG )  VALUES ( STAGE.CANDIDATE_FIRST_NAME, STAGE.CANDIDATE_LAST_NAME, STAGE.CANDIDATE_PHONE, STAGE.CANDIDATE_EMAIL, STAGE.CANDIDATE_ID, STAGE.APPLICATION_ID, STAGE.REQUISITION_ID, STAGE.CAPTURE_START_DATE, STAGE.CAPTURE_COMPLETE_DATE, STAGE.TALK_TIME, STAGE.JOB_CATEGORY, STAGE.PAST_JOB_CATEGORY, STAGE.CONVERSATION, STAGE.CONVERSATION_TYPE, STAGE.KEYWORD, STAGE.LOCATION_NAME, STAGE.PAST_LOCATION_NAME, STAGE.REPLIED_TO, STAGE.DATE_TIME_REPLIED_TO, STAGE.SCHEDULED, STAGE.DATE_TIME_REQUEST_SENT, STAGE.TIME_FROM_START_TO_SCHEDULE, STAGE.DATE_TIME_SCHEDULED, STAGE.RECRUITER, STAGE.STATUS, STAGE.SOURCE, STAGE.CANDIDATE_SOURCED_FROM_NAME, STAGE.SOURCE_ID, STAGE.CANDIDATE_EXTERNAL_ID_1, STAGE.CANDIDATE_EXTERNAL_ID_2, STAGE.CANDIDATE_EXTERNAL_ID_3, STAGE.RESUME, STAGE.CHAT_TO_APPLY, STAGE.SCHEDULING_OPTIN_PENDING, STAGE.CANDIDATE_LANGUAGE, STAGE.SMS_REMINDERS_SENT, STAGE.EMAIL_REMINDERS_SENT, STAGE.CONVERSATION_REMINDER_OPTOUT, STAGE.JOB_TITLE, STAGE.JOB_CITY, STAGE.JOB_STATE, STAGE.CANDIDATE_LOCATION_ID, STAGE.CANDIDATE_LOCATION_CITY, STAGE.CANDIDATE_LOCATION_STATE, STAGE.CANDIDATE_LOCATION_STATE_CODE, STAGE.CANDIDATE_LOCATION_COUNTRY, STAGE.CANDIDATE_LOCATION__LEVEL_1, STAGE.CANDIDATE_LOCATION__LEVEL_2, STAGE.CANDIDATE_LOCATION__LEVEL_3, STAGE.UNSUBSCRIBED, STAGE.CANDIDATE_ASSOCIATED_TO__USERS_FULL_NAME, STAGE.CANDIDATE_ASSOCIATED_TO__USERS_EMAIL, STAGE.CANDIDATE_ASSOCIATED_TO__USERS_PHONE_NUMBER, STAGE.CANDIDATE_TIMEZONE, STAGE.MEDIUM_ID, STAGE.CAMPAIGN_ID, STAGE.TERM_ID, STAGE.CONTENT_ID, STAGE.REFERRALS__PROFILE_ID_MATCH, STAGE.RECORDED_VIDEO_INTERVIEW, STAGE.RECORDED_VIDEO_RESPONSE_COUNT, STAGE.RECORDED_VIDEO_QUESTIONS_SENT, STAGE.ALL_RECORDED_VIDEO_ANSWERS_WITHIN_24_HOURS, STAGE.ASSISTANT_NAME, STAGE.ENGAGED_RECRUITER_TA_USERS, STAGE.TOTAL_PARADOX_VIDEO_MEETINGS, STAGE.TOTAL_PARADOX_VIDEO_DURATION_IN_MINUTES, STAGE.CURRENT_CANDIDATE_JOURNEY_STATUS, STAGE.SHORTCODE_PHONE_NUMBER, STAGE.PROFILE_ID, STAGE.MULTIPLE_RECORDS, STAGE.PRIMARY_IDENTIFIER, STAGE.REAPPLY_IN_CAPTURE, STAGE.REAPPLY_IN_JOB_SEARCH, STAGE.REAPPLY_IN_CAMPAIGN, STAGE.PAY_RATE, STAGE.STREET_ADDRESS, STAGE.STREET_ADDRESS_LINE_2, STAGE.CITY, STAGE.STATE, STAGE.ZIP_CODE, STAGE.SSN, STAGE.COMPANY_BRAND, STAGE.COUNTRY, STAGE.EDUCATION_1_CURRENT, STAGE.EDUCATION_2_CURRENT, STAGE.EDUCATION_3_CURRENT, STAGE.EDUCATION_1_DEGREE, STAGE.EDUCATION_2_DEGREE, STAGE.EDUCATION_3_DEGREE, STAGE.EDUCATION_1_END_DATE, STAGE.EDUCATION_2_END_DATE, STAGE.EDUCATION_3_END_DATE, STAGE.EDUCATION_1_MAJOR, STAGE.EXPERIENCE_3_JOB_TYPE, STAGE.EDUCATION_2_MAJOR, STAGE.EDUCATION_3_MAJOR, STAGE.EDUCATION_1_INSTITUTION, STAGE.EDUCATION_2_INSTITUTION, STAGE.EDUCATION_3_INSTITUTION, STAGE.EDUCATION_1_START_DATE, STAGE.EDUCATION_2_START_DATE, STAGE.EDUCATION_3_START_DATE, STAGE.EEO_DISABILITY, STAGE.EEO_ETHNICITY, STAGE.EEO_GENDER, STAGE.EEO_RACE, STAGE.EEO_VETERAN, STAGE.EMAIL, STAGE.EXPERIENCE_1_COMPANY, STAGE.EXPERIENCE_2_COMPANY, STAGE.EXPERIENCE_3_COMPANY, STAGE.EXPERIENCE_1_CURRENT, STAGE.EXPERIENCE_2_CURRENT, STAGE.EXPERIENCE_3_CURRENT, STAGE.EXPERIENCE_1_END_DATE, STAGE.EXPERIENCE_2_END_DATE, STAGE.EXPERIENCE_3_END_DATE, STAGE.EXPERIENCE_1_LOCATION, STAGE.EXPERIENCE_2_LOCATION, STAGE.EXPERIENCE_3_LOCATION, STAGE.EXPERIENCE_1_START_DATE, STAGE.EXPERIENCE_2_START_DATE, STAGE.EXPERIENCE_3_START_DATE, STAGE.EXPERIENCE_1_TITLE, STAGE.EXPERIENCE_2_TITLE, STAGE.EXPERIENCE_3_TITLE, STAGE.EXPERIENCE_1_JOB_TYPE, STAGE.EXPERIENCE_2_JOB_TYPE, STAGE.INTERNAL_CANDIDATE, STAGE.INTERNAL_JOB, STAGE.OFFER_ACCEPTED_DATE, STAGE.OFFER_CREATED_DATE, STAGE.ONBOARDING_ASSIGNMENT, STAGE.PHONE_NUMBER, STAGE.START_DATE, STAGE.__APPLICATION_ID, STAGE.__EX_ID_1, STAGE.ETL_TASK_KEY, STAGE.ETL_INSERTED_TASK_KEY, STAGE.ETL_INSERTED_DATE, STAGE.ETL_INSERTED_BY, STAGE.ETL_LAST_UPDATED_DATE, STAGE.ETL_LAST_UPDATED_BY, STAGE.ETL_DELETED_FLAG::NUMBER );

    RETURN ''SUCCESS'';
END;


 EOT
}

