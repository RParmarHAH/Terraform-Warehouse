resource "snowflake_view" "DISC_GENERATIONSALLIANCE_VW_BRANCH_MAPPING" {
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "GENERATIONSALLIANCE"
	name = "VW_BRANCH_MAPPING"
	statement = <<-SQL
	 SELECT
	LT.STR_LOCATIONID,
	MP.NAME,
	MP.ADDRESS1,
	MP.ADDRESS2,
	MP.PHONENUMBER,
	MP.TOLLFREEPHONE,
	MP.FAX,
	MP.STATE,
	MP.CITY,
	MP.ZIP,
	MP.STATE_CODE,
	MP.PARENT_BRANCH_NAME,
	MP.PARENT_FLAG::BOOLEAN AS PARENT_FLAG,
	MP.PARENT_BRANCH_CODE
FROM
	DISC_${var.SF_ENVIRONMENT}.GENERATIONSALLIANCE.TBL_LOCATION LT
LEFT JOIN DISC_${var.SF_ENVIRONMENT}.GENERATIONSALLIANCE.LOCATION_MAPPING MP ON
	LT.STR_LOCATIONID = MP.LOCATION_ID
	WHERE LT.STR_LOCATIONID NOT IN ('ZBO');
SQL
	or_replace = true 
	is_secure = false 
}

