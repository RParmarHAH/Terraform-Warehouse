resource "snowflake_procedure" "DISC_CCSI_GENERATE_FLAGS_MASTERCLIENT" {
	name ="GENERATE_FLAGS_MASTERCLIENT"
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "CCSI"
	language  = "JAVASCRIPT"
	return_type = "VARCHAR(16777216)"
	execute_as = "OWNER"
	statement = <<-EOT

  var rs1 = snowflake.execute( { sqlText: 
      `CREATE OR REPLACE TABLE DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT_CLONED AS 
		(SELECT * 
		FROM
			(SELECT * 
			FROM
				(SELECT RECORD_NUMBER,CCU_CONTRACT,CCU_AGREEMENT,CCU_PROGRAM_TYPE,CLIENT_IDOA_NO,LAST_NAME,FIRST_NAME,RELOOK_EARLY_WARNING_FLAG,ADDRESS1,ADDRESS2,CITY,ZIP,DETERMINATION_DATE,ASSESSMENT_SCORE,INITIAL_SERVICE_DATE,AVAIL_INCOME,NUMBER_RECEIVING,SERVED_BY_FAMILY_MEMBER,FEE_SCHEDULE,A_TYPE_SERVICE,ACTION_TYPE,ACTION_DATE,VENDOR_MAX,VENDOR_FEIN_AG_PT,UNUSED_3,NSP_FLAG,UNUSED_6,UNUSED_4,UNUSED_14,USED_FOR_AREA,SERVU50_FLAG,UNUSED_6_2,UNUSED_4_2,UNUSED_14_2,COMBINED_CLIENT_NAME,UPDATE_FLAG,SERVICE_1_UNITS,SERVICE_2_UNITS,SERVICE_3_UNITS,PHONE_NO,COPAY_Y_N_P,COPAY,EMPLOYEE_NO,DESK_NO_ASSIGNED_SERV_COORD,DOB,SEX,COPAY_RESPONSIBLE_PARTY,ADDRESS,PHONE,RELATIONSHIP,CITY_2,STATE,ZIP_2,CASE_ACTION_DATE,AREA,PRIVATE_PAY_RATE,FAMILY_REASON,MEDICAID_RECP_Y_N_P,CCU_LOOKUP_ID,COUNTY,CCU_FEIN,EMERGENCY_PHONE_CONTACT,EMERGENCY_NAME_CONTACT,PRIVATE_PAY_BILLING_CYCLE,LAST_BILLING_DATE,NEW_FIELD_OLD_SSN,HMKR_NAME,CASE_MGR,CPT_NO_VET_MCO,DIAG_NO_VET_MCO,MULTIPLE_CLIENT_FLAG,CHOPPED_COMBINED_NAME,MCO_AUTHORITY_ENDS_DATE,LANGUAGE,RACE,SHARED_CODE,CITY_OPTED_OUT,SCHED,CORP_FLAG,SERVU60,ACTION_BY_USER,REGION_AREA,CASE_MGR_PHONE,CREATED_DATE,CREATED_BY,UPDATED_DATE,UPDATED_BY,CREATED_ON,CREATED_BY_2,UPDATED_ON,UPDATED_BY_2,ETL_TASK_KEY,ETL_INSERTED_TASK_KEY,ETL_INSERTED_DATE,ETL_INSERTED_BY,ETL_LAST_UPDATED_DATE,ETL_LAST_UPDATED_BY,ETL_DELETED_FLAG,INCREMENTAL_FLAG 
				FROM 
					(SELECT ROW_NUMBER() OVER (PARTITION BY IFF(TRY_TO_NUMERIC(LEFT(COMBINED_CLIENT_NAME,1)) IS NULL,COMBINED_CLIENT_NAME,SUBSTRING(COMBINED_CLIENT_NAME,2,LEN(COMBINED_CLIENT_NAME))),CREATED_DATE ORDER BY ETL_LAST_UPDATED_DATE DESC) AS RNUM,* FROM HIST_MASTERCLIENT) T1
				WHERE RNUM=1) T2  
			WHERE TRY_TO_NUMERIC(LEFT(COMBINED_CLIENT_NAME,1)) IS NULL AND INCREMENTAL_FLAG<>''DELETED'') T3);`
       } );

  var rs2 = snowflake.execute( { sqlText: 
      `INSERT INTO DISC_${var.SF_ENVIRONMENT}.CCSI.SOURCE_MASTERCLIENT
		SELECT
		wm.$1	AS RECORD_NUMBER,
		wm.$6          	AS CCU_CONTRACT,
		wm.$7          	AS CCU_AGREEMENT,
		wm.$8          	AS CCU_PROGRAM_TYPE,
		wm.$9          	AS CLIENT_IDOA_NO,
		wm.$10         	AS LAST_NAME,
		wm.$11         	AS FIRST_NAME,
		wm.$12         	AS RELOOK_EARLY_WARNING_FLAG,
		wm.$13         	AS ADDRESS1,
		wm.$14         	AS ADDRESS2,
		wm.$15         	AS CITY,
		wm.$16         	AS ZIP,
		wm.$17         	AS DETERMINATION_DATE,
		wm.$18         	AS ASSESSMENT_SCORE,
		wm.$19         	AS INITIAL_SERVICE_DATE,
		wm.$20         	AS AVAIL_INCOME,
		wm.$21         	AS NUMBER_RECEIVING,
		wm.$22         	AS SERVED_BY_FAMILY_MEMBER,
		wm.$23         	AS FEE_SCHEDULE,
		wm.$24         	AS A_TYPE_SERVICE,
		wm.$25         	AS ACTION_TYPE,
		wm.$26         	AS ACTION_DATE,
		wm.$27         	AS VENDOR_MAX,
		wm.$28         	AS VENDOR_FEIN_AG_PT,
		wm.$29         	AS UNUSED_3,
		wm.$30	AS NSP_FLAG,
		wm.$31	AS UNUSED_6,
		wm.$32	AS UNUSED_4,
		wm.$33	AS UNUSED_14,
		wm.$34	AS USED_FOR_AREA,
		wm.$35	AS SERVU50_FLAG,
		wm.$36	AS UNUSED_6_2,
		wm.$37	AS UNUSED_4_2,
		wm.$38	AS UNUSED_14_2,
		wm.$39	AS COMBINED_CLIENT_NAME,
		wm.$40	AS UPDATE_FLAG,
		wm.$41	AS SERVICE_1_UNITS,
		wm.$42	AS SERVICE_2_UNITS,
		wm.$43	AS SERVICE_3_UNITS,
		wm.$44	AS PHONE_NO,
		wm.$45	AS COPAY_Y_N_P,
		wm.$46	AS COPAY,
		wm.$47	AS EMPLOYEE_NO,
		wm.$48	AS DESK_NO_ASSIGNED_SERV_COORD,
		wm.$49	AS DOB,
		wm.$50	AS SEX,
		wm.$51	AS COPAY_RESPONSIBLE_PARTY,
		wm.$52	AS ADDRESS,
		wm.$53	AS PHONE,
		wm.$54	AS RELATIONSHIP,
		wm.$55	AS CITY_2,
		wm.$56	AS STATE,
		wm.$57	AS ZIP_2,
		wm.$58	AS CASE_ACTION_DATE,
		wm.$59	AS AREA,
		wm.$60	AS PRIVATE_PAY_RATE,
		wm.$65	AS FAMILY_REASON,
		wm.$66	AS MEDICAID_RECP_Y_N_P,
		wm.$67	AS CCU_LOOKUP_ID,
		wm.$68	AS COUNTY,
		wm.$69	AS CCU_FEIN,
		wm.$70	AS EMERGENCY_PHONE_CONTACT,
		wm.$71	AS EMERGENCY_NAME_CONTACT,
		wm.$72	AS PRIVATE_PAY_BILLING_CYCLE,
		wm.$73	AS LAST_BILLING_DATE,
		wm.$74	AS NEW_FIELD_OLD_SSN,
		wm.$75	AS HMKR_NAME,
		wm.$76	AS CASE_MGR,
		wm.$77	AS CPT_NO_VET_MCO,
		wm.$78	AS DIAG_NO_VET_MCO,
		wm.$79	AS MULTIPLE_CLIENT_FLAG,
		wm.$80	AS CHOPPED_COMBINED_NAME,
		wm.$81	AS MCO_AUTHORITY_ENDS_DATE,
		wm.$82	AS LANGUAGE,
		wm.$83	AS RACE,
		wm.$84	AS SHARED_CODE,
		wm.$85	AS CITY_OPTED_OUT,
		wm.$86	AS SCHED,
		wm.$87	AS CORP_FLAG,
		wm.$88	AS SERVU60,
		wm.$89	AS ACTION_BY_USER,
		wm.$90	AS REGION_AREA,
		wm.$91	AS CASE_MGR_PHONE,
		wm.$2	AS CREATED_DATE,
		wm.$3	AS CREATED_BY,
		wm.$4	AS UPDATED_DATE,
		wm.$5	AS UPDATED_BY,
		wm.$61	AS CREATED_ON,
		wm.$62	AS CREATED_BY_2,
		wm.$63	AS UPDATED_ON,
		wm.$64	AS UPDATED_BY_2,
		NULL	AS ETL_TASK_KEY,
		NULL	AS ETL_INSERTED_TASK_KEY,
		CURRENT_TIMESTAMP()	AS ETL_INSERTED_DATE,
		CURRENT_USER()	AS ETL_INSERTED_BY,
		CURRENT_TIMESTAMP()	AS ETL_LAST_UPDATED_DATE,
		CURRENT_USER()	AS ETL_LAST_UPDATED_BY,
		0	AS ETL_DELETED_FLAG,	
		NULL AS INCREMENTAL_FLAG
		FROM @DISC_${var.SF_ENVIRONMENT}.STAGE.AZSTAGEPROD/fjn/masterclient(file_format => DW_${var.SF_ENVIRONMENT}.PUBLIC.tab_format,PATTERN => ''.*\\.csv'')wm 
		WHERE concat(wm.$1,''|'',wm.$6)NOT IN (''161|U120404402'',''2500|U129607962'',''3194|U129607962'');`} );

	var rs3 = snowflake.execute( { sqlText: 
      `UPDATE DISC_${var.SF_ENVIRONMENT}.CCSI.SOURCE_MASTERCLIENT SET COMBINED_CLIENT_NAME=IFNULL(last_name,'''')||'' ''||IFNULL(FIRST_NAME,'''')
		WHERE IFNULL(last_name,'''')||'' ''||IFNULL(FIRST_NAME,'''') <>IFNULL(COMBINED_CLIENT_NAME,'''');`
       } );

	var rs3 = snowflake.execute( { sqlText: 
      `INSERT INTO DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT_CLONED 
		SELECT RECORD_NUMBER,CCU_CONTRACT,CCU_AGREEMENT,CCU_PROGRAM_TYPE,CLIENT_IDOA_NO,LAST_NAME,FIRST_NAME,RELOOK_EARLY_WARNING_FLAG,ADDRESS1,ADDRESS2,CITY,ZIP,DETERMINATION_DATE,ASSESSMENT_SCORE,INITIAL_SERVICE_DATE,AVAIL_INCOME,NUMBER_RECEIVING,SERVED_BY_FAMILY_MEMBER,FEE_SCHEDULE,A_TYPE_SERVICE,ACTION_TYPE,ACTION_DATE,VENDOR_MAX,VENDOR_FEIN_AG_PT,UNUSED_3,NSP_FLAG,UNUSED_6,UNUSED_4,UNUSED_14,USED_FOR_AREA,SERVU50_FLAG,UNUSED_6_2,UNUSED_4_2,UNUSED_14_2,COMBINED_CLIENT_NAME,UPDATE_FLAG,SERVICE_1_UNITS,SERVICE_2_UNITS,SERVICE_3_UNITS,PHONE_NO,COPAY_Y_N_P,COPAY,EMPLOYEE_NO,DESK_NO_ASSIGNED_SERV_COORD,DOB,SEX,COPAY_RESPONSIBLE_PARTY,ADDRESS,PHONE,RELATIONSHIP,CITY_2,STATE,ZIP_2,CASE_ACTION_DATE,AREA,PRIVATE_PAY_RATE,FAMILY_REASON,MEDICAID_RECP_Y_N_P,CCU_LOOKUP_ID,COUNTY,CCU_FEIN,EMERGENCY_PHONE_CONTACT,EMERGENCY_NAME_CONTACT,PRIVATE_PAY_BILLING_CYCLE,LAST_BILLING_DATE,NEW_FIELD_OLD_SSN,HMKR_NAME,CASE_MGR,CPT_NO_VET_MCO,DIAG_NO_VET_MCO,MULTIPLE_CLIENT_FLAG,CHOPPED_COMBINED_NAME,MCO_AUTHORITY_ENDS_DATE,LANGUAGE,RACE,SHARED_CODE,CITY_OPTED_OUT,SCHED,CORP_FLAG,SERVU60,ACTION_BY_USER,REGION_AREA,CASE_MGR_PHONE,CREATED_DATE,CREATED_BY,UPDATED_DATE,UPDATED_BY,CREATED_ON,CREATED_BY_2,UPDATED_ON,UPDATED_BY_2,ETL_TASK_KEY,ETL_INSERTED_TASK_KEY,ETL_INSERTED_DATE,ETL_INSERTED_BY,ETL_LAST_UPDATED_DATE,ETL_LAST_UPDATED_BY,ETL_DELETED_FLAG,''DELETED'' 
		FROM HIST_MASTERCLIENT_CLONED 
		WHERE CONCAT(IFNULL(COMBINED_CLIENT_NAME,''''),''|'',IFNULL(CREATED_DATE,'''')) NOT IN (SELECT CONCAT(IFNULL(COMBINED_CLIENT_NAME,''''),''|'',IFNULL(CREATED_DATE,'''')) FROM SOURCE_MASTERCLIENT)
		AND CONCAT(IFNULL(COMBINED_CLIENT_NAME,''''),''|'',IFNULL(CREATED_DATE,'''')) NOT IN (SELECT CONCAT(IFNULL(IFF(TRY_TO_NUMERIC(LEFT(COMBINED_CLIENT_NAME,1)) IS  NULL,COMBINED_CLIENT_NAME,SUBSTRING(COMBINED_CLIENT_NAME,2,LEN(COMBINED_CLIENT_NAME))),''''),''|'',IFNULL(CREATED_DATE,'''')) FROM SOURCE_MASTERCLIENT);`
       } );

	var rs4 = snowflake.execute( { sqlText: 
      `MERGE INTO DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT_CLONED USING DISC_${var.SF_ENVIRONMENT}.CCSI.SOURCE_MASTERCLIENT ON CONCAT(IFNULL(HIST_MASTERCLIENT_CLONED.COMBINED_CLIENT_NAME,''''),''|'',IFNULL(HIST_MASTERCLIENT_CLONED.CREATED_DATE,''''))=CONCAT(IFNULL(SOURCE_MASTERCLIENT.COMBINED_CLIENT_NAME,''''),''|'',IFNULL(SOURCE_MASTERCLIENT.CREATED_DATE,''''))
WHEN MATCHED AND 
	(
	IFNULL(HIST_MASTERCLIENT_CLONED.CLIENT_IDOA_NO,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CLIENT_IDOA_NO,'''') AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_CONTRACT,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CCU_CONTRACT,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_AGREEMENT,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CCU_AGREEMENT,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_PROGRAM_TYPE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CCU_PROGRAM_TYPE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.LAST_NAME,'''')	=	IFNULL(SOURCE_MASTERCLIENT.LAST_NAME,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.FIRST_NAME,'''')	=	IFNULL(SOURCE_MASTERCLIENT.FIRST_NAME,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.RELOOK_EARLY_WARNING_FLAG,'''')	=	IFNULL(SOURCE_MASTERCLIENT.RELOOK_EARLY_WARNING_FLAG,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ADDRESS1,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ADDRESS1,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ADDRESS2,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ADDRESS2,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CITY,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CITY,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ZIP,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ZIP,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.DETERMINATION_DATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.DETERMINATION_DATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ASSESSMENT_SCORE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ASSESSMENT_SCORE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.INITIAL_SERVICE_DATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.INITIAL_SERVICE_DATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.AVAIL_INCOME,'''')	=	IFNULL(SOURCE_MASTERCLIENT.AVAIL_INCOME,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.NUMBER_RECEIVING,'''')	=	IFNULL(SOURCE_MASTERCLIENT.NUMBER_RECEIVING,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVED_BY_FAMILY_MEMBER,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SERVED_BY_FAMILY_MEMBER,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.FEE_SCHEDULE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.FEE_SCHEDULE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.A_TYPE_SERVICE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.A_TYPE_SERVICE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ACTION_TYPE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ACTION_TYPE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ACTION_DATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ACTION_DATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.VENDOR_MAX,'''')	=	IFNULL(SOURCE_MASTERCLIENT.VENDOR_MAX,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.VENDOR_FEIN_AG_PT,'''')	=	IFNULL(SOURCE_MASTERCLIENT.VENDOR_FEIN_AG_PT,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_3,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UNUSED_3,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.NSP_FLAG,'''')	=	IFNULL(SOURCE_MASTERCLIENT.NSP_FLAG,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_6,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UNUSED_6,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_4,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UNUSED_4,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_14,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UNUSED_14,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.USED_FOR_AREA,'''')	=	IFNULL(SOURCE_MASTERCLIENT.USED_FOR_AREA,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVU50_FLAG,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SERVU50_FLAG,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_6_2,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UNUSED_6_2,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_4_2,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UNUSED_4_2,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_14_2,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UNUSED_14_2,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATE_FLAG,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UPDATE_FLAG,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVICE_1_UNITS,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SERVICE_1_UNITS,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVICE_2_UNITS,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SERVICE_2_UNITS,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVICE_3_UNITS,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SERVICE_3_UNITS,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.PHONE_NO,'''')	=	IFNULL(SOURCE_MASTERCLIENT.PHONE_NO,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.COPAY_Y_N_P,'''')	=	IFNULL(SOURCE_MASTERCLIENT.COPAY_Y_N_P,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.COPAY,'''')	=	IFNULL(SOURCE_MASTERCLIENT.COPAY,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.EMPLOYEE_NO,'''')	=	IFNULL(SOURCE_MASTERCLIENT.EMPLOYEE_NO,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.DESK_NO_ASSIGNED_SERV_COORD,'''')	=	IFNULL(SOURCE_MASTERCLIENT.DESK_NO_ASSIGNED_SERV_COORD,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.DOB,'''')	=	IFNULL(SOURCE_MASTERCLIENT.DOB,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SEX,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SEX,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.COPAY_RESPONSIBLE_PARTY,'''')	=	IFNULL(SOURCE_MASTERCLIENT.COPAY_RESPONSIBLE_PARTY,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ADDRESS,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ADDRESS,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.PHONE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.PHONE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.RELATIONSHIP,'''')	=	IFNULL(SOURCE_MASTERCLIENT.RELATIONSHIP,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CITY_2,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CITY_2,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.STATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.STATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ZIP_2,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ZIP_2,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CASE_ACTION_DATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CASE_ACTION_DATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.AREA,'''')	=	IFNULL(SOURCE_MASTERCLIENT.AREA,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.PRIVATE_PAY_RATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.PRIVATE_PAY_RATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.FAMILY_REASON,'''')	=	IFNULL(SOURCE_MASTERCLIENT.FAMILY_REASON,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.MEDICAID_RECP_Y_N_P,'''')	=	IFNULL(SOURCE_MASTERCLIENT.MEDICAID_RECP_Y_N_P,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_LOOKUP_ID,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CCU_LOOKUP_ID,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.COUNTY,'''')	=	IFNULL(SOURCE_MASTERCLIENT.COUNTY,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_FEIN,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CCU_FEIN,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.EMERGENCY_PHONE_CONTACT,'''')	=	IFNULL(SOURCE_MASTERCLIENT.EMERGENCY_PHONE_CONTACT,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.EMERGENCY_NAME_CONTACT,'''')	=	IFNULL(SOURCE_MASTERCLIENT.EMERGENCY_NAME_CONTACT,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.PRIVATE_PAY_BILLING_CYCLE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.PRIVATE_PAY_BILLING_CYCLE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.LAST_BILLING_DATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.LAST_BILLING_DATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.NEW_FIELD_OLD_SSN,'''')	=	IFNULL(SOURCE_MASTERCLIENT.NEW_FIELD_OLD_SSN,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.HMKR_NAME,'''')	=	IFNULL(SOURCE_MASTERCLIENT.HMKR_NAME,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CASE_MGR,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CASE_MGR,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CPT_NO_VET_MCO,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CPT_NO_VET_MCO,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.DIAG_NO_VET_MCO,'''')	=	IFNULL(SOURCE_MASTERCLIENT.DIAG_NO_VET_MCO,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.MULTIPLE_CLIENT_FLAG,'''')	=	IFNULL(SOURCE_MASTERCLIENT.MULTIPLE_CLIENT_FLAG,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CHOPPED_COMBINED_NAME,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CHOPPED_COMBINED_NAME,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.MCO_AUTHORITY_ENDS_DATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.MCO_AUTHORITY_ENDS_DATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.LANGUAGE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.LANGUAGE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.RACE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.RACE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SHARED_CODE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SHARED_CODE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CITY_OPTED_OUT,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CITY_OPTED_OUT,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SCHED,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SCHED,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CORP_FLAG,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CORP_FLAG,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVU60,'''')	=	IFNULL(SOURCE_MASTERCLIENT.SERVU60,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.ACTION_BY_USER,'''')	=	IFNULL(SOURCE_MASTERCLIENT.ACTION_BY_USER,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.REGION_AREA,'''')	=	IFNULL(SOURCE_MASTERCLIENT.REGION_AREA,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CASE_MGR_PHONE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CASE_MGR_PHONE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CREATED_BY,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CREATED_BY,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATED_DATE,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UPDATED_DATE,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATED_BY,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UPDATED_BY,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CREATED_ON,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CREATED_ON,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.CREATED_BY_2,'''')	=	IFNULL(SOURCE_MASTERCLIENT.CREATED_BY_2,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATED_ON,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UPDATED_ON,'''')	AND
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATED_BY_2,'''')	=	IFNULL(SOURCE_MASTERCLIENT.UPDATED_BY_2,'''')) 
THEN UPDATE SET HIST_MASTERCLIENT_CLONED.INCREMENTAL_FLAG=''IDENTICAL''
WHEN MATCHED AND 
	(
	IFNULL(HIST_MASTERCLIENT_CLONED.CLIENT_IDOA_NO,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CLIENT_IDOA_NO,'''') OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_CONTRACT,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CCU_CONTRACT,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_AGREEMENT,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CCU_AGREEMENT,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_PROGRAM_TYPE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CCU_PROGRAM_TYPE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.LAST_NAME,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.LAST_NAME,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.FIRST_NAME,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.FIRST_NAME,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.RELOOK_EARLY_WARNING_FLAG,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.RELOOK_EARLY_WARNING_FLAG,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ADDRESS1,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ADDRESS1,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ADDRESS2,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ADDRESS2,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CITY,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CITY,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ZIP,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ZIP,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.DETERMINATION_DATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.DETERMINATION_DATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ASSESSMENT_SCORE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ASSESSMENT_SCORE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.INITIAL_SERVICE_DATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.INITIAL_SERVICE_DATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.AVAIL_INCOME,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.AVAIL_INCOME,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.NUMBER_RECEIVING,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.NUMBER_RECEIVING,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVED_BY_FAMILY_MEMBER,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SERVED_BY_FAMILY_MEMBER,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.FEE_SCHEDULE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.FEE_SCHEDULE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.A_TYPE_SERVICE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.A_TYPE_SERVICE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ACTION_TYPE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ACTION_TYPE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ACTION_DATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ACTION_DATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.VENDOR_MAX,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.VENDOR_MAX,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.VENDOR_FEIN_AG_PT,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.VENDOR_FEIN_AG_PT,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_3,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UNUSED_3,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.NSP_FLAG,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.NSP_FLAG,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_6,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UNUSED_6,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_4,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UNUSED_4,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_14,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UNUSED_14,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.USED_FOR_AREA,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.USED_FOR_AREA,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVU50_FLAG,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SERVU50_FLAG,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_6_2,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UNUSED_6_2,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_4_2,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UNUSED_4_2,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UNUSED_14_2,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UNUSED_14_2,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATE_FLAG,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UPDATE_FLAG,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVICE_1_UNITS,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SERVICE_1_UNITS,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVICE_2_UNITS,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SERVICE_2_UNITS,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVICE_3_UNITS,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SERVICE_3_UNITS,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.PHONE_NO,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.PHONE_NO,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.COPAY_Y_N_P,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.COPAY_Y_N_P,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.COPAY,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.COPAY,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.EMPLOYEE_NO,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.EMPLOYEE_NO,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.DESK_NO_ASSIGNED_SERV_COORD,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.DESK_NO_ASSIGNED_SERV_COORD,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.DOB,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.DOB,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SEX,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SEX,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.COPAY_RESPONSIBLE_PARTY,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.COPAY_RESPONSIBLE_PARTY,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ADDRESS,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ADDRESS,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.PHONE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.PHONE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.RELATIONSHIP,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.RELATIONSHIP,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CITY_2,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CITY_2,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.STATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.STATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ZIP_2,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ZIP_2,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CASE_ACTION_DATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CASE_ACTION_DATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.AREA,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.AREA,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.PRIVATE_PAY_RATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.PRIVATE_PAY_RATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.FAMILY_REASON,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.FAMILY_REASON,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.MEDICAID_RECP_Y_N_P,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.MEDICAID_RECP_Y_N_P,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_LOOKUP_ID,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CCU_LOOKUP_ID,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.COUNTY,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.COUNTY,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CCU_FEIN,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CCU_FEIN,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.EMERGENCY_PHONE_CONTACT,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.EMERGENCY_PHONE_CONTACT,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.EMERGENCY_NAME_CONTACT,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.EMERGENCY_NAME_CONTACT,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.PRIVATE_PAY_BILLING_CYCLE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.PRIVATE_PAY_BILLING_CYCLE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.LAST_BILLING_DATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.LAST_BILLING_DATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.NEW_FIELD_OLD_SSN,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.NEW_FIELD_OLD_SSN,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.HMKR_NAME,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.HMKR_NAME,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CASE_MGR,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CASE_MGR,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CPT_NO_VET_MCO,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CPT_NO_VET_MCO,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.DIAG_NO_VET_MCO,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.DIAG_NO_VET_MCO,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.MULTIPLE_CLIENT_FLAG,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.MULTIPLE_CLIENT_FLAG,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CHOPPED_COMBINED_NAME,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CHOPPED_COMBINED_NAME,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.MCO_AUTHORITY_ENDS_DATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.MCO_AUTHORITY_ENDS_DATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.LANGUAGE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.LANGUAGE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.RACE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.RACE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SHARED_CODE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SHARED_CODE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CITY_OPTED_OUT,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CITY_OPTED_OUT,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SCHED,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SCHED,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CORP_FLAG,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CORP_FLAG,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.SERVU60,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.SERVU60,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.ACTION_BY_USER,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.ACTION_BY_USER,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.REGION_AREA,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.REGION_AREA,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CASE_MGR_PHONE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CASE_MGR_PHONE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CREATED_BY,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CREATED_BY,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATED_DATE,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UPDATED_DATE,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATED_BY,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UPDATED_BY,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CREATED_ON,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CREATED_ON,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.CREATED_BY_2,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.CREATED_BY_2,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATED_ON,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UPDATED_ON,'''')	OR
	IFNULL(HIST_MASTERCLIENT_CLONED.UPDATED_BY_2,'''')	<>	IFNULL(SOURCE_MASTERCLIENT.UPDATED_BY_2,'''')) 
THEN UPDATE SET 
	HIST_MASTERCLIENT_CLONED.INCREMENTAL_FLAG=''CHANGED'',
	HIST_MASTERCLIENT_CLONED.ETL_LAST_UPDATED_DATE=CURRENT_TIMESTAMP(),
	HIST_MASTERCLIENT_CLONED.CLIENT_IDOA_NO	=	SOURCE_MASTERCLIENT.CLIENT_IDOA_NO,
	HIST_MASTERCLIENT_CLONED.CCU_CONTRACT	=	SOURCE_MASTERCLIENT.CCU_CONTRACT,
	HIST_MASTERCLIENT_CLONED.CCU_AGREEMENT	=	SOURCE_MASTERCLIENT.CCU_AGREEMENT,
	HIST_MASTERCLIENT_CLONED.CCU_PROGRAM_TYPE	=	SOURCE_MASTERCLIENT.CCU_PROGRAM_TYPE,
	HIST_MASTERCLIENT_CLONED.LAST_NAME	=	SOURCE_MASTERCLIENT.LAST_NAME,
	HIST_MASTERCLIENT_CLONED.FIRST_NAME	=	SOURCE_MASTERCLIENT.FIRST_NAME,
	HIST_MASTERCLIENT_CLONED.RELOOK_EARLY_WARNING_FLAG	=	SOURCE_MASTERCLIENT.RELOOK_EARLY_WARNING_FLAG,
	HIST_MASTERCLIENT_CLONED.ADDRESS1	=	SOURCE_MASTERCLIENT.ADDRESS1,
	HIST_MASTERCLIENT_CLONED.ADDRESS2	=	SOURCE_MASTERCLIENT.ADDRESS2,
	HIST_MASTERCLIENT_CLONED.CITY	=	SOURCE_MASTERCLIENT.CITY,
	HIST_MASTERCLIENT_CLONED.ZIP	=	SOURCE_MASTERCLIENT.ZIP,
	HIST_MASTERCLIENT_CLONED.DETERMINATION_DATE	=	SOURCE_MASTERCLIENT.DETERMINATION_DATE,
	HIST_MASTERCLIENT_CLONED.ASSESSMENT_SCORE	=	SOURCE_MASTERCLIENT.ASSESSMENT_SCORE,
	HIST_MASTERCLIENT_CLONED.INITIAL_SERVICE_DATE	=	SOURCE_MASTERCLIENT.INITIAL_SERVICE_DATE,
	HIST_MASTERCLIENT_CLONED.AVAIL_INCOME	=	SOURCE_MASTERCLIENT.AVAIL_INCOME,
	HIST_MASTERCLIENT_CLONED.NUMBER_RECEIVING	=	SOURCE_MASTERCLIENT.NUMBER_RECEIVING,
	HIST_MASTERCLIENT_CLONED.SERVED_BY_FAMILY_MEMBER	=	SOURCE_MASTERCLIENT.SERVED_BY_FAMILY_MEMBER,
	HIST_MASTERCLIENT_CLONED.FEE_SCHEDULE	=	SOURCE_MASTERCLIENT.FEE_SCHEDULE,
	HIST_MASTERCLIENT_CLONED.A_TYPE_SERVICE	=	SOURCE_MASTERCLIENT.A_TYPE_SERVICE,
	HIST_MASTERCLIENT_CLONED.ACTION_TYPE	=	SOURCE_MASTERCLIENT.ACTION_TYPE,
	HIST_MASTERCLIENT_CLONED.ACTION_DATE	=	SOURCE_MASTERCLIENT.ACTION_DATE,
	HIST_MASTERCLIENT_CLONED.VENDOR_MAX	=	SOURCE_MASTERCLIENT.VENDOR_MAX,
	HIST_MASTERCLIENT_CLONED.VENDOR_FEIN_AG_PT	=	SOURCE_MASTERCLIENT.VENDOR_FEIN_AG_PT,
	HIST_MASTERCLIENT_CLONED.UNUSED_3	=	SOURCE_MASTERCLIENT.UNUSED_3,
	HIST_MASTERCLIENT_CLONED.NSP_FLAG	=	SOURCE_MASTERCLIENT.NSP_FLAG,
	HIST_MASTERCLIENT_CLONED.UNUSED_6	=	SOURCE_MASTERCLIENT.UNUSED_6,
	HIST_MASTERCLIENT_CLONED.UNUSED_4	=	SOURCE_MASTERCLIENT.UNUSED_4,
	HIST_MASTERCLIENT_CLONED.UNUSED_14	=	SOURCE_MASTERCLIENT.UNUSED_14,
	HIST_MASTERCLIENT_CLONED.USED_FOR_AREA	=	SOURCE_MASTERCLIENT.USED_FOR_AREA,
	HIST_MASTERCLIENT_CLONED.SERVU50_FLAG	=	SOURCE_MASTERCLIENT.SERVU50_FLAG,
	HIST_MASTERCLIENT_CLONED.UNUSED_6_2	=	SOURCE_MASTERCLIENT.UNUSED_6_2,
	HIST_MASTERCLIENT_CLONED.UNUSED_4_2	=	SOURCE_MASTERCLIENT.UNUSED_4_2,
	HIST_MASTERCLIENT_CLONED.UNUSED_14_2	=	SOURCE_MASTERCLIENT.UNUSED_14_2,
	HIST_MASTERCLIENT_CLONED.UPDATE_FLAG	=	SOURCE_MASTERCLIENT.UPDATE_FLAG,
	HIST_MASTERCLIENT_CLONED.SERVICE_1_UNITS	=	SOURCE_MASTERCLIENT.SERVICE_1_UNITS,
	HIST_MASTERCLIENT_CLONED.SERVICE_2_UNITS	=	SOURCE_MASTERCLIENT.SERVICE_2_UNITS,
	HIST_MASTERCLIENT_CLONED.SERVICE_3_UNITS	=	SOURCE_MASTERCLIENT.SERVICE_3_UNITS,
	HIST_MASTERCLIENT_CLONED.PHONE_NO	=	SOURCE_MASTERCLIENT.PHONE_NO,
	HIST_MASTERCLIENT_CLONED.COPAY_Y_N_P	=	SOURCE_MASTERCLIENT.COPAY_Y_N_P,
	HIST_MASTERCLIENT_CLONED.COPAY	=	SOURCE_MASTERCLIENT.COPAY,
	HIST_MASTERCLIENT_CLONED.EMPLOYEE_NO	=	SOURCE_MASTERCLIENT.EMPLOYEE_NO,
	HIST_MASTERCLIENT_CLONED.DESK_NO_ASSIGNED_SERV_COORD	=	SOURCE_MASTERCLIENT.DESK_NO_ASSIGNED_SERV_COORD,
	HIST_MASTERCLIENT_CLONED.DOB	=	SOURCE_MASTERCLIENT.DOB,
	HIST_MASTERCLIENT_CLONED.SEX	=	SOURCE_MASTERCLIENT.SEX,
	HIST_MASTERCLIENT_CLONED.COPAY_RESPONSIBLE_PARTY	=	SOURCE_MASTERCLIENT.COPAY_RESPONSIBLE_PARTY,
	HIST_MASTERCLIENT_CLONED.ADDRESS	=	SOURCE_MASTERCLIENT.ADDRESS,
	HIST_MASTERCLIENT_CLONED.PHONE	=	SOURCE_MASTERCLIENT.PHONE,
	HIST_MASTERCLIENT_CLONED.RELATIONSHIP	=	SOURCE_MASTERCLIENT.RELATIONSHIP,
	HIST_MASTERCLIENT_CLONED.CITY_2	=	SOURCE_MASTERCLIENT.CITY_2,
	HIST_MASTERCLIENT_CLONED.STATE	=	SOURCE_MASTERCLIENT.STATE,
	HIST_MASTERCLIENT_CLONED.ZIP_2	=	SOURCE_MASTERCLIENT.ZIP_2,
	HIST_MASTERCLIENT_CLONED.CASE_ACTION_DATE	=	SOURCE_MASTERCLIENT.CASE_ACTION_DATE,
	HIST_MASTERCLIENT_CLONED.AREA	=	SOURCE_MASTERCLIENT.AREA,
	HIST_MASTERCLIENT_CLONED.PRIVATE_PAY_RATE	=	SOURCE_MASTERCLIENT.PRIVATE_PAY_RATE,
	HIST_MASTERCLIENT_CLONED.FAMILY_REASON	=	SOURCE_MASTERCLIENT.FAMILY_REASON,
	HIST_MASTERCLIENT_CLONED.MEDICAID_RECP_Y_N_P	=	SOURCE_MASTERCLIENT.MEDICAID_RECP_Y_N_P,
	HIST_MASTERCLIENT_CLONED.CCU_LOOKUP_ID	=	SOURCE_MASTERCLIENT.CCU_LOOKUP_ID,
	HIST_MASTERCLIENT_CLONED.COUNTY	=	SOURCE_MASTERCLIENT.COUNTY,
	HIST_MASTERCLIENT_CLONED.CCU_FEIN	=	SOURCE_MASTERCLIENT.CCU_FEIN,
	HIST_MASTERCLIENT_CLONED.EMERGENCY_PHONE_CONTACT	=	SOURCE_MASTERCLIENT.EMERGENCY_PHONE_CONTACT,
	HIST_MASTERCLIENT_CLONED.EMERGENCY_NAME_CONTACT	=	SOURCE_MASTERCLIENT.EMERGENCY_NAME_CONTACT,
	HIST_MASTERCLIENT_CLONED.PRIVATE_PAY_BILLING_CYCLE	=	SOURCE_MASTERCLIENT.PRIVATE_PAY_BILLING_CYCLE,
	HIST_MASTERCLIENT_CLONED.LAST_BILLING_DATE	=	SOURCE_MASTERCLIENT.LAST_BILLING_DATE,
	HIST_MASTERCLIENT_CLONED.NEW_FIELD_OLD_SSN	=	SOURCE_MASTERCLIENT.NEW_FIELD_OLD_SSN,
	HIST_MASTERCLIENT_CLONED.HMKR_NAME	=	SOURCE_MASTERCLIENT.HMKR_NAME,
	HIST_MASTERCLIENT_CLONED.CASE_MGR	=	SOURCE_MASTERCLIENT.CASE_MGR,
	HIST_MASTERCLIENT_CLONED.CPT_NO_VET_MCO	=	SOURCE_MASTERCLIENT.CPT_NO_VET_MCO,
	HIST_MASTERCLIENT_CLONED.DIAG_NO_VET_MCO	=	SOURCE_MASTERCLIENT.DIAG_NO_VET_MCO,
	HIST_MASTERCLIENT_CLONED.MULTIPLE_CLIENT_FLAG	=	SOURCE_MASTERCLIENT.MULTIPLE_CLIENT_FLAG,
	HIST_MASTERCLIENT_CLONED.CHOPPED_COMBINED_NAME	=	SOURCE_MASTERCLIENT.CHOPPED_COMBINED_NAME,
	HIST_MASTERCLIENT_CLONED.MCO_AUTHORITY_ENDS_DATE	=	SOURCE_MASTERCLIENT.MCO_AUTHORITY_ENDS_DATE,
	HIST_MASTERCLIENT_CLONED.LANGUAGE	=	SOURCE_MASTERCLIENT.LANGUAGE,
	HIST_MASTERCLIENT_CLONED.RACE	=	SOURCE_MASTERCLIENT.RACE,
	HIST_MASTERCLIENT_CLONED.SHARED_CODE	=	SOURCE_MASTERCLIENT.SHARED_CODE,
	HIST_MASTERCLIENT_CLONED.CITY_OPTED_OUT	=	SOURCE_MASTERCLIENT.CITY_OPTED_OUT,
	HIST_MASTERCLIENT_CLONED.SCHED	=	SOURCE_MASTERCLIENT.SCHED,
	HIST_MASTERCLIENT_CLONED.CORP_FLAG	=	SOURCE_MASTERCLIENT.CORP_FLAG,
	HIST_MASTERCLIENT_CLONED.SERVU60	=	SOURCE_MASTERCLIENT.SERVU60,
	HIST_MASTERCLIENT_CLONED.ACTION_BY_USER	=	SOURCE_MASTERCLIENT.ACTION_BY_USER,
	HIST_MASTERCLIENT_CLONED.REGION_AREA	=	SOURCE_MASTERCLIENT.REGION_AREA,
	HIST_MASTERCLIENT_CLONED.CASE_MGR_PHONE	=	SOURCE_MASTERCLIENT.CASE_MGR_PHONE,
	HIST_MASTERCLIENT_CLONED.CREATED_BY	=	SOURCE_MASTERCLIENT.CREATED_BY,
	HIST_MASTERCLIENT_CLONED.UPDATED_DATE	=	SOURCE_MASTERCLIENT.UPDATED_DATE,
	HIST_MASTERCLIENT_CLONED.UPDATED_BY	=	SOURCE_MASTERCLIENT.UPDATED_BY,
	HIST_MASTERCLIENT_CLONED.CREATED_ON	=	SOURCE_MASTERCLIENT.CREATED_ON,
	HIST_MASTERCLIENT_CLONED.CREATED_BY_2	=	SOURCE_MASTERCLIENT.CREATED_BY_2,
	HIST_MASTERCLIENT_CLONED.UPDATED_ON	=	SOURCE_MASTERCLIENT.UPDATED_ON,
	HIST_MASTERCLIENT_CLONED.UPDATED_BY_2	=	SOURCE_MASTERCLIENT.UPDATED_BY_2
WHEN NOT MATCHED THEN INSERT (RECORD_NUMBER,CCU_CONTRACT,CCU_AGREEMENT,CCU_PROGRAM_TYPE,CLIENT_IDOA_NO,LAST_NAME,FIRST_NAME,RELOOK_EARLY_WARNING_FLAG,ADDRESS1,ADDRESS2,CITY,ZIP,DETERMINATION_DATE,ASSESSMENT_SCORE,INITIAL_SERVICE_DATE,AVAIL_INCOME,NUMBER_RECEIVING,SERVED_BY_FAMILY_MEMBER,FEE_SCHEDULE,A_TYPE_SERVICE,ACTION_TYPE,ACTION_DATE,VENDOR_MAX,VENDOR_FEIN_AG_PT,UNUSED_3,NSP_FLAG,UNUSED_6,UNUSED_4,UNUSED_14,USED_FOR_AREA,SERVU50_FLAG,UNUSED_6_2,UNUSED_4_2,UNUSED_14_2,COMBINED_CLIENT_NAME,UPDATE_FLAG,SERVICE_1_UNITS,SERVICE_2_UNITS,SERVICE_3_UNITS,PHONE_NO,COPAY_Y_N_P,COPAY,EMPLOYEE_NO,DESK_NO_ASSIGNED_SERV_COORD,DOB,SEX,COPAY_RESPONSIBLE_PARTY,ADDRESS,PHONE,RELATIONSHIP,CITY_2,STATE,ZIP_2,CASE_ACTION_DATE,AREA,PRIVATE_PAY_RATE,FAMILY_REASON,MEDICAID_RECP_Y_N_P,CCU_LOOKUP_ID,COUNTY,CCU_FEIN,EMERGENCY_PHONE_CONTACT,EMERGENCY_NAME_CONTACT,PRIVATE_PAY_BILLING_CYCLE,LAST_BILLING_DATE,NEW_FIELD_OLD_SSN,HMKR_NAME,CASE_MGR,CPT_NO_VET_MCO,DIAG_NO_VET_MCO,MULTIPLE_CLIENT_FLAG,CHOPPED_COMBINED_NAME,MCO_AUTHORITY_ENDS_DATE,LANGUAGE,RACE,SHARED_CODE,CITY_OPTED_OUT,SCHED,CORP_FLAG,SERVU60,ACTION_BY_USER,REGION_AREA,CASE_MGR_PHONE,CREATED_DATE,CREATED_BY,UPDATED_DATE,UPDATED_BY,CREATED_ON,CREATED_BY_2,UPDATED_ON,UPDATED_BY_2,ETL_TASK_KEY,ETL_INSERTED_TASK_KEY,ETL_INSERTED_DATE,ETL_INSERTED_BY,ETL_LAST_UPDATED_DATE,ETL_LAST_UPDATED_BY,ETL_DELETED_FLAG,INCREMENTAL_FLAG) 
VALUES(SOURCE_MASTERCLIENT.RECORD_NUMBER,SOURCE_MASTERCLIENT.CCU_CONTRACT,SOURCE_MASTERCLIENT.CCU_AGREEMENT,SOURCE_MASTERCLIENT.CCU_PROGRAM_TYPE,SOURCE_MASTERCLIENT.CLIENT_IDOA_NO,SOURCE_MASTERCLIENT.LAST_NAME,SOURCE_MASTERCLIENT.FIRST_NAME,SOURCE_MASTERCLIENT.RELOOK_EARLY_WARNING_FLAG,SOURCE_MASTERCLIENT.ADDRESS1,SOURCE_MASTERCLIENT.ADDRESS2,SOURCE_MASTERCLIENT.CITY,SOURCE_MASTERCLIENT.ZIP,SOURCE_MASTERCLIENT.DETERMINATION_DATE,SOURCE_MASTERCLIENT.ASSESSMENT_SCORE,SOURCE_MASTERCLIENT.INITIAL_SERVICE_DATE,SOURCE_MASTERCLIENT.AVAIL_INCOME,SOURCE_MASTERCLIENT.NUMBER_RECEIVING,SOURCE_MASTERCLIENT.SERVED_BY_FAMILY_MEMBER,SOURCE_MASTERCLIENT.FEE_SCHEDULE,SOURCE_MASTERCLIENT.A_TYPE_SERVICE,SOURCE_MASTERCLIENT.ACTION_TYPE,SOURCE_MASTERCLIENT.ACTION_DATE,SOURCE_MASTERCLIENT.VENDOR_MAX,SOURCE_MASTERCLIENT.VENDOR_FEIN_AG_PT,SOURCE_MASTERCLIENT.UNUSED_3,SOURCE_MASTERCLIENT.NSP_FLAG,SOURCE_MASTERCLIENT.UNUSED_6,SOURCE_MASTERCLIENT.UNUSED_4,SOURCE_MASTERCLIENT.UNUSED_14,SOURCE_MASTERCLIENT.USED_FOR_AREA,SOURCE_MASTERCLIENT.SERVU50_FLAG,SOURCE_MASTERCLIENT.UNUSED_6_2,SOURCE_MASTERCLIENT.UNUSED_4_2,SOURCE_MASTERCLIENT.UNUSED_14_2,SOURCE_MASTERCLIENT.COMBINED_CLIENT_NAME,SOURCE_MASTERCLIENT.UPDATE_FLAG,SOURCE_MASTERCLIENT.SERVICE_1_UNITS,SOURCE_MASTERCLIENT.SERVICE_2_UNITS,SOURCE_MASTERCLIENT.SERVICE_3_UNITS,SOURCE_MASTERCLIENT.PHONE_NO,SOURCE_MASTERCLIENT.COPAY_Y_N_P,SOURCE_MASTERCLIENT.COPAY,SOURCE_MASTERCLIENT.EMPLOYEE_NO,SOURCE_MASTERCLIENT.DESK_NO_ASSIGNED_SERV_COORD,SOURCE_MASTERCLIENT.DOB,SOURCE_MASTERCLIENT.SEX,SOURCE_MASTERCLIENT.COPAY_RESPONSIBLE_PARTY,SOURCE_MASTERCLIENT.ADDRESS,SOURCE_MASTERCLIENT.PHONE,SOURCE_MASTERCLIENT.RELATIONSHIP,SOURCE_MASTERCLIENT.CITY_2,SOURCE_MASTERCLIENT.STATE,SOURCE_MASTERCLIENT.ZIP_2,SOURCE_MASTERCLIENT.CASE_ACTION_DATE,SOURCE_MASTERCLIENT.AREA,SOURCE_MASTERCLIENT.PRIVATE_PAY_RATE,SOURCE_MASTERCLIENT.FAMILY_REASON,SOURCE_MASTERCLIENT.MEDICAID_RECP_Y_N_P,SOURCE_MASTERCLIENT.CCU_LOOKUP_ID,SOURCE_MASTERCLIENT.COUNTY,SOURCE_MASTERCLIENT.CCU_FEIN,SOURCE_MASTERCLIENT.EMERGENCY_PHONE_CONTACT,SOURCE_MASTERCLIENT.EMERGENCY_NAME_CONTACT,SOURCE_MASTERCLIENT.PRIVATE_PAY_BILLING_CYCLE,SOURCE_MASTERCLIENT.LAST_BILLING_DATE,SOURCE_MASTERCLIENT.NEW_FIELD_OLD_SSN,SOURCE_MASTERCLIENT.HMKR_NAME,SOURCE_MASTERCLIENT.CASE_MGR,SOURCE_MASTERCLIENT.CPT_NO_VET_MCO,SOURCE_MASTERCLIENT.DIAG_NO_VET_MCO,SOURCE_MASTERCLIENT.MULTIPLE_CLIENT_FLAG,SOURCE_MASTERCLIENT.CHOPPED_COMBINED_NAME,SOURCE_MASTERCLIENT.MCO_AUTHORITY_ENDS_DATE,SOURCE_MASTERCLIENT.LANGUAGE,SOURCE_MASTERCLIENT.RACE,SOURCE_MASTERCLIENT.SHARED_CODE,SOURCE_MASTERCLIENT.CITY_OPTED_OUT,SOURCE_MASTERCLIENT.SCHED,SOURCE_MASTERCLIENT.CORP_FLAG,SOURCE_MASTERCLIENT.SERVU60,SOURCE_MASTERCLIENT.ACTION_BY_USER,SOURCE_MASTERCLIENT.REGION_AREA,SOURCE_MASTERCLIENT.CASE_MGR_PHONE,SOURCE_MASTERCLIENT.CREATED_DATE,SOURCE_MASTERCLIENT.CREATED_BY,SOURCE_MASTERCLIENT.UPDATED_DATE,SOURCE_MASTERCLIENT.UPDATED_BY,SOURCE_MASTERCLIENT.CREATED_ON,SOURCE_MASTERCLIENT.CREATED_BY_2,SOURCE_MASTERCLIENT.UPDATED_ON,SOURCE_MASTERCLIENT.UPDATED_BY_2,SOURCE_MASTERCLIENT.ETL_TASK_KEY,SOURCE_MASTERCLIENT.ETL_INSERTED_TASK_KEY,SOURCE_MASTERCLIENT.ETL_INSERTED_DATE,SOURCE_MASTERCLIENT.ETL_INSERTED_BY,ETL_LAST_UPDATED_DATE,SOURCE_MASTERCLIENT.ETL_LAST_UPDATED_BY,SOURCE_MASTERCLIENT.ETL_DELETED_FLAG,''NEW'');`
       } );


	var rs5 = snowflake.execute( { sqlText: 
      `UPDATE DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT_CLONED SET INCREMENTAL_FLAG=''TERMINATED'',ETL_LAST_UPDATED_DATE=CURRENT_TIMESTAMP() WHERE INCREMENTAL_FLAG=''NEW'' AND CONCAT(IFNULL(SUBSTRING(COMBINED_CLIENT_NAME,2,LEN(COMBINED_CLIENT_NAME)),''''),''|'',IFNULL(CREATED_DATE,'''')) IN (SELECT CONCAT(IFNULL(COMBINED_CLIENT_NAME,''''),''|'',IFNULL(CREATED_DATE,'''')) FROM DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT_CLONED WHERE DATE(ETL_LAST_UPDATED_DATE)<>CURRENT_DATE());`
       } );

	var rs6 = snowflake.execute( { sqlText: 
      `INSERT INTO DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT SELECT RECORD_NUMBER,CCU_CONTRACT,CCU_AGREEMENT,CCU_PROGRAM_TYPE,CLIENT_IDOA_NO,LAST_NAME,FIRST_NAME,RELOOK_EARLY_WARNING_FLAG,ADDRESS1,ADDRESS2,CITY,ZIP,DETERMINATION_DATE,ASSESSMENT_SCORE,INITIAL_SERVICE_DATE,AVAIL_INCOME,NUMBER_RECEIVING,SERVED_BY_FAMILY_MEMBER,FEE_SCHEDULE,A_TYPE_SERVICE,ACTION_TYPE,ACTION_DATE,VENDOR_MAX,VENDOR_FEIN_AG_PT,UNUSED_3,NSP_FLAG,UNUSED_6,UNUSED_4,UNUSED_14,USED_FOR_AREA,SERVU50_FLAG,UNUSED_6_2,UNUSED_4_2,UNUSED_14_2,COMBINED_CLIENT_NAME,UPDATE_FLAG,SERVICE_1_UNITS,SERVICE_2_UNITS,SERVICE_3_UNITS,PHONE_NO,COPAY_Y_N_P,COPAY,EMPLOYEE_NO,DESK_NO_ASSIGNED_SERV_COORD,DOB,SEX,COPAY_RESPONSIBLE_PARTY,ADDRESS,PHONE,RELATIONSHIP,CITY_2,STATE,ZIP_2,CASE_ACTION_DATE,AREA,PRIVATE_PAY_RATE,FAMILY_REASON,MEDICAID_RECP_Y_N_P,CCU_LOOKUP_ID,COUNTY,CCU_FEIN,EMERGENCY_PHONE_CONTACT,EMERGENCY_NAME_CONTACT,PRIVATE_PAY_BILLING_CYCLE,LAST_BILLING_DATE,NEW_FIELD_OLD_SSN,HMKR_NAME,CASE_MGR,CPT_NO_VET_MCO,DIAG_NO_VET_MCO,MULTIPLE_CLIENT_FLAG,CHOPPED_COMBINED_NAME,MCO_AUTHORITY_ENDS_DATE,LANGUAGE,RACE,SHARED_CODE,CITY_OPTED_OUT,SCHED,CORP_FLAG,SERVU60,ACTION_BY_USER,REGION_AREA,CASE_MGR_PHONE,CREATED_DATE,CREATED_BY,UPDATED_DATE,UPDATED_BY,CREATED_ON,CREATED_BY_2,UPDATED_ON,UPDATED_BY_2,-1 AS ETL_TASK_KEY,-1 AS ETL_INSERTED_TASK_KEY,ETL_INSERTED_DATE,ETL_INSERTED_BY,CURRENT_TIMESTAMP() AS ETL_LAST_UPDATED_DATE,ETL_LAST_UPDATED_BY,ETL_DELETED_FLAG,INCREMENTAL_FLAG FROM DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT_CLONED WHERE DATE(ETL_LAST_UPDATED_DATE)=CURRENT_DATE() AND INCREMENTAL_FLAG<>''IDENTICAL'' AND (INCREMENTAL_FLAG<>''NEW'' OR TRY_TO_NUMERIC(LEFT(COMBINED_CLIENT_NAME,1)) IS NULL);`
       } );

	var rs7 = snowflake.execute( { sqlText: 
      `UPDATE DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT SET ETL_LAST_UPDATED_DATE=CURRENT_TIMESTAMP() WHERE CONCAT(IFNULL(COMBINED_CLIENT_NAME,''''),''|'',IFNULL(CREATED_DATE,'''')) IN (SELECT CONCAT(IFNULL(COMBINED_CLIENT_NAME,''''),''|'',IFNULL(CREATED_DATE,'''')) FROM HIST_MASTERCLIENT_CLONED WHERE INCREMENTAL_FLAG=''IDENTICAL'');`
       } );

	var rs8 = snowflake.execute( { sqlText: 
      `DROP TABLE DISC_${var.SF_ENVIRONMENT}.CCSI.HIST_MASTERCLIENT_CLONED;`
       } );

 	var rs9 = snowflake.execute( { sqlText: 
      `TRUNCATE TABLE DISC_${var.SF_ENVIRONMENT}.CCSI.SOURCE_MASTERCLIENT;`
       } );

  return ''Done.'';
  
 EOT
}

