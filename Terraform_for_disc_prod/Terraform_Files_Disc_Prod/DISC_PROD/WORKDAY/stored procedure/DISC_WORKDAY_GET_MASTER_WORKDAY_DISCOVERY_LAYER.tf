resource "snowflake_procedure" "DISC_WORKDAY_GET_MASTER_WORKDAY_DISCOVERY_LAYER" {
	name ="GET_MASTER_WORKDAY_DISCOVERY_LAYER"
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "WORKDAY"
	language  = "SQL"

	arguments {
		name = "TASKKEY"
		type = "VARCHAR(16777216)"
}	
	return_type = "VARCHAR(16777216)"
	execute_as = "OWNER"
	statement = <<-EOT
BEGIN 
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_AUDIT(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_QUALIFICATIONS_CERTIFICATION_ACHIEVEMENT(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_RELATED_PERSON(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_RELATED_PERSON_ADDRESS_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_RELATED_PERSON_EMAIL_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_RELATED_PERSON_NAME_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_RELATED_PERSON_PHONE_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_REMOTE_LOCATIONS_POST_PROCESSING();
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_ADDITIONAL_INFORMATION(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_ADDRESS_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_COMPENSATION(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_EMAIL_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_IDENTIFICATION_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_LEAVE_OF_ABSENCE(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_NAME_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_ORGANIZATION_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_PERSONAL(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_PHONE_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_POSITION_DATA(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_STATUS(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_SUMMARY(:TASKKEY);
CALL DISC_${var.SF_ENVIRONMENT}.WORKDAY.GET_WORKER_SUPERVISOR(:TASKKEY);
return ''Success'';
END
 EOT
}

