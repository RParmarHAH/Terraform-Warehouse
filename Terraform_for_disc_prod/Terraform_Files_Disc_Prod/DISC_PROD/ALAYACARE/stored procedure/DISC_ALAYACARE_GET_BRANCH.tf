resource "snowflake_procedure" "DISC_ALAYACARE_GET_BRANCH" {
	name ="GET_BRANCH"
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "ALAYACARE"
	language  = "SQL"
	return_type = "VARCHAR(16777216)"
	execute_as = "OWNER"
	statement = <<-EOT

DECLARE
--*****************************************************************************************************************************
-- NAME:  GET_BRANCH 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2021-11-11		UNKNOWN					INITIAL DEVELOPMENT
-- 2023-09-05  		RAVI SUTHAR            	MIGRATED JavaScript to SQL
--*****************************************************************************************************************************
    return_result varchar(1000);
BEGIN
	
    INSERT OVERWRITE INTO ALAYACARE.BRANCH (
        BRANCH_ID, PROFILE_ID, GUID, PARENT_BRANCH_ID, TIMEZONE, CREATED_AT, CREATED_BY, UPDATED_AT, UPDATED_BY, PROFILE_CITY, PROFILE_SANDATA, PROFILE_STATE, PROFILE_ADDRESS_SUITE, PROFILE_COUNTRY, PROFILE_STATE_ID, PROFILE_COMPANY, PROFILE_FIRST_NAME, PROFILE_TELLUS, PROFILE_ZIP, PROFILE_PHONE_MAIN, PROFILE_NAME, PROFILE_EMAIL, PROFILE_ADDRESS, PROFILE_LAST_NAME, PROPERTIES_TBL_GT_ACCOUNT_GUID, PROPERTIES_TBL_GT_ACCOUNT_UPDATE_USER_ID, PROPERTIES_TBL_GT_ACCOUNT_TIMEZONE, PROPERTIES_TBL_GT_ACCOUNT_PHONE, PROPERTIES_TBL_GT_ACCOUNT_IDMASTERACCOUNT, PROPERTIES_TBL_GT_ACCOUNT_ID, PROPERTIES_TBL_GT_ACCOUNT_GEOFENCE, PROPERTIES_TBL_GT_ACCOUNT_UPDATE_TIME, PROPERTIES_TBL_GT_ACCOUNT_IDSTATUS, PROPERTIES_TBL_GT_ACCOUNT_IDPROFILE, PROPERTIES_TBL_GT_ACCOUNT_OP, PROPERTIES_TBL_GT_ACCOUNT_DISPLAY_ID, PROPERTIES_TBL_GT_ACCOUNT_IDACCOUNTTYPE, PROPERTIES_TBL_GT_ACCOUNT_CREATE_TIME, PROPERTIES_TBL_GT_ACCOUNT_DESCRIPTION, PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT_FULLTEXT_INDEX, PROPERTIES_TBL_PROSPECT_CONTACT_ID, PROPERTIES_TBL_PROSPECT_CONTACT_GEO_CODED, PROPERTIES_TBL_PROSPECT_CONTACT_GEO_LON, PROPERTIES_TBL_PROSPECT_CONTACT_LIST_ID, PROPERTIES_TBL_PROSPECT_CONTACT_IDACCOUNT, PROPERTIES_TBL_PROSPECT_CONTACT_IS_ACTIVE, PROPERTIES_TBL_PROSPECT_CONTACT_OP, PROPERTIES_TBL_PROSPECT_CONTACT_DEPRECATED_GUID_TO, PROPERTIES_TBL_PROSPECT_CONTACT_GEO_LAT, PROPERTIES_TBL_PROSPECT_CONTACT_GUID, PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_USER_ID)
        SELECT BRANCH_ID AS BRANCH_ID, PROFILE_ID AS PROFILE_ID, GUID AS GUID, PARENT_BRANCH_ID AS PARENT_BRANCH_ID, TIMEZONE AS TIMEZONE, CREATED_AT AS CREATED_AT, CREATED_BY AS CREATED_BY, UPDATED_AT AS UPDATED_AT, UPDATED_BY AS UPDATED_BY, PROFILE:city::STRING AS PROFILE_CITY, PROFILE:sandata::STRING AS PROFILE_SANDATA, PROFILE:state::STRING AS PROFILE_STATE, PROFILE:address_suite::STRING AS PROFILE_ADDRESS_SUITE, PROFILE:country::STRING AS PROFILE_COUNTRY, PROFILE:state_id::STRING AS PROFILE_STATE_ID, PROFILE:company::STRING AS PROFILE_COMPANY, PROFILE:first_name::STRING AS PROFILE_FIRST_NAME, PROFILE:tellus::STRING AS PROFILE_TELLUS, PROFILE:zip::STRING AS PROFILE_ZIP, PROFILE:phone_main::STRING AS PROFILE_PHONE_MAIN, PROFILE:name::STRING AS PROFILE_NAME, PROFILE:email::STRING AS PROFILE_EMAIL, PROFILE:address::STRING AS PROFILE_ADDRESS, PROFILE:last_name::STRING AS PROFILE_LAST_NAME, PROPERTIES_TBL_GT_ACCOUNT:guid::STRING AS PROPERTIES_TBL_GT_ACCOUNT_GUID, PROPERTIES_TBL_GT_ACCOUNT:update_user_id::STRING AS PROPERTIES_TBL_GT_ACCOUNT_UPDATE_USER_ID, PROPERTIES_TBL_GT_ACCOUNT:timezone::STRING AS PROPERTIES_TBL_GT_ACCOUNT_TIMEZONE, PROPERTIES_TBL_GT_ACCOUNT:phone::STRING AS PROPERTIES_TBL_GT_ACCOUNT_PHONE, PROPERTIES_TBL_GT_ACCOUNT:idmasteraccount::STRING AS PROPERTIES_TBL_GT_ACCOUNT_IDMASTERACCOUNT, PROPERTIES_TBL_GT_ACCOUNT:id::STRING AS PROPERTIES_TBL_GT_ACCOUNT_ID, PROPERTIES_TBL_GT_ACCOUNT:geofence::STRING AS PROPERTIES_TBL_GT_ACCOUNT_GEOFENCE, PROPERTIES_TBL_GT_ACCOUNT:update_time::STRING AS PROPERTIES_TBL_GT_ACCOUNT_UPDATE_TIME, PROPERTIES_TBL_GT_ACCOUNT:idstatus::STRING AS PROPERTIES_TBL_GT_ACCOUNT_IDSTATUS, PROPERTIES_TBL_GT_ACCOUNT:idprofile::STRING AS PROPERTIES_TBL_GT_ACCOUNT_IDPROFILE, PROPERTIES_TBL_GT_ACCOUNT:Op::STRING AS PROPERTIES_TBL_GT_ACCOUNT_OP, PROPERTIES_TBL_GT_ACCOUNT:display_id::STRING AS PROPERTIES_TBL_GT_ACCOUNT_DISPLAY_ID, PROPERTIES_TBL_GT_ACCOUNT:idaccounttype::STRING AS PROPERTIES_TBL_GT_ACCOUNT_IDACCOUNTTYPE, PROPERTIES_TBL_GT_ACCOUNT:create_time::STRING AS PROPERTIES_TBL_GT_ACCOUNT_CREATE_TIME, PROPERTIES_TBL_GT_ACCOUNT:description::STRING AS PROPERTIES_TBL_GT_ACCOUNT_DESCRIPTION, PROPERTIES_TBL_PROSPECT_CONTACT:create_time::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT:fulltext_index::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_FULLTEXT_INDEX, PROPERTIES_TBL_PROSPECT_CONTACT:id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_ID, PROPERTIES_TBL_PROSPECT_CONTACT:geo_coded::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GEO_CODED, PROPERTIES_TBL_PROSPECT_CONTACT:geo_lon::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GEO_LON, PROPERTIES_TBL_PROSPECT_CONTACT:list_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_LIST_ID, PROPERTIES_TBL_PROSPECT_CONTACT:idaccount::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_IDACCOUNT, PROPERTIES_TBL_PROSPECT_CONTACT:is_active::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_IS_ACTIVE, PROPERTIES_TBL_PROSPECT_CONTACT:Op::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_OP, PROPERTIES_TBL_PROSPECT_CONTACT:deprecated_guid_to::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_DEPRECATED_GUID_TO, PROPERTIES_TBL_PROSPECT_CONTACT:geo_lat::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GEO_LAT, PROPERTIES_TBL_PROSPECT_CONTACT:guid::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GUID, PROPERTIES_TBL_PROSPECT_CONTACT:update_time::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT:update_user_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_USER_ID 
        FROM ALAYACARE_${var.SF_ENVIRONMENT}UCTION."5C3EE5FE-45A5-4DA7-A35B-BD7CDAFE3548".SHARED_BRANCH;

	SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
	return return_result;
END;

 EOT
}

