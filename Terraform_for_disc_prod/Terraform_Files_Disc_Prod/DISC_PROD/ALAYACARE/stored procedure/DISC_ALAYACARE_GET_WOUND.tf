resource "snowflake_procedure" "DISC_ALAYACARE_GET_WOUND" {
	name ="GET_WOUND"
	database = "DISC_${var.SF_ENVIRONMENT}"
	schema = "ALAYACARE"
	language  = "SQL"
	return_type = "VARCHAR(16777216)"
	execute_as = "OWNER"
	statement = <<-EOT

DECLARE
--*****************************************************************************************************************************
-- NAME:  GET_WOUND 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2021-11-11		UNKNOWN					INITIAL DEVELOPMENT
-- 2023-09-05  		RAVI SUTHAR            	MIGRATED JavaScript to SQL
--*****************************************************************************************************************************
    return_result varchar(1000);
BEGIN
	
    INSERT OVERWRITE INTO ALAYACARE.WOUND (
        TREATMENT_ID, WOUND_ID, CLIENT_ID, CREATE_DATE, UPDATE_DATE, WOUND_EMPLOYEE_CREATE_ID, WOUND_EMPLOYEE_UPDATE_ID, TREATMENT_EMPLOYEE_CREATE_ID, TREATMENT_EMPLOYEE_UPDATE_ID, TREATMENT_COMPLETE_DATE, VISIT_NUMBER, NON_APPLICABLE, LENGTH, WIDTH, DEPTH, AREA, INITIAL_AREA, HEALING_PERCENTAGE, UNDERMINING, UNDERMINING_DEPTH, UNDERMINING_CLOCK, TUNNELING, TUNNELING_DEPTH, TUNNELING_CLOCK, BLACK_ESCHAR, RED_PINK_HYPER, GREEN_YELLOW, EXUDATE, AMOUNT, ODOUR, MARGINS, PERIWOUND, PERIWOUND_OTHER, SKIN_SENSATION, PAIN, CULTURE_SENSITIVITY_SWAB, SWAB_DATE, OFF_LOADING, OFF_LOADING_TYPE, NAME, STAGE, ABPI, COMPRESSION, COMPRESSION_START_DATE, COMPRESSION_TYPE, WOUND_STATUS, ACUITY, LOCATION, LOCATION_DRAWING, DIAGRAM, FREQUENCY, TREATMENT_PROTOCOL, TREATMENT_STATUS, TYPE, TOTAL_VISITS_PERMITTED, BRANCH_ID, PROPERTIES_WOUND_CARE, PROPERTIES_WOUND_CARE_TREATMENT)
        SELECT TREATMENT_ID AS TREATMENT_ID, WOUND_ID AS WOUND_ID, CLIENT_ID AS CLIENT_ID, CREATE_DATE AS CREATE_DATE, UPDATE_DATE AS UPDATE_DATE, WOUND_EMPLOYEE_CREATE_ID AS WOUND_EMPLOYEE_CREATE_ID, WOUND_EMPLOYEE_UPDATE_ID AS WOUND_EMPLOYEE_UPDATE_ID, TREATMENT_EMPLOYEE_CREATE_ID AS TREATMENT_EMPLOYEE_CREATE_ID, TREATMENT_EMPLOYEE_UPDATE_ID AS TREATMENT_EMPLOYEE_UPDATE_ID, TREATMENT_COMPLETE_DATE AS TREATMENT_COMPLETE_DATE, VISIT_NUMBER AS VISIT_NUMBER, NON_APPLICABLE AS NON_APPLICABLE, LENGTH AS LENGTH, WIDTH AS WIDTH, DEPTH AS DEPTH, AREA AS AREA, INITIAL_AREA AS INITIAL_AREA, HEALING_PERCENTAGE AS HEALING_PERCENTAGE, UNDERMINING AS UNDERMINING, UNDERMINING_DEPTH AS UNDERMINING_DEPTH, UNDERMINING_CLOCK AS UNDERMINING_CLOCK, TUNNELING AS TUNNELING, TUNNELING_DEPTH AS TUNNELING_DEPTH, TUNNELING_CLOCK AS TUNNELING_CLOCK, BLACK_ESCHAR AS BLACK_ESCHAR, RED_PINK_HYPER AS RED_PINK_HYPER, GREEN_YELLOW AS GREEN_YELLOW, EXUDATE AS EXUDATE, AMOUNT AS AMOUNT, ODOUR AS ODOUR, MARGINS AS MARGINS, PERIWOUND AS PERIWOUND, PERIWOUND_OTHER AS PERIWOUND_OTHER, SKIN_SENSATION AS SKIN_SENSATION, PAIN AS PAIN, CULTURE_SENSITIVITY_SWAB AS CULTURE_SENSITIVITY_SWAB, SWAB_DATE AS SWAB_DATE, OFF_LOADING AS OFF_LOADING, OFF_LOADING_TYPE AS OFF_LOADING_TYPE, NAME AS NAME, STAGE AS STAGE, ABPI AS ABPI, COMPRESSION AS COMPRESSION, COMPRESSION_START_DATE AS COMPRESSION_START_DATE, COMPRESSION_TYPE AS COMPRESSION_TYPE, WOUND_STATUS AS WOUND_STATUS, ACUITY AS ACUITY, LOCATION AS LOCATION, LOCATION_DRAWING AS LOCATION_DRAWING, DIAGRAM AS DIAGRAM, FREQUENCY AS FREQUENCY, TREATMENT_PROTOCOL AS TREATMENT_PROTOCOL, TREATMENT_STATUS AS TREATMENT_STATUS, TYPE AS TYPE, TOTAL_VISITS_PERMITTED AS TOTAL_VISITS_PERMITTED, BRANCH_ID AS BRANCH_ID, PROPERTIES_WOUND_CARE AS PROPERTIES_WOUND_CARE, PROPERTIES_WOUND_CARE_TREATMENT AS PROPERTIES_WOUND_CARE_TREATMENT 
        FROM ALAYACARE_${var.SF_ENVIRONMENT}UCTION."5C3EE5FE-45A5-4DA7-A35B-BD7CDAFE3548".SHARED_WOUND;

	SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
	return return_result;
END;

 EOT
}

