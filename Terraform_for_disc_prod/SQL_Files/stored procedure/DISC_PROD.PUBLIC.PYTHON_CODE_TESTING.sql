CREATE OR REPLACE PROCEDURE DISC_PROD.PUBLIC.PYTHON_CODE_TESTING("STR_ETL_TASK_KEY" VARCHAR(16777216), "STR_CDC_START" VARCHAR(16777216), "STR_CDC_END" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
return_result VARCHAR;
BEGIN
INSERT
	INTO
	DISC_PROD."PUBLIC".TEST81 
SELECT
	ID,
	LASTRUNDATE
FROM
	DISC_PROD."PUBLIC".PIPELINE_CONFIG_DISCOVERY
WHERE
	ID NOT IN (
	SELECT
		BRANCH_ID
	FROM
		DISC_PROD."PUBLIC".TEST81)
	AND LASTRUNDATE IS NOT NULL
LIMIT 3;
SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
return return_result;
END;

';