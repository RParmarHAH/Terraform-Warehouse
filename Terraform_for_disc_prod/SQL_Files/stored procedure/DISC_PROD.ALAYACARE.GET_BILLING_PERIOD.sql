CREATE OR REPLACE PROCEDURE DISC_PROD.ALAYACARE.GET_BILLING_PERIOD()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
--*****************************************************************************************************************************
-- NAME:  GET_BILLING_PERIOD 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2021-11-11		UNKNOWN					INITIAL DEVELOPMENT
-- 2023-09-05  		RAVI SUTHAR            	MIGRATED JavaScript to SQL
--*****************************************************************************************************************************
    return_result varchar(1000);
BEGIN
	
    INSERT OVERWRITE INTO ALAYACARE.BILLING_PERIOD (
        BILLING_PERIOD_ID, START_DATE, END_DATE, CLOSED_AT, CREATE_TIME, UPDATE_TIME, BACK_BILLING_DATE, IDSTATUS, IS_CLOSED, BRANCH_ID,
		PROPERTIES_TBL_BILLING_PERIODS_ALLOW_SHIFT_CREATION, PROPERTIES_TBL_BILLING_PERIODS_CREATE_TIME, PROPERTIES_TBL_BILLING_PERIODS_CREATE_USER_ID, PROPERTIES_TBL_BILLING_PERIODS_END_DATE, PROPERTIES_TBL_BILLING_PERIODS_GUID, PROPERTIES_TBL_BILLING_PERIODS_ID, PROPERTIES_TBL_BILLING_PERIODS_IDMASTERACCOUNT, PROPERTIES_TBL_BILLING_PERIODS_INVOICE_DATE, PROPERTIES_TBL_BILLING_PERIODS_IS_CLOSED, PROPERTIES_TBL_BILLING_PERIODS_PROGRAM_TYPE, PROPERTIES_TBL_BILLING_PERIODS_TYPE, PROPERTIES_TBL_BILLING_PERIODS_UPDATE_TIME, PROPERTIES_TBL_BILLING_PERIODS_UPDATE_USER_ID)
        SELECT BILLING_PERIOD_ID AS BILLING_PERIOD_ID, START_DATE AS START_DATE, END_DATE AS END_DATE, CLOSED_AT AS CLOSED_AT, CREATE_TIME AS CREATE_TIME, UPDATE_TIME AS UPDATE_TIME, BACK_BILLING_DATE AS BACK_BILLING_DATE, IDSTATUS AS IDSTATUS, IS_CLOSED AS IS_CLOSED, BRANCH_ID AS BRANCH_ID,
			PROPERTIES_TBL_BILLING_PERIODS:allow_shift_creation::STRING AS PROPERTIES_TBL_BILLING_PERIODS_ALLOW_SHIFT_CREATION, PROPERTIES_TBL_BILLING_PERIODS:create_time::STRING AS PROPERTIES_TBL_BILLING_PERIODS_CREATE_TIME, PROPERTIES_TBL_BILLING_PERIODS:create_user_id::STRING AS PROPERTIES_TBL_BILLING_PERIODS_CREATE_USER_ID, PROPERTIES_TBL_BILLING_PERIODS:end_date::STRING AS PROPERTIES_TBL_BILLING_PERIODS_END_DATE, PROPERTIES_TBL_BILLING_PERIODS:guid::STRING AS PROPERTIES_TBL_BILLING_PERIODS_GUID, PROPERTIES_TBL_BILLING_PERIODS:id::STRING AS PROPERTIES_TBL_BILLING_PERIODS_ID, PROPERTIES_TBL_BILLING_PERIODS:idmasteraccount::STRING AS PROPERTIES_TBL_BILLING_PERIODS_IDMASTERACCOUNT, PROPERTIES_TBL_BILLING_PERIODS:invoice_date::STRING AS PROPERTIES_TBL_BILLING_PERIODS_INVOICE_DATE, PROPERTIES_TBL_BILLING_PERIODS:is_closed::STRING AS PROPERTIES_TBL_BILLING_PERIODS_IS_CLOSED, PROPERTIES_TBL_BILLING_PERIODS:program_type::STRING AS PROPERTIES_TBL_BILLING_PERIODS_PROGRAM_TYPE, PROPERTIES_TBL_BILLING_PERIODS:type::STRING AS PROPERTIES_TBL_BILLING_PERIODS_TYPE, PROPERTIES_TBL_BILLING_PERIODS:update_time::STRING AS PROPERTIES_TBL_BILLING_PERIODS_UPDATE_TIME, PROPERTIES_TBL_BILLING_PERIODS:update_user_id::STRING AS PROPERTIES_TBL_BILLING_PERIODS_UPDATE_USER_ID
        FROM ALAYACARE_PRODUCTION."5C3EE5FE-45A5-4DA7-A35B-BD7CDAFE3548".SHARED_BILLING_PERIOD;

	SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
	return return_result;
END;
';