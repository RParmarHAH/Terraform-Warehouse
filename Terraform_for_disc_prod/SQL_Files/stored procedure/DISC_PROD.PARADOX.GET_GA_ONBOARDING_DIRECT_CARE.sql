CREATE OR REPLACE PROCEDURE DISC_PROD.PARADOX.GET_GA_ONBOARDING_DIRECT_CARE("TASKKEY" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
--*****************************************************************************************************************************
-- NAME:  GET_GA_ONBOARDING_DIRECT_CARE 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE				AUTHOR										NOTES:
-- ----------		-------------------							-----------------------------------------------------------------------------------------------
-- 2023-11-20		KOMAL DHOKAI/RAVI SUTHAR					INITIAL DEVELOPMENT
--*****************************************************************************************************************************

 
BEGIN 
    --TARGETSQL
    COPY INTO DISC_PROD.PARADOX.HIST_GA_ONBOARDING_DIRECT_CARE FROM (SELECT A.$1 FORM_NAME, A.$2 LOCATION_CODE, A.$3 LOCATION_NAME, A.$4 JOB_APPLIED_TO, A.$5 JOB_REQ_ID, A.$6 JOB_TITLE, A.$7 CURRENT_CANDIDATE_JOURNEY_STATUS, A.$8 CANDIDATE_ID, A.$9 CANDIDATE_NAME, A.$10 FORM_DATE_SENT, A.$11 FORM_IN_PROGRESS_DATE, A.$12 FORM_COMPLETION_STATUS, A.$13 FORM_DATE_SUBMITTED, A.$14 FORM_PREVIEW_LINK, A.$15 PUBLISHED_DATE, A.$16 PUBLISHED_VERSION, A.$17 PROFILE_ID, A.$18 MULTIPLE_RECORDS, A.$19 PRIMARY_IDENTIFIER, A.$20 REAPPLY_IN_CAPTURE, A.$21 REAPPLY_IN_JOB_SEARCH, A.$22 REAPPLY_IN_CAMPAIGN, A.$23 WELCOME_LETTER_HELP_AT_HOME_EEO_SURVEY, A.$24 WELCOME_LETTER_WELCOME_LETTER, A.$25 EMERGENCY_CONTACT_YOUR_FULL_NAME, A.$26 EMERGENCY_CONTACT_STREET_ADDRESS_LINE_1_, A.$27 EMERGENCY_CONTACT_STREET_ADDRESS_LINE_2_, A.$28 EMERGENCY_CONTACT_CITY, A.$29 EMERGENCY_CONTACT_STATE, A.$30 EMERGENCY_CONTACT_ZIP_CODE, A.$31 EMERGENCY_CONTACT_EMPLOYEE_PHONE_NUMBER, A.$32 EMERGENCY_CONTACT_EMPLOYEE_EMAIL_ADDRESS, A.$33 EMERGENCY_CONTACT_PRIMARY_EMERGENCY_CONTACT_NAME, A.$34 EMERGENCY_CONTACT_PRIMARY_EMERGENCY_CONTACT_CELL_PHONE_NUMBER, A.$35 EMERGENCY_CONTACT_RELATION_TO_CAREGIVER, A.$36 EMERGENCY_CONTACT_SECONDARY_EMERGENCY_CONTACT_NAME, A.$37 EMERGENCY_CONTACT_SECONDARY_EMERGENCY_CONTACT_CELL_PHONE_NUMBER, A.$38 STATEMENT_OF_NO_ABUSE_STATEMENT_OF_NO_ABUSE, A.$39 JOB_DESCRIPTION_PLEASE_REVIEW_AND_ACCEPT_THE_JOB_REQUIREMENTS_, A.$40 TAX_DOCUMENTS_DIRECT_DEPOSIT_I_9, A.$41 TAX_DOCUMENTS_DIRECT_DEPOSIT_DIRECT_DEPOSIT, A.$42 TAX_WITHHOLDING_TAX_WITHHOLDING, A.$43 TAX_WITHHOLDING_FEDERAL_TAX_FORMS, A.$44 TAX_WITHHOLDING_STATE_TAX_FORMS, NULL CONSENT_FOR_FINGERPRINT__BACKGROUND_CHECK_PRIVACY_RIGHTS_AND_CONSENT_FOR_FINGERPRINT_BACKGROUND_CHECK, A.$45 CONSENT_FOR_FINGERPRINT_BACKGROUND_CHECK_DRIVER_S_LICENSE_OR_STATE_ID, A.$46 CONSENT_FOR_FINGERPRINT_BACKGROUND_CHECK_SOCIAL_SECURITY_CARD, A.$47 ACKNOWLEDGEMENT_OF_INSURANCE_ACKNOWLEDGEMENT_OF_INSURANCE, A.$48 EMPLOYMENT_ELIGIBILITY_CERTIFICATION_FORM_EMPLOYMENT_ELIGIBILITY_CERTIFICATION_FORM, A.$49 HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION_HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION, A.$50 VEHICLE_USE_POLICY_AND_AGREEMENT_VEHICLE_USE_POLICY_AND_AGREEMENT, A.$51 CLIENT_RIGHTS_RESPONSIBILITIES_CLIENT_RIGHTS_RESPONSIBILITIES, A.$52 CLIENT_RIGHTS_RESPONSIBILITIES_I_CONSENT_TO_HELP_AT_HOME_COMMUNICATING_WITH_ME_DURING_MY_EMPLOYMENT_USING_THE_PERSONAL_CONTACT_INFORMATION_I_PROVIDED_THIS_COMMUNICATION_MAY_BE_MADE_BY_BUT_IS_NOT_LIMITED_TO_TELEPHONE_SMS_TEXT_AND_EMAIL_, A.$53 EMPLOYEE_HANDBOOK_GA_EMPLOYEE_HANDBOOK, A.$54 EMPLOYEE_HANDBOOK_HAH_CODE_OF_ETHICAL_STANDARDS, A.$55 FINAL_SUBMISSION, :TASKKEY AS ETL_TASK_KEY, :TASKKEY AS ETL_INSERTED_TASK_KEY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, CURRENT_USER() AS ETL_INSERTED_BY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, CURRENT_USER() AS ETL_LAST_UPDATED_BY, 0 AS ETL_DELETED_FLAG FROM @DISC_PROD.STAGE.AWSAZSTAGEPROD/PARADOX/UPLOAD_FILE/FORMSCANDIDATE.FORMS.DETAIL.REPORT.WIDE.FORMAT.GA.DIRECT.CARE.ONBOARDING (FILE_FORMAT => DISC_PROD.PUBLIC.MY_CSV_FORMAT_WITHOUT_HEADER_DOUBLE_QUOTES) A); 

    --VIEWSQL
    CREATE OR REPLACE TABLE DISC_PROD.PARADOX.GA_ONBOARDING_DIRECT_CARE AS SELECT FORM_NAME FORM_NAME, LOCATION_CODE LOCATION_CODE, LOCATION_NAME LOCATION_NAME, JOB_APPLIED_TO JOB_APPLIED_TO, JOB_REQ_ID JOB_REQ_ID, JOB_TITLE JOB_TITLE, CURRENT_CANDIDATE_JOURNEY_STATUS CURRENT_CANDIDATE_JOURNEY_STATUS, CANDIDATE_ID CANDIDATE_ID, CANDIDATE_NAME CANDIDATE_NAME, FORM_DATE_SENT FORM_DATE_SENT, FORM_IN_PROGRESS_DATE FORM_IN_PROGRESS_DATE, FORM_COMPLETION_STATUS FORM_COMPLETION_STATUS, FORM_DATE_SUBMITTED FORM_DATE_SUBMITTED, FORM_PREVIEW_LINK FORM_PREVIEW_LINK, PUBLISHED_DATE PUBLISHED_DATE, PUBLISHED_VERSION PUBLISHED_VERSION, PROFILE_ID PROFILE_ID, MULTIPLE_RECORDS MULTIPLE_RECORDS, PRIMARY_IDENTIFIER PRIMARY_IDENTIFIER, REAPPLY_IN_CAPTURE REAPPLY_IN_CAPTURE, REAPPLY_IN_JOB_SEARCH REAPPLY_IN_JOB_SEARCH, REAPPLY_IN_CAMPAIGN REAPPLY_IN_CAMPAIGN, WELCOME_LETTER_HELP_AT_HOME_EEO_SURVEY WELCOME_LETTER_HELP_AT_HOME_EEO_SURVEY, WELCOME_LETTER_WELCOME_LETTER WELCOME_LETTER_WELCOME_LETTER, EMERGENCY_CONTACT_YOUR_FULL_NAME EMERGENCY_CONTACT_YOUR_FULL_NAME, EMERGENCY_CONTACT_STREET_ADDRESS_LINE_1 EMERGENCY_CONTACT_STREET_ADDRESS_LINE_1, EMERGENCY_CONTACT_STREET_ADDRESS_LINE_2 EMERGENCY_CONTACT_STREET_ADDRESS_LINE_2, EMERGENCY_CONTACT_CITY EMERGENCY_CONTACT_CITY, EMERGENCY_CONTACT_STATE EMERGENCY_CONTACT_STATE, EMERGENCY_CONTACT_ZIP_CODE EMERGENCY_CONTACT_ZIP_CODE, EMERGENCY_CONTACT_EMPLOYEE_PHONE_NUMBER EMERGENCY_CONTACT_EMPLOYEE_PHONE_NUMBER, EMERGENCY_CONTACT_EMPLOYEE_EMAIL_ADDRESS EMERGENCY_CONTACT_EMPLOYEE_EMAIL_ADDRESS, EMERGENCY_CONTACT_PRIMARY_EMERGENCY_CONTACT_NAME EMERGENCY_CONTACT_PRIMARY_EMERGENCY_CONTACT_NAME, EMERGENCY_CONTACT_PRIMARY_EMERGENCY_CONTACT_CELL_PHONE_NUMBER EMERGENCY_CONTACT_PRIMARY_EMERGENCY_CONTACT_CELL_PHONE_NUMBER, EMERGENCY_CONTACT_RELATION_TO_CAREGIVER EMERGENCY_CONTACT_RELATION_TO_CAREGIVER, EMERGENCY_CONTACT_SECONDARY_EMERGENCY_CONTACT_NAME EMERGENCY_CONTACT_SECONDARY_EMERGENCY_CONTACT_NAME, EMERGENCY_CONTACT_SECONDARY_EMERGENCY_CONTACT_CELL_PHONE_NUMBER EMERGENCY_CONTACT_SECONDARY_EMERGENCY_CONTACT_CELL_PHONE_NUMBER, STATEMENT_OF_NO_ABUSE_STATEMENT_OF_NO_ABUSE STATEMENT_OF_NO_ABUSE_STATEMENT_OF_NO_ABUSE, JOB_DESCRIPTION_PLEASE_REVIEW_AND_ACCEPT_THE_JOB_REQUIREMENTS JOB_DESCRIPTION_PLEASE_REVIEW_AND_ACCEPT_THE_JOB_REQUIREMENTS, TAX_DOCUMENTS__DIRECT_DEPOSIT_I9 TAX_DOCUMENTS__DIRECT_DEPOSIT_I9, TAX_DOCUMENTS__DIRECT_DEPOSIT_DIRECT_DEPOSIT TAX_DOCUMENTS__DIRECT_DEPOSIT_DIRECT_DEPOSIT, TAX_WITHHOLDING_TAX_WITHHOLDING TAX_WITHHOLDING_TAX_WITHHOLDING, TAX_WITHHOLDING_FEDERAL_TAX_FORMS TAX_WITHHOLDING_FEDERAL_TAX_FORMS, TAX_WITHHOLDING_STATE_TAX_FORMS TAX_WITHHOLDING_STATE_TAX_FORMS, CONSENT_FOR_FINGERPRINT__BACKGROUND_CHECK_PRIVACY_RIGHTS_AND_CONSENT_FOR_FINGERPRINT_BACKGROUND_CHECK CONSENT_FOR_FINGERPRINT__BACKGROUND_CHECK_PRIVACY_RIGHTS_AND_CONSENT_FOR_FINGERPRINT_BACKGROUND_CHECK, CONSENT_FOR_FINGERPRINT__BACKGROUND_CHECK_DRIVERS_LICENSE_OR_STATE_ID CONSENT_FOR_FINGERPRINT__BACKGROUND_CHECK_DRIVERS_LICENSE_OR_STATE_ID, CONSENT_FOR_FINGERPRINT__BACKGROUND_CHECK_SOCIAL_SECURITY_CARD CONSENT_FOR_FINGERPRINT__BACKGROUND_CHECK_SOCIAL_SECURITY_CARD, ACKNOWLEDGEMENT_OF_INSURANCE_ACKNOWLEDGEMENT_OF_INSURANCE ACKNOWLEDGEMENT_OF_INSURANCE_ACKNOWLEDGEMENT_OF_INSURANCE, EMPLOYMENT_ELIGIBILITY_CERTIFICATION_FORM_EMPLOYMENT_ELIGIBILITY_CERTIFICATION_FORM EMPLOYMENT_ELIGIBILITY_CERTIFICATION_FORM_EMPLOYMENT_ELIGIBILITY_CERTIFICATION_FORM, HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION_HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION_HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION, VEHICLE_USE_POLICY_AND_AGREEMENT_VEHICLE_USE_POLICY_AND_AGREEMENT VEHICLE_USE_POLICY_AND_AGREEMENT_VEHICLE_USE_POLICY_AND_AGREEMENT, CLIENT_RIGHTS__RESPONSIBILITIES_CLIENT_RIGHTS__RESPONSIBILITIES CLIENT_RIGHTS__RESPONSIBILITIES_CLIENT_RIGHTS__RESPONSIBILITIES, CLIENT_RIGHTS__RESPONSIBILITIES_I_CONSENT_TO_HELP_AT_HOME_COMMUNICATING_WITH_ME_DURING_MY_EMPLOYMENT_USING_THE_PERSONAL_CONTACT_INFORMATION_I_PROVIDED CLIENT_RIGHTS__RESPONSIBILITIES_I_CONSENT_TO_HELP_AT_HOME_COMMUNICATING_WITH_ME_DURING_MY_EMPLOYMENT_USING_THE_PERSONAL_CONTACT_INFORMATION_I_PROVIDED, EMPLOYEE_HANDBOOK_EMPLOYEE_HANDBOOK EMPLOYEE_HANDBOOK_EMPLOYEE_HANDBOOK, EMPLOYEE_HANDBOOK_HAH_CODE_OF_CONDUCT EMPLOYEE_HANDBOOK_HAH_CODE_OF_CONDUCT, FINAL_SUBMISSION FINAL_SUBMISSION,  :TASKKEY AS ETL_TASK_KEY, :TASKKEY AS ETL_INSERTED_TASK_KEY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, CURRENT_USER() AS ETL_INSERTED_BY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, CURRENT_USER() AS ETL_LAST_UPDATED_BY, 0 AS ETL_DELETED_FLAG FROM DISC_PROD.PARADOX.HIST_GA_ONBOARDING_DIRECT_CARE WHERE ETL_LAST_UPDATED_DATE = (SELECT MAX(ETL_LAST_UPDATED_DATE) FROM DISC_PROD.PARADOX.HIST_GA_ONBOARDING_DIRECT_CARE);

    RETURN ''SUCCESS'';
END;

';