CREATE OR REPLACE PROCEDURE DISC_PROD.QUALTRICS_SURVEYS.GET_QUALTRICS_DIRECTORY_CONTACTS("TASKKEY" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
BEGIN 
    --TargetSQL
    INSERT OVERWRITE INTO DISC_PROD.QUALTRICS_SURVEYS.QUALTRICS_DIRECTORY_CONTACTS SELECT a.$1,a.$2,a.$3,a.$4,a.$5,a.$6,a.$7,a.$8,a.$9,:TaskKey,:TaskKey,CURRENT_TIMESTAMP(),CURRENT_USER(),CURRENT_TIMESTAMP(),CURRENT_USER(),NULL FROM @DISC_PROD.Stage.AWSAZSTAGEPROD/Qualtrics/Qualtrics_Directory_Contacts/Contacts_List.csv(file_format => DISC_PROD.STAGE.CSV_FORMAT) a;

    return ''Success'';

END;
';