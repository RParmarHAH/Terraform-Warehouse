CREATE OR REPLACE PROCEDURE DISC_PROD.ALAYACARE.GET_EMPLOYEE()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
--*****************************************************************************************************************************
-- NAME:  GET_EMPLOYEE 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2021-11-11		UNKNOWN					INITIAL DEVELOPMENT
-- 2023-09-05  		RAVI SUTHAR            	MIGRATED JavaScript to SQL
--*****************************************************************************************************************************
    return_result varchar(1000);
BEGIN
	
    INSERT OVERWRITE INTO ALAYACARE.EMPLOYEE (
        EMPLOYEE_ID, PROFILE_ID, GUID, BRANCH_ID, CREATED_AT, CREATED_BY, UPDATED_AT, UPDATED_BY, STATUS, HAS_SKILLS, 
		PROFILE_ADDRESS, PROFILE_BIRTHDAY, PROFILE_BUSINESS_ENTITY_, PROFILE_CITY, PROFILE_COUNTRY, PROFILE_COUNTY_, PROFILE_DO_NOT_HIRE_, PROFILE_EMAIL, PROFILE_FIRST_NAME, PROFILE_GENDER, PROFILE_IMPORT_ID, PROFILE_JOB_TITLE, PROFILE_LAST_NAME, PROFILE_LEGACY_ID, PROFILE_MARITAL_STATUS, PROFILE_PERSONAL_EMAIL, PROFILE_PHONE_MAIN, PROFILE_PHONE_PERSONAL, PROFILE_SSN, PROFILE_START_DATE, PROFILE_STATE, PROFILE_TYPE_OF_CAREGIVER, PROFILE_UID, PROFILE_ZIP,
		USER_SETTINGS_STAFFING_EMPLOYEE_POSITION_TYPE, USER_SETTINGS_STAFFING_EMPLOYEE_RULE, USER_SETTINGS_STAFFING_PAYROLL_NUMBER, USER_SETTINGS_STAFFING_SIN_NUMBER, 
		EMPLOYEE_MINIMUM_DAILY_CAPACITY, EMPLOYEE_MAXIMUM_DAILY_CAPACITY, EMPLOYEE_MINIMUM_WEEKLY_CAPACITY, EMPLOYEE_MAXIMUM_WEEKLY_CAPACITY, EMPLOYEE_CURRENT_CASELOAD, 
		PROPERTIES_TBL_USERS_OP, PROPERTIES_TBL_USERS_ACTIVKEY, PROPERTIES_TBL_USERS_CREATE_TIME, PROPERTIES_TBL_USERS_CREATE_USER_ID, PROPERTIES_TBL_USERS_DISPLAY_ID, PROPERTIES_TBL_USERS_EMAIL, PROPERTIES_TBL_USERS_GUID, PROPERTIES_TBL_USERS_ID, PROPERTIES_TBL_USERS_IDACCOUNT, PROPERTIES_TBL_USERS_IDPROFILE, PROPERTIES_TBL_USERS_IS_VENDOR, PROPERTIES_TBL_USERS_LASTVISIT, PROPERTIES_TBL_USERS_PASSWORD, PROPERTIES_TBL_USERS_PASSWORD_UPDATED, PROPERTIES_TBL_USERS_STATUS, PROPERTIES_TBL_USERS_SUPERUSER, PROPERTIES_TBL_USERS_TYPE_ID, PROPERTIES_TBL_USERS_UPDATE_TIME, PROPERTIES_TBL_USERS_UPDATE_USER_ID, 
		PROPERTIES_TBL_PROSPECT_CONTACT_OP, PROPERTIES_TBL_PROSPECT_CONTACT_ADDRESS_VALID, PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_USER_ID, PROPERTIES_TBL_PROSPECT_CONTACT_DEPRECATED_GUID_TO, PROPERTIES_TBL_PROSPECT_CONTACT_FULLTEXT_INDEX, PROPERTIES_TBL_PROSPECT_CONTACT_GUID, PROPERTIES_TBL_PROSPECT_CONTACT_ID, PROPERTIES_TBL_PROSPECT_CONTACT_IDACCOUNT, PROPERTIES_TBL_PROSPECT_CONTACT_IS_ACTIVE, PROPERTIES_TBL_PROSPECT_CONTACT_LIST_ID, PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_USER_ID, PROPERTIES_TBL_PROSPECT_CONTACT_VERSION
		,PROPERTIES_TBL_USERS_LANGUAGE,PROFILE_ETHNICITY,PROFILE_ADDRESS_SUITE,PROFILE_MIDDLE_NAME,PROFILE_TERMINATION_REASON,PROFILE_TERMINATION_DATE
		,PROFILE_acquired_business_,PROFILE_acquisition_date,PROFILE_SUPERVISOR_TAG)
        SELECT EMPLOYEE_ID AS EMPLOYEE_ID, PROFILE_ID AS PROFILE_ID, GUID AS GUID, BRANCH_ID AS BRANCH_ID, CREATED_AT AS CREATED_AT, CREATED_BY AS CREATED_BY, UPDATED_AT AS UPDATED_AT, UPDATED_BY AS UPDATED_BY, STATUS AS STATUS, HAS_SKILLS AS HAS_SKILLS, 
			replace(PROFILE:address::STRING,$$
$$,'''') AS PROFILE_ADDRESS, PROFILE:birthday::STRING AS PROFILE_BIRTHDAY, PROFILE:business_entity_::STRING AS PROFILE_BUSINESS_ENTITY_, PROFILE:city::STRING AS PROFILE_CITY, PROFILE:country::STRING AS PROFILE_COUNTRY, PROFILE:county_::STRING AS PROFILE_COUNTY_, PROFILE:do_not_hire_::STRING AS PROFILE_DO_NOT_HIRE_, PROFILE:email::STRING AS PROFILE_EMAIL, PROFILE:first_name::STRING AS PROFILE_FIRST_NAME, PROFILE:gender::STRING AS PROFILE_GENDER, PROFILE:import_id::STRING AS PROFILE_IMPORT_ID, PROFILE:job_title::STRING AS PROFILE_JOB_TITLE, PROFILE:last_name::STRING AS PROFILE_LAST_NAME, PROFILE:legacy_id::STRING AS PROFILE_LEGACY_ID, PROFILE:marital_status::STRING AS PROFILE_MARITAL_STATUS, PROFILE:personal_email::STRING AS PROFILE_PERSONAL_EMAIL, PROFILE:phone_main::STRING AS PROFILE_PHONE_MAIN, PROFILE:phone_personal::STRING AS PROFILE_PHONE_PERSONAL, PROFILE:ssn::STRING AS PROFILE_SSN, PROFILE:start_date::STRING AS PROFILE_START_DATE, PROFILE:state::STRING AS PROFILE_STATE, PROFILE:type_of_caregiver::STRING AS PROFILE_TYPE_OF_CAREGIVER, PROFILE:uid::STRING AS PROFILE_UID, PROFILE:zip::STRING AS PROFILE_ZIP, 
			USER_SETTINGS:STAFFING_EMPLOYEE_POSITION_TYPE::STRING AS USER_SETTINGS_STAFFING_EMPLOYEE_POSITION_TYPE, USER_SETTINGS:STAFFING_EMPLOYEE_RULE::STRING AS USER_SETTINGS_STAFFING_EMPLOYEE_RULE, USER_SETTINGS:STAFFING_PAYROLL_NUMBER::STRING AS USER_SETTINGS_STAFFING_PAYROLL_NUMBER, USER_SETTINGS:STAFFING_SIN_NUMBER::STRING AS USER_SETTINGS_STAFFING_SIN_NUMBER, 
			EMPLOYEE_MINIMUM_DAILY_CAPACITY AS EMPLOYEE_MINIMUM_DAILY_CAPACITY, EMPLOYEE_MAXIMUM_DAILY_CAPACITY AS EMPLOYEE_MAXIMUM_DAILY_CAPACITY, EMPLOYEE_MINIMUM_WEEKLY_CAPACITY AS EMPLOYEE_MINIMUM_WEEKLY_CAPACITY, EMPLOYEE_MAXIMUM_WEEKLY_CAPACITY AS EMPLOYEE_MAXIMUM_WEEKLY_CAPACITY, EMPLOYEE_CURRENT_CASELOAD AS EMPLOYEE_CURRENT_CASELOAD, 
			PROPERTIES_TBL_USERS:Op::STRING AS PROPERTIES_TBL_USERS_OP, PROPERTIES_TBL_USERS:activkey::STRING AS PROPERTIES_TBL_USERS_ACTIVKEY, PROPERTIES_TBL_USERS:create_time::STRING AS PROPERTIES_TBL_USERS_CREATE_TIME, PROPERTIES_TBL_USERS:create_user_id::STRING AS PROPERTIES_TBL_USERS_CREATE_USER_ID, PROPERTIES_TBL_USERS:display_id::STRING AS PROPERTIES_TBL_USERS_DISPLAY_ID, PROPERTIES_TBL_USERS:email::STRING AS PROPERTIES_TBL_USERS_EMAIL, PROPERTIES_TBL_USERS:guid::STRING AS PROPERTIES_TBL_USERS_GUID, PROPERTIES_TBL_USERS:id::STRING AS PROPERTIES_TBL_USERS_ID, PROPERTIES_TBL_USERS:idaccount::STRING AS PROPERTIES_TBL_USERS_IDACCOUNT, PROPERTIES_TBL_USERS:idprofile::STRING AS PROPERTIES_TBL_USERS_IDPROFILE, PROPERTIES_TBL_USERS:is_vendor::STRING AS PROPERTIES_TBL_USERS_IS_VENDOR, PROPERTIES_TBL_USERS:lastvisit::STRING AS PROPERTIES_TBL_USERS_LASTVISIT, PROPERTIES_TBL_USERS:password::STRING AS PROPERTIES_TBL_USERS_PASSWORD, PROPERTIES_TBL_USERS:password_updated::STRING AS PROPERTIES_TBL_USERS_PASSWORD_UPDATED, PROPERTIES_TBL_USERS:status::STRING AS PROPERTIES_TBL_USERS_STATUS, PROPERTIES_TBL_USERS:superuser::STRING AS PROPERTIES_TBL_USERS_SUPERUSER, PROPERTIES_TBL_USERS:type_id::STRING AS PROPERTIES_TBL_USERS_TYPE_ID, PROPERTIES_TBL_USERS:update_time::STRING AS PROPERTIES_TBL_USERS_UPDATE_TIME, PROPERTIES_TBL_USERS:update_user_id::STRING AS PROPERTIES_TBL_USERS_UPDATE_USER_ID, 
			PROPERTIES_TBL_PROSPECT_CONTACT:Op::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_OP, PROPERTIES_TBL_PROSPECT_CONTACT:address_valid::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_ADDRESS_VALID, PROPERTIES_TBL_PROSPECT_CONTACT:create_user_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_USER_ID, PROPERTIES_TBL_PROSPECT_CONTACT:deprecated_guid_to::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_DEPRECATED_GUID_TO, REPLACE(PROPERTIES_TBL_PROSPECT_CONTACT:fulltext_index::STRING,$$
$$,'''') AS PROPERTIES_TBL_PROSPECT_CONTACT_FULLTEXT_INDEX, PROPERTIES_TBL_PROSPECT_CONTACT:guid::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GUID, PROPERTIES_TBL_PROSPECT_CONTACT:id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_ID, PROPERTIES_TBL_PROSPECT_CONTACT:idaccount::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_IDACCOUNT, PROPERTIES_TBL_PROSPECT_CONTACT:is_active::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_IS_ACTIVE, PROPERTIES_TBL_PROSPECT_CONTACT:list_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_LIST_ID, PROPERTIES_TBL_PROSPECT_CONTACT:update_user_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_USER_ID, PROPERTIES_TBL_PROSPECT_CONTACT:version::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_VERSION
			,PROPERTIES_TBL_USERS:language::STRING AS PROPERTIES_TBL_USERS_LANGUAGE, PROFILE:ethnicity::STRING AS PROFILE_ETHNICITY
			,PROFILE:address_suite::STRING AS PROFILE_ADDRESS_SUITE,PROFILE:middle_name::STRING AS PROFILE_MIDDLE_NAME
			,PROFILE:termination_reason::STRING AS PROFILE_TERMINATION_REASON,PROFILE:termination_date::STRING AS PROFILE_TERMINATION_DATE
			,PROFILE:acquired_business_::STRING AS PROFILE_acquired_business_,PROFILE:acquisition_date::STRING AS PROFILE_acquisition_date
			,PROFILE:care_supervisor_tag::STRING AS PROFILE_SUPERVISOR_TAG
        FROM ALAYACARE_PRODUCTION."5C3EE5FE-45A5-4DA7-A35B-BD7CDAFE3548".SHARED_EMPLOYEE;

	SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
	return return_result;
END;
';