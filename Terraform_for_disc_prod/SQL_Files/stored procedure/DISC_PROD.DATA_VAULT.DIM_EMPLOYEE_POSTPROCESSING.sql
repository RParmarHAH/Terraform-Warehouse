CREATE OR REPLACE PROCEDURE DISC_PROD.DATA_VAULT.DIM_EMPLOYEE_POSTPROCESSING("STR_ETL_TASK_KEY" VARCHAR(16777216), "STR_CDC_START" VARCHAR(16777216), "STR_CDC_END" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
  RETURN_RESULT VARCHAR(1000);
BEGIN
              UPDATE DW_PROD.HAH.DIM_EMPLOYEE EMP SET MDM_DIM_EMPLOYEE_KEY = LNK.HASH_EMPLOYEE_KEY FROM DISC_PROD.DATA_VAULT.LINK_EMPLOYEE LNK WHERE LNK.LINK_EMPLOYEE_KEY = EMP.EMPLOYEE_KEY AND EMP.SOURCE_SYSTEM_ID IN (3,5,4,6);
	
SELECT CONCAT(''MESSAGE : '',"number of rows Updated",'' Rows Updated.'') into :RETURN_RESULT FROM TABLE(RESULT_SCAN(LAST_QUERY_ID())); 
RETURN return_result;
    END;
    ';