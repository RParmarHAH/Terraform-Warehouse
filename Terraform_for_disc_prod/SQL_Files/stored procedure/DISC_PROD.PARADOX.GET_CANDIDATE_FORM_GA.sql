CREATE OR REPLACE PROCEDURE DISC_PROD.PARADOX.GET_CANDIDATE_FORM_GA("TASKKEY" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
--*****************************************************************************************************************************
-- NAME:  GET_CANDIDATE_FORM_GA 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE				AUTHOR										NOTES:
-- ----------		-------------------							-----------------------------------------------------------------------------------------------
-- 2023-11-20		KOMAL DHOKAI/RAVI SUTHAR					INITIAL DEVELOPMENT
--*****************************************************************************************************************************


BEGIN 
    --TARGETSQL
    COPY INTO DISC_PROD.PARADOX.HIST_CANDIDATE_FORM_GA FROM (SELECT A.$1 FORM_NAME, A.$2 LOCATION_CODE, A.$3 LOCATION_NAME, A.$4 JOB_APPLIED_TO, A.$5 JOB_REQ_ID, A.$6 JOB_TITLE, A.$7 CURRENT_CANDIDATE_JOURNEY_STATUS, A.$8 CANDIDATE_ID, A.$9 CANDIDATE_NAME, A.$10 FORM_DATE_SENT, A.$11 FORM_IN_PROGRESS_DATE, A.$12 FORM_COMPLETION_STATUS, A.$13 FORM_DATE_SUBMITTED, A.$14 FORM_PREVIEW_LINK, A.$15 PUBLISHED_DATE, A.$16 PUBLISHED_VERSION, A.$17 PROFILE_ID, A.$18 MULTIPLE_RECORDS, A.$19 PRIMARY_IDENTIFIER, A.$20 REAPPLY_IN_CAPTURE, A.$21 REAPPLY_IN_JOB_SEARCH, A.$22 REAPPLY_IN_CAMPAIGN, A.$23 PERSONAL_INFORMATION_YOUR_FULL_NAME, A.$24 PERSONAL_INFORMATION_PHONE_NUMBER, A.$25 PERSONAL_INFORMATION_ALTERNATE_PHONE_NUMBER, A.$26 PERSONAL_INFORMATION_EMAIL_ADDRESS, TRIM(PARSE_JSON(A.$27):"ADDRESS",''"'') PERSONAL_INFORMATION_STREET_ADDRESS_LINE_1, TRIM(PARSE_JSON(A.$27):"ADDRESS_2",''"'') PERSONAL_INFORMATION_STREET_ADDRESS_LINE_2, TRIM(PARSE_JSON(A.$27):"CITY",''"'') PERSONAL_INFORMATION_CITY, TRIM(PARSE_JSON(A.$27):"STATE",''"'') PERSONAL_INFORMATION_STATE, TRIM(PARSE_JSON(A.$27):"ZIP_CODE",''"'') PERSONAL_INFORMATION_ZIP_CODE, NULL PERSONAL_INFORMATION_EMERGENCY_CONTACT_NAME, NULL PERSONAL_INFORMATION_EMERGENCY_CONTACT_ALTERNATE_PHONE_NUMBER, NULL PERSONAL_INFORMATION_EMERGENCY_CONTACT_ALTERNATE_PHONE_NUMBER, A.$28 PERSONAL_INFORMATION_DESIRED_PAY, A.$29 PERSONAL_INFORMATION_HOW_DID_YOU_HEAR_ABOUT_THIS_JOB_, A.$30 PERSONAL_INFORMATION_IF_REFERRAL_PLEASE_LIST_EMPLOYEE_NAME_TYPE_N_A_IF_NOT_APPLICABLE_, A.$31 PERSONAL_INFORMATION_AVAILABLE_DAYS, A.$32 PERSONAL_INFORMATION_HOW_MANY_HOURS_ARE_YOU_AVAILABLE_PER_DAY_, A.$33 PERSONAL_INFORMATION_HAVE_YOU_PREVIOUSLY_WORKED_FOR_HELP_AT_HOME_, A.$34 PERSONAL_INFORMATION_DO_YOU_HAVE_RELATIVES_AND_OR_FAMILY_MEMBERS_OF_YOUR_HOUSEHOLD_WHO_ARE_EMPLOYED_BY_HELP_AT_HOME_, A.$35 PERSONAL_INFORMATION_DO_YOU_HAVE_THE_LEGAL_RIGHT_TO_WORK_IN_THE_US_WITHOUT_SPONSORSHIPS_, A.$36 PERSONAL_INFORMATION_ARE_YOU_AGE_18_OR_OLDER_, NULL PERSONAL_INFORMATION_HAVE_YOU_COMPLETED_A_TB_TEST_IN_THE_PAST_6_MONTHS, A.$37 WORK_EXPERIENCE_1_WORK_EXPERIENCE, A.$38 WORK_EXPERIENCE_2_WORK_EXPERIENCE, A.$39 WORK_EXPERIENCE_3_WORK_EXPERIENCE, A.$40 WORK_EXPERIENCE_4_WORK_EXPERIENCE, A.$41 WORK_EXPERIENCE_5_WORK_EXPERIENCE, A.$42 WORK_EXPERIENCE_1_COMPANY_NAME, A.$43 WORK_EXPERIENCE_2_COMPANY_NAME, A.$44 WORK_EXPERIENCE_3_COMPANY_NAME, A.$45 WORK_EXPERIENCE_4_COMPANY_NAME, A.$46 WORK_EXPERIENCE_5_COMPANY_NAME, A.$47 WORK_EXPERIENCE_1_LOCATION_CITY_STATE, A.$48 WORK_EXPERIENCE_2_LOCATION_CITY_STATE, A.$49 WORK_EXPERIENCE_3_LOCATION_CITY_STATE, A.$50 WORK_EXPERIENCE_4_LOCATION_CITY_STATE, A.$51 WORK_EXPERIENCE_5_LOCATION_CITY_STATE, A.$52 WORK_EXPERIENCE_1_PHONE_NUMBER, A.$53 WORK_EXPERIENCE_2_PHONE_NUMBER, A.$54 WORK_EXPERIENCE_3_PHONE_NUMBER, A.$55 WORK_EXPERIENCE_4_PHONE_NUMBER, A.$56 WORK_EXPERIENCE_5_PHONE_NUMBER, A.$57 WORK_EXPERIENCE_1_SUPERVISOR_NAME, A.$58 WORK_EXPERIENCE_2_SUPERVISOR_NAME, A.$59 WORK_EXPERIENCE_3_SUPERVISOR_NAME, A.$60 WORK_EXPERIENCE_4_SUPERVISOR_NAME, A.$61 WORK_EXPERIENCE_5_SUPERVISOR_NAME, A.$62 WORK_EXPERIENCE_1_JOB_TITLE, A.$63 WORK_EXPERIENCE_2_JOB_TITLE, A.$64 WORK_EXPERIENCE_3_JOB_TITLE, A.$65 WORK_EXPERIENCE_4_JOB_TITLE, A.$66 WORK_EXPERIENCE_5_JOB_TITLE, A.$67 WORK_EXPERIENCE_1_DATE_STARTED, A.$68 WORK_EXPERIENCE_2_DATE_STARTED, A.$69 WORK_EXPERIENCE_3_DATE_STARTED, A.$70 WORK_EXPERIENCE_4_DATE_STARTED, A.$71 WORK_EXPERIENCE_5_DATE_STARTED, A.$72 WORK_EXPERIENCE_1_DATE_ENDED, A.$73 WORK_EXPERIENCE_2_DATE_ENDED, A.$74 WORK_EXPERIENCE_3_DATE_ENDED, A.$75 WORK_EXPERIENCE_4_DATE_ENDED, A.$76 WORK_EXPERIENCE_5_DATE_ENDED, A.$77 WORK_EXPERIENCE_1_REASON_FOR_LEAVING, A.$78 WORK_EXPERIENCE_2_REASON_FOR_LEAVING, A.$79 WORK_EXPERIENCE_3_REASON_FOR_LEAVING, A.$80 WORK_EXPERIENCE_4_REASON_FOR_LEAVING, A.$81 WORK_EXPERIENCE_5_REASON_FOR_LEAVING, A.$82 WORK_EXPERIENCE_1_MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE_, A.$83 WORK_EXPERIENCE_2_MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE_, A.$84 WORK_EXPERIENCE_3_MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE_, A.$85 WORK_EXPERIENCE_4_MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE_, A.$86 WORK_EXPERIENCE_5_MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE_, A.$87 EDUCATION_NAME_OF_SCHOOL, A.$88 EDUCATION_LOCATION_OF_SCHOOL, A.$89 EDUCATION_TYPE_OF_SCHOOL, A.$90 EDUCATION_GRADUATED_OR_COMPLETED, A.$91 REFERENCES_, A.$92 REFERENCES_REFERENCE_1_NAME, A.$93 REFERENCES_REFERENCE_1_PHONE_NUMBER, A.$94 REFERENCES_REFERENCE_1_RELATIONSHIP, A.$95 REFERENCES_REFERENCE_2_NAME, A.$96 REFERENCES_REFERENCE_2_PHONE_NUMBER, A.$97 REFERENCES_REFERENCE_2_RELATIONSHIP, A.$98 DIVERSITY_QUESTIONS_ETHNICITY, A.$99 DIVERSITY_QUESTIONS_GENDER, A.$100 DIVERSITY_QUESTIONS_MARITAL_STATUS, A.$101 DIVERSITY_QUESTIONS_PLEASE_PROVIDE_AN_ANSWER_BELOW, A.$102 FINAL_SUBMISSION, :TASKKEY AS ETL_TASK_KEY, :TASKKEY AS ETL_INSERTED_TASK_KEY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, CURRENT_USER() AS ETL_INSERTED_BY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, CURRENT_USER() AS ETL_LAST_UPDATED_BY, 0 AS ETL_DELETED_FLAG FROM @DISC_PROD.STAGE.AWSAZSTAGEPROD/PARADOX/Upload_file/FormsCandidate.Forms.Detail.Report.Wide.Format.Ga.Application (FILE_FORMAT => DISC_PROD.STAGE.CSV_FORMAT) A);

    --VIEWSQL
    CREATE OR REPLACE TABLE DISC_PROD.PARADOX.CANDIDATE_FORM_GA AS SELECT FORM_NAME FORM_NAME, LOCATION_CODE LOCATION_CODE, LOCATION_NAME LOCATION_NAME, JOB_APPLIED_TO JOB_APPLIED_TO, JOB_REQ_ID JOB_REQ_ID, JOB_TITLE JOB_TITLE, CURRENT_CANDIDATE_JOURNEY_STATUS CURRENT_CANDIDATE_JOURNEY_STATUS, CANDIDATE_ID CANDIDATE_ID, CANDIDATE_NAME CANDIDATE_NAME, FORM_DATE_SENT FORM_DATE_SENT, FORM_IN_PROGRESS_DATE FORM_IN_PROGRESS_DATE, FORM_COMPLETION_STATUS FORM_COMPLETION_STATUS, FORM_DATE_SUBMITTED FORM_DATE_SUBMITTED, FORM_PREVIEW_LINK FORM_PREVIEW_LINK, PUBLISHED_DATE PUBLISHED_DATE, PUBLISHED_VERSION PUBLISHED_VERSION, PROFILE_ID PROFILE_ID, MULTIPLE_RECORDS MULTIPLE_RECORDS, PRIMARY_IDENTIFIER PRIMARY_IDENTIFIER, REAPPLY_IN_CAPTURE REAPPLY_IN_CAPTURE, REAPPLY_IN_JOB_SEARCH REAPPLY_IN_JOB_SEARCH, REAPPLY_IN_CAMPAIGN REAPPLY_IN_CAMPAIGN, PERSONAL_INFORMATION_YOUR_FULL_NAME PERSONAL_INFORMATION_YOUR_FULL_NAME, PERSONAL_INFORMATION_CELL_PHONE_NUMBER PERSONAL_INFORMATION_CELL_PHONE_NUMBER, PERSONAL_INFORMATION_ALTERNATE_PHONE_NUMBER PERSONAL_INFORMATION_ALTERNATE_PHONE_NUMBER, PERSONAL_INFORMATION_EMAIL_ADDRESS PERSONAL_INFORMATION_EMAIL_ADDRESS, PERSONAL_INFORMATION_STREET_ADDRESS_LINE_1 PERSONAL_INFORMATION_STREET_ADDRESS_LINE_1, PERSONAL_INFORMATION_STREET_ADDRESS_LINE_2 PERSONAL_INFORMATION_STREET_ADDRESS_LINE_2, PERSONAL_INFORMATION_CITY PERSONAL_INFORMATION_CITY, PERSONAL_INFORMATION_STATE PERSONAL_INFORMATION_STATE, PERSONAL_INFORMATION_ZIP_CODE PERSONAL_INFORMATION_ZIP_CODE, PERSONAL_INFORMATION_EMERGENCY_CONTACT_NAME PERSONAL_INFORMATION_EMERGENCY_CONTACT_NAME, PERSONAL_INFORMATION_EMERGENCY_CONTACT_PHONE_NUMBER PERSONAL_INFORMATION_EMERGENCY_CONTACT_PHONE_NUMBER, PERSONAL_INFORMATION_EMERGENCY_CONTACT_ALTERNATE_PHONE_NUMBER PERSONAL_INFORMATION_EMERGENCY_CONTACT_ALTERNATE_PHONE_NUMBER, PERSONAL_INFORMATION_DESIRED_PAY PERSONAL_INFORMATION_DESIRED_PAY, PERSONAL_INFORMATION_HOW_DID_YOU_HEAR_ABOUT_THIS_JOB PERSONAL_INFORMATION_HOW_DID_YOU_HEAR_ABOUT_THIS_JOB, PERSONAL_INFORMATION_IF_REFERRAL_PLEASE_LIST_EMPLOYEE_NAME_TYPE_NA_IF_NOT_APPLICABLE PERSONAL_INFORMATION_IF_REFERRAL_PLEASE_LIST_EMPLOYEE_NAME_TYPE_NA_IF_NOT_APPLICABLE, PERSONAL_INFORMATION_AVAILABLE_DAYS PERSONAL_INFORMATION_AVAILABLE_DAYS, PERSONAL_INFORMATION_HOW_MANY_HOURS_ARE_YOU_AVAILABLE_PER_DAY PERSONAL_INFORMATION_HOW_MANY_HOURS_ARE_YOU_AVAILABLE_PER_DAY, PERSONAL_INFORMATION_HAVE_YOU_PREVIOUSLY_WORKED_FOR_HELP_AT_HOME PERSONAL_INFORMATION_HAVE_YOU_PREVIOUSLY_WORKED_FOR_HELP_AT_HOME, PERSONAL_INFORMATION_DO_YOU_HAVE_RELATIVES_ANDOR_FAMILY_MEMBERS_OF_YOUR_HOUSEHOLD_WHO_ARE_EMPLOYED_BY_HELP_AT_HOME PERSONAL_INFORMATION_DO_YOU_HAVE_RELATIVES_ANDOR_FAMILY_MEMBERS_OF_YOUR_HOUSEHOLD_WHO_ARE_EMPLOYED_BY_HELP_AT_HOME, PERSONAL_INFORMATION_DO_YOU_HAVE_THE_LEGAL_RIGHT_TO_WORK_IN_THE_US_WITHOUT_SPONSORSHIPS PERSONAL_INFORMATION_DO_YOU_HAVE_THE_LEGAL_RIGHT_TO_WORK_IN_THE_US_WITHOUT_SPONSORSHIPS, PERSONAL_INFORMATION_ARE_YOU_AGE_18_OR_OLDER PERSONAL_INFORMATION_ARE_YOU_AGE_18_OR_OLDER, PERSONAL_INFORMATION_HAVE_YOU_COMPLETED_A_TB_TEST_IN_THE_PAST_6_MONTHS PERSONAL_INFORMATION_HAVE_YOU_COMPLETED_A_TB_TEST_IN_THE_PAST_6_MONTHS, WORK_EXPERIENCE_1__WORK_EXPERIENCE WORK_EXPERIENCE_1__WORK_EXPERIENCE, WORK_EXPERIENCE_2__WORK_EXPERIENCE WORK_EXPERIENCE_2__WORK_EXPERIENCE, WORK_EXPERIENCE_3__WORK_EXPERIENCE WORK_EXPERIENCE_3__WORK_EXPERIENCE, WORK_EXPERIENCE_4__WORK_EXPERIENCE WORK_EXPERIENCE_4__WORK_EXPERIENCE, WORK_EXPERIENCE_5__WORK_EXPERIENCE WORK_EXPERIENCE_5__WORK_EXPERIENCE, WORK_EXPERIENCE_1__COMPANY_NAME WORK_EXPERIENCE_1__COMPANY_NAME, WORK_EXPERIENCE_2__COMPANY_NAME WORK_EXPERIENCE_2__COMPANY_NAME, WORK_EXPERIENCE_3__COMPANY_NAME WORK_EXPERIENCE_3__COMPANY_NAME, WORK_EXPERIENCE_4__COMPANY_NAME WORK_EXPERIENCE_4__COMPANY_NAME, WORK_EXPERIENCE_5__COMPANY_NAME WORK_EXPERIENCE_5__COMPANY_NAME, WORK_EXPERIENCE_1__LOCATION_CITYSTATE WORK_EXPERIENCE_1__LOCATION_CITYSTATE, WORK_EXPERIENCE_2__LOCATION_CITYSTATE WORK_EXPERIENCE_2__LOCATION_CITYSTATE, WORK_EXPERIENCE_3__LOCATION_CITYSTATE WORK_EXPERIENCE_3__LOCATION_CITYSTATE, WORK_EXPERIENCE_4__LOCATION_CITYSTATE WORK_EXPERIENCE_4__LOCATION_CITYSTATE, WORK_EXPERIENCE_5__LOCATION_CITYSTATE WORK_EXPERIENCE_5__LOCATION_CITYSTATE, WORK_EXPERIENCE_1__PHONE_NUMBER WORK_EXPERIENCE_1__PHONE_NUMBER, WORK_EXPERIENCE_2__PHONE_NUMBER WORK_EXPERIENCE_2__PHONE_NUMBER, WORK_EXPERIENCE_3__PHONE_NUMBER WORK_EXPERIENCE_3__PHONE_NUMBER, WORK_EXPERIENCE_4__PHONE_NUMBER WORK_EXPERIENCE_4__PHONE_NUMBER, WORK_EXPERIENCE_5__PHONE_NUMBER WORK_EXPERIENCE_5__PHONE_NUMBER, WORK_EXPERIENCE_1__SUPERVISOR_NAME WORK_EXPERIENCE_1__SUPERVISOR_NAME, WORK_EXPERIENCE_2__SUPERVISOR_NAME WORK_EXPERIENCE_2__SUPERVISOR_NAME, WORK_EXPERIENCE_3__SUPERVISOR_NAME WORK_EXPERIENCE_3__SUPERVISOR_NAME, WORK_EXPERIENCE_4__SUPERVISOR_NAME WORK_EXPERIENCE_4__SUPERVISOR_NAME, WORK_EXPERIENCE_5__SUPERVISOR_NAME WORK_EXPERIENCE_5__SUPERVISOR_NAME, WORK_EXPERIENCE_1__JOB_TITLE WORK_EXPERIENCE_1__JOB_TITLE, WORK_EXPERIENCE_2__JOB_TITLE WORK_EXPERIENCE_2__JOB_TITLE, WORK_EXPERIENCE_3__JOB_TITLE WORK_EXPERIENCE_3__JOB_TITLE, WORK_EXPERIENCE_4__JOB_TITLE WORK_EXPERIENCE_4__JOB_TITLE, WORK_EXPERIENCE_5__JOB_TITLE WORK_EXPERIENCE_5__JOB_TITLE, WORK_EXPERIENCE_1__DATE_STARTED WORK_EXPERIENCE_1__DATE_STARTED, WORK_EXPERIENCE_2__DATE_STARTED WORK_EXPERIENCE_2__DATE_STARTED, WORK_EXPERIENCE_3__DATE_STARTED WORK_EXPERIENCE_3__DATE_STARTED, WORK_EXPERIENCE_4__DATE_STARTED WORK_EXPERIENCE_4__DATE_STARTED, WORK_EXPERIENCE_5__DATE_STARTED WORK_EXPERIENCE_5__DATE_STARTED, WORK_EXPERIENCE_1__DATE_ENDED WORK_EXPERIENCE_1__DATE_ENDED, WORK_EXPERIENCE_2__DATE_ENDED WORK_EXPERIENCE_2__DATE_ENDED, WORK_EXPERIENCE_3__DATE_ENDED WORK_EXPERIENCE_3__DATE_ENDED, WORK_EXPERIENCE_4__DATE_ENDED WORK_EXPERIENCE_4__DATE_ENDED, WORK_EXPERIENCE_5__DATE_ENDED WORK_EXPERIENCE_5__DATE_ENDED, WORK_EXPERIENCE_1__REASON_FOR_LEAVING WORK_EXPERIENCE_1__REASON_FOR_LEAVING, WORK_EXPERIENCE_2__REASON_FOR_LEAVING WORK_EXPERIENCE_2__REASON_FOR_LEAVING, WORK_EXPERIENCE_3__REASON_FOR_LEAVING WORK_EXPERIENCE_3__REASON_FOR_LEAVING, WORK_EXPERIENCE_4__REASON_FOR_LEAVING WORK_EXPERIENCE_4__REASON_FOR_LEAVING, WORK_EXPERIENCE_5__REASON_FOR_LEAVING WORK_EXPERIENCE_5__REASON_FOR_LEAVING, WORK_EXPERIENCE_1__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE WORK_EXPERIENCE_1__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE, WORK_EXPERIENCE_2__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE WORK_EXPERIENCE_2__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE, WORK_EXPERIENCE_3__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE WORK_EXPERIENCE_3__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE, WORK_EXPERIENCE_4__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE WORK_EXPERIENCE_4__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE, WORK_EXPERIENCE_5__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE WORK_EXPERIENCE_5__MAY_WE_CONTACT_YOUR_PREVIOUS_EMPLOYER_FOR_A_REFERENCE, EDUCATION_NAME_OF_SCHOOL EDUCATION_NAME_OF_SCHOOL, EDUCATION_LOCATION_OF_SCHOOL EDUCATION_LOCATION_OF_SCHOOL, EDUCATION_TYPE_OF_SCHOOL EDUCATION_TYPE_OF_SCHOOL, EDUCATION_GRADUATED_OR_COMPLETED EDUCATION_GRADUATED_OR_COMPLETED, REFERENCES REFERENCES, REFERENCES_REFERENCE_1_NAME REFERENCES_REFERENCE_1_NAME, REFERENCES_REFERENCE_1_PHONE_NUMBER REFERENCES_REFERENCE_1_PHONE_NUMBER, REFERENCES_REFERENCE_1_RELATIONSHIP REFERENCES_REFERENCE_1_RELATIONSHIP, REFERENCES_REFERENCE_2_NAME REFERENCES_REFERENCE_2_NAME, REFERENCES_REFERENCE_2_PHONE_NUMBER REFERENCES_REFERENCE_2_PHONE_NUMBER, REFERENCES_REFERENCE_2_RELATIONSHIP REFERENCES_REFERENCE_2_RELATIONSHIP, DIVERSITY_QUESTIONS_ETHNICITY DIVERSITY_QUESTIONS_ETHNICITY, DIVERSITY_QUESTIONS_GENDER DIVERSITY_QUESTIONS_GENDER, DIVERSITY_QUESTIONS_MARITAL_STATUS DIVERSITY_QUESTIONS_MARITAL_STATUS, DIVERSITY_QUESTIONS_PLEASE_PROVIDE_AN_ANSWER_BELOW DIVERSITY_QUESTIONS_PLEASE_PROVIDE_AN_ANSWER_BELOW, FINAL_SUBMISSION FINAL_SUBMISSION, :TASKKEY AS ETL_TASK_KEY, :TASKKEY AS ETL_INSERTED_TASK_KEY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, CURRENT_USER() AS ETL_INSERTED_BY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, CURRENT_USER() AS ETL_LAST_UPDATED_BY, 0 AS ETL_DELETED_FLAG FROM DISC_PROD.PARADOX.HIST_CANDIDATE_FORM_GA WHERE ETL_LAST_UPDATED_DATE = (SELECT MAX(ETL_LAST_UPDATED_DATE) FROM DISC_PROD.PARADOX.HIST_CANDIDATE_FORM_GA);

    RETURN ''SUCCESS'';
END;

';