CREATE OR REPLACE PROCEDURE DISC_PROD.RISKONNECT.GET_HC_AMBULATORY_EVENT("TASKKEY" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS ' 
--*****************************************************************************************************************************
-- NAME:  DISC_PROD.RISKONNECT.GET_HC_AMBULATORY_EVENT 
--
-- PURPOSE: To Load Discovery Layer Tables
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2023-11-20 		Ravi Suthar            	Initial Development
--*****************************************************************************************************************************

BEGIN 
    --TargetSQL
    COPY INTO DISC_PROD.RISKONNECT.HIST_HC_Ambulatory_Event from (SELECT T.$1 AS Id,  T.$2 AS OwnerId,  T.$3 AS IsDeleted,  T.$4 AS Name,  T.$5 AS RecordTypeId,  REPLACE(T.$6,''T'','' '')::TIMESTAMP_NTZ(9) AS CreatedDate,  T.$7 AS CreatedById,  REPLACE(T.$8,''T'','' '')::TIMESTAMP_NTZ(9) AS LastModifiedDate,  T.$9 AS LastModifiedById,  REPLACE(T.$10,''T'','' '')::TIMESTAMP_NTZ(9) AS SystemModstamp,  T.$11 AS LastActivityDate,  T.$12 AS LastViewedDate,  T.$13 AS LastReferencedDate,  T.$14 AS ConnectionReceivedId,  T.$15 AS ConnectionSentId,  T.$16 AS ADR_Reaction__c,  T.$17 AS ADT_Event_Type__c,  T.$18 AS AHRQ_Harm_Scale__c,  T.$19 AS Action_Taken_to_Resolve_Event__c,  T.$20 AS Actions_Taken_to_Prevent_Re_Occurrence__c,  T.$21 AS Actual_Route_of_Administration__c,  T.$22 AS Additional_Event_Details__c,  T.$23 AS Admit_Visit_Date__c,  T.$24 AS Admitting_Diagnosis__c,  T.$25 AS Adverse_Outcome__c,  T.$26 AS Altered_Sensation__c,  T.$27 AS Ambulatory_Event_Status__c,  T.$28 AS Anesthesia_Sedation_Utilized__c,  T.$29 AS Anonymous_Reporter__c,  T.$30 AS Anticipated_Harm_Duration__c,  T.$31 AS Antidote_Utilized__c,  T.$32 AS Associated_with_Handoff__c,  T.$33 AS Behavior_Discussed_with_Patient__c,  T.$34 AS Behavior_issue__c,  T.$35 AS Blistering_Ulceration__c,  T.$36 AS Blood_Product_Event_Category__c,  T.$37 AS Blood_Stage_Discover_Other__c,  T.$38 AS Blood_Stage_Event_Originated_Other__c,  T.$39 AS Body_Part__c,  T.$40 AS Brand_Name__c,  T.$41 AS Claim__c,  T.$42 AS Compound_Preperation_Ingredients__c,  T.$43 AS Consent_Document_Issue__c,  T.$44 AS Converted_to_Claim__c,  T.$45 AS Converted_to_Patient_Feedback__c,  T.$46 AS Count_Performed_for_Object_Retained__c,  T.$47 AS Date_Event_Closed__c,  T.$48 AS Date_Provider_Notified__c,  T.$49 AS Date_Reopened__c,  T.$50 AS Date_of_ADR__c,  T.$51 AS Date_of_Event__c,  T.$52 AS Date_of_Fall_Risk_Assessment__c,  T.$53 AS Decreased_Perfusion__c,  T.$54 AS Device_Removed__c,  T.$55 AS Diagnostic_Issue_for_Lab__c,  T.$56 AS Diagnostic_Radiology_Issue__c,  T.$57 AS Did_Event_Involve_Tempature_Excursion__c,  T.$58 AS Do_Not_Submit_to_PSO__c,  T.$59 AS Dosage_Form__c,  T.$60 AS Dosage_of_Drug__c,  T.$61 AS Drug_Classification__c,  T.$62 AS Drug_Given_to_Treat_ADR__c,  T.$63 AS Drug_Manufacturer__c,  T.$64 AS During_What_Stage_Was_Event_Discovered__c,  T.$65 AS Event_Description__c,  T.$66 AS Event_Discovery_Date__c,  T.$67 AS Event_Discovery_Time__c,  T.$68 AS Event_Documented_in_MR__c,  T.$69 AS Event_Procedure__c,  T.$70 AS Fall_Risk_Assessment_Documented__c,  T.$71 AS Generic_Medication__c,  T.$72 AS Generic_Name__c,  T.$73 AS History_of_Allergies__c,  T.$74 AS Hospitalized__c,  T.$75 AS How_Preventable_was_Event__c,  T.$76 AS IM_Status__c,  T.$77 AS Incorrect_Action_Involved__c,  T.$78 AS Incorrect_Dose_s__c,  T.$79 AS Incorrect_Rate__c,  T.$80 AS Incorrect_Strength_or_Concentration__c,  T.$81 AS Incorrect_Timing__c,  T.$82 AS Initial_Interventions__c,  T.$83 AS Initial_PDF_Created__c,  T.$84 AS Intended_Route_of_Admin__c,  T.$85 AS Intended_Route_of_Administration__c,  T.$86 AS Intervention_Attempted__c,  T.$87 AS Intervention_Documented__c,  T.$88 AS Level_of_Sedation__c,  T.$89 AS Location_of_Catheter_Cannula__c,  T.$90 AS Manufacturer__c,  T.$91 AS Measures_in_Place_to_Prevent_Fall__c,  T.$92 AS Med_Sub_Contraindication__c,  T.$93 AS Medication_Contributed_to_Fall__c,  T.$94 AS Medication_Substance_Expiration_Date__c,  T.$95 AS Medication_Substance_Incorrect_Action__c,  T.$96 AS Medication_Type__c,  T.$97 AS NQF_Reportable_Event__c,  T.$98 AS Name_of_Device_Information_System__c,  T.$99 AS Name_of_Provider__c,  T.$100 AS Nutrition_Issue__c,  T.$101 AS On_Meds_Known_to_Increase_Fall__c,  T.$102 AS Other_ADR_Reaction__c,  T.$103 AS Other_Activity_Prior_to_Fall__c,  T.$104 AS Other_Actual_Route_of_Admin__c,  T.$105 AS Other_Adverse_Outcome__c,  T.$106 AS Other_Behavior_Issue__c,  T.$107 AS Other_Blood_Product_Incorrect_Action__c,  T.$108 AS Other_Blood_Product_Involved__c,  T.$109 AS Other_Diagnostic_Radiology_Issue__c,  T.$110 AS Other_Fall_Risk_Factors_Present_at_Fall__c,  T.$111 AS Other_Intended_Route_of_Admin__c,  T.$112 AS Other_Intervention_Documented__c,  T.$113 AS Other_Laboratory_Issue__c,  T.$114 AS Other_Location_of_Catheter_Cannula__c,  T.$115 AS Other_Measures_in_Place_to_Prevent_Fall__c,  T.$116 AS Other_Med_Sub_Incorrect_Action__c,  T.$117 AS Other_Products__c,  T.$118 AS Other_Reason_for_Hosp_Trans_Admission__c,  T.$119 AS Other_Retained_Object__c,  T.$120 AS Other_Stage_Med_Sub_Event_Originated__c,  T.$121 AS Other_Substance_Involved__c,  T.$122 AS Other_Tempature_Excursion__c,  T.$123 AS Other_Treatment_Procedure_Issue__c,  T.$124 AS Other_Type_of_Airway_Management_Problem__c,  T.$125 AS Other_Type_of_Anesthesia_Sedation_Event__c,  T.$126 AS Other_Type_of_Incorrect_Surgery__c,  T.$127 AS Other_Type_of_Injury_Sustained__c,  T.$128 AS Other_Type_of_Sedation_Issue__c,  T.$129 AS Other_Type_of_Surgical_Event__c,  T.$130 AS PSO_Time_Submission__c,  T.$131 AS Pain_Level__c,  T.$132 AS Patient_Account_Number__c,  T.$133 AS Patient_Activity_Prior_to_Fall__c,  T.$134 AS Patient_Address_1__c,  T.$135 AS Patient_Address_2__c,  T.$136 AS Patient_Business_Phone__c,  T.$137 AS Patient_City__c,  T.$138 AS Patient_Class__c,  T.$139 AS Patient_DOB__c,  T.$140 AS Patient_DOD__c,  T.$141 AS Patient_Email__c,  T.$142 AS Patient_Feedback__c,  T.$143 AS Patient_First_Name__c,  T.$144 AS Patient_Gender__c,  T.$145 AS Patient_Home_Phone__c,  T.$146 AS Patient_Last_Name__c,  T.$147 AS Patient_MRN__c,  T.$148 AS Patient_Marital_Status__c,  T.$149 AS Patient_Middle_Name__c,  T.$150 AS Patient_Notified_of_Event__c,  T.$151 AS Patient_SSN__c,  T.$152 AS Patient_State__c,  T.$153 AS Patient_Suffix__c,  T.$154 AS Patient_Visit__c,  T.$155 AS Patient_Zip_Code__c,  T.$156 AS Patient_at_Increased_Risk_for_Fall__c,  T.$157 AS Patient_refered_to_Social_Worker__c,  T.$158 AS Patient_s_Race__c,  T.$159 AS Phase_of_Lab_Process__c,  T.$160 AS Phase_of_Radiology_Process__c,  T.$161 AS Physical_Device_Contrbute_to_Fall__c,  T.$162 AS Physical_Injury_as_a_Result_of_The_Fall__c,  T.$163 AS Primary_Facility__c,  T.$164 AS Primary_Language__c,  T.$165 AS Primary_Location__c,  T.$166 AS Primary_Medication_Count__c,  T.$167 AS Primary_Medication__c,  T.$168 AS Provider_First_Name__c,  T.$169 AS Provider_Last_Name__c,  T.$170 AS Provider_Notified__c,  T.$171 AS Rate_of_Administration__c,  T.$172 AS Re_Submission_Date__c,  T.$173 AS Re_submission_File_Name__c,  T.$174 AS Reason_for_Hospital_Transfer_Admission__c,  T.$175 AS Reason_for_Tempature_Excursion__c,  T.$176 AS Report_Date__c,  T.$177 AS Reportable_Event_Cause__c,  T.$178 AS Reported_Count_Status__c,  T.$179 AS Reporter_Email__c,  T.$180 AS Reporter_First_Name__c,  T.$181 AS Reporter_Job_or_Position__c,  T.$182 AS Reporter_Last_Name__c,  T.$183 AS Reporter__c,  T.$184 AS Reporter_phone__c,  T.$185 AS Resubmit_to_PSO__c,  T.$186 AS Review_Record_s_Auto_Created__c,  T.$187 AS Reviewer_Additional_Details__c,  T.$188 AS Reviwer_Comments__c,  T.$189 AS Risk_Factors_Present_at_Time_of_Fall__c,  T.$190 AS Secondary_Facility__c,  T.$191 AS Secondary_Location__c,  T.$192 AS Sentinel_Event__c,  T.$193 AS Serial_Number__c,  T.$194 AS Serious_Reportable_Event__c,  T.$195 AS Service_Line_AE__c,  T.$196 AS Severity_of_Burn__c,  T.$197 AS Severity_of_Event__c,  T.$198 AS Shift__c,  T.$199 AS Skin_Appearance__c,  T.$200 AS Stage_Blood_Event_Originated__c,  T.$201 AS Stage_Med_Sub_Event_Originate__c,  T.$202 AS State_Regulatory_Agency_ies_Notified__c,  T.$203 AS Status__c,  T.$204 AS Strength__c,  T.$205 AS Strength_of_Drug__c,  T.$206 AS Supervision_by_Anesthesiologist__c,  T.$207 AS Surgical_Anesthesia_event_discovered__c,  T.$208 AS Surgical_Event_Discovered__c,  T.$209 AS Swelling__c,  T.$210 AS Time_Provider_Notified__c,  T.$211 AS Time_of_Event__c,  T.$212 AS Type__c,  T.$213 AS Type_of_Airway_Management_Problem__c,  T.$214 AS Type_of_Anesthesia_Event__c,  T.$215 AS Type_of_Anesthesia__c,  T.$216 AS Type_of_Blood_Product_Involved__c,  T.$217 AS Type_of_Consent_Invovled__c,  T.$218 AS Type_of_Event__c,  T.$219 AS Type_of_Incorrect_Surgery__c,  T.$220 AS Type_of_Medication_substance_Involved__c,  T.$221 AS Type_of_Object_Retained__c,  T.$222 AS Type_of_Sedation_Issue__c,  T.$223 AS Type_of_Surgical_Event__c,  T.$224 AS Type_of_Treatment_Procedure__c,  T.$225 AS Was_Device_in_the_Patient__c,  T.$226 AS Was_Issue_Documented_in_the_EHR__c,  T.$227 AS Was_Surgery_Required__c,  T.$228 AS Was_The_Fall_Observed__c,  T.$229 AS Was_The_Fall_Unassisted_or_Assisted__c,  T.$230 AS Was_the_Drug_Involved_a_Narcotic__c,  T.$231 AS Were_symptoms_resolved__c,  T.$232 AS What_Device_was_Involved__c,  T.$233 AS What_Type_of_Biological_Products__c,  T.$234 AS What_Type_of_Injury_Was_Sustained__c,  T.$235 AS What_Was_the_Volume__c,  T.$236 AS What_was_the_Admission_Event_Other__c,  T.$237 AS What_was_the_Admission_Event__c,  T.$238 AS What_was_the_Discharge_Event_Other__c,  T.$239 AS What_was_the_Discharge_Event__c,  T.$240 AS What_was_the_Transfer_Event_Other__c,  T.$241 AS What_was_the_Transfer_Event__c,  T.$242 AS When_Was_Harm_Assessed__c,  T.$243 AS Where_Did_the_Fall_Occur__c,  T.$244 AS Which_Fire_Burn_Occurred__c,  T.$245 AS Who_Administered_Anesthesia__c,  T.$246 AS Who_Observed_The_Fall__c,  T.$247 AS Witness_Name__c,  T.$248 AS X_ray_Obtained_to_Detect_Object__c,  T.$249 AS Age_of_Event__c,  T.$250 AS Department_Name__c,  T.$251 AS Facility_Name__c,  T.$252 AS IM_Delete_Flag__c,  T.$253 AS Name_of_Treatment_Procedure__c,  T.$254 AS Office_Name__c,  T.$255 AS Patient_Name__c,  T.$256 AS Patient_s_Age_at_Event_AHRQ__c,  T.$257 AS Patient_s_Age_at_Event__c,  T.$258 AS Patient_s_Age_at_Event_in_Days__c,  T.$259 AS Region__c,  T.$260 AS Risk_Management_Reviewed__c,  T.$261 AS Convert_to_Claim__c,  T.$262 AS Staff_on_Shift__c,  T.$263 AS Reviewed_by_Q_C__c,  T.$264 AS Internal_Notes__c,  T.$265 AS Compliance_Concern__c,  T.$266 AS Alleged_Theft__c,  T.$267 AS Populates_Date_for_Letters__c, -1 AS ETL_TASK_KEY, -1 AS ETL_INSERTED_TASK_KEY, current_timestamp::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, current_user() AS ETL_INSERTED_BY, current_timestamp::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, current_user() AS ETL_LAST_UPDATED_BY, 0 as ETL_DELETED_FLAG FROM @DISC_PROD.STAGE.AWSAZSTAGEPROD/Riskonnect/Daily_data (file_format => DISC_PROD.STAGE.CSV_FORMAT_UTF8_FALSE,PATTERN => ''.*HC_Ambulatory_Event_.*[.]csv'')T);

    --ViewSQL
    CREATE OR REPLACE TABLE DISC_PROD.RISKONNECT.HC_Ambulatory_Event AS SELECT ID,  OWNERID,  ISDELETED,  NAME,  RECORDTYPEID,  CREATEDDATE,  CREATEDBYID,  LASTMODIFIEDDATE,  LASTMODIFIEDBYID,  SYSTEMMODSTAMP,  LASTACTIVITYDATE,  LASTVIEWEDDATE,  LASTREFERENCEDDATE,  CONNECTIONRECEIVEDID,  CONNECTIONSENTID,  ADR_REACTION__C,  ADT_EVENT_TYPE__C,  AHRQ_HARM_SCALE__C,  ACTION_TAKEN_TO_RESOLVE_EVENT__C,  ACTIONS_TAKEN_TO_PREVENT_RE_OCCURRENCE__C,  ACTUAL_ROUTE_OF_ADMINISTRATION__C,  ADDITIONAL_EVENT_DETAILS__C,  ADMIT_VISIT_DATE__C,  ADMITTING_DIAGNOSIS__C,  ADVERSE_OUTCOME__C,  ALTERED_SENSATION__C,  AMBULATORY_EVENT_STATUS__C,  ANESTHESIA_SEDATION_UTILIZED__C,  ANONYMOUS_REPORTER__C,  ANTICIPATED_HARM_DURATION__C,  ANTIDOTE_UTILIZED__C,  ASSOCIATED_WITH_HANDOFF__C,  BEHAVIOR_DISCUSSED_WITH_PATIENT__C,  BEHAVIOR_ISSUE__C,  BLISTERING_ULCERATION__C,  BLOOD_PRODUCT_EVENT_CATEGORY__C,  BLOOD_STAGE_DISCOVER_OTHER__C,  BLOOD_STAGE_EVENT_ORIGINATED_OTHER__C,  BODY_PART__C,  BRAND_NAME__C,  CLAIM__C,  COMPOUND_PREPERATION_INGREDIENTS__C,  CONSENT_DOCUMENT_ISSUE__C,  CONVERTED_TO_CLAIM__C,  CONVERTED_TO_PATIENT_FEEDBACK__C,  COUNT_PERFORMED_FOR_OBJECT_RETAINED__C,  DATE_EVENT_CLOSED__C,  DATE_PROVIDER_NOTIFIED__C,  DATE_REOPENED__C,  DATE_OF_ADR__C,  DATE_OF_EVENT__C,  DATE_OF_FALL_RISK_ASSESSMENT__C,  DECREASED_PERFUSION__C,  DEVICE_REMOVED__C,  DIAGNOSTIC_ISSUE_FOR_LAB__C,  DIAGNOSTIC_RADIOLOGY_ISSUE__C,  DID_EVENT_INVOLVE_TEMPATURE_EXCURSION__C,  DO_NOT_SUBMIT_TO_PSO__C,  DOSAGE_FORM__C,  DOSAGE_OF_DRUG__C,  DRUG_CLASSIFICATION__C,  DRUG_GIVEN_TO_TREAT_ADR__C,  DRUG_MANUFACTURER__C,  DURING_WHAT_STAGE_WAS_EVENT_DISCOVERED__C,  EVENT_DESCRIPTION__C,  EVENT_DISCOVERY_DATE__C,  EVENT_DISCOVERY_TIME__C,  EVENT_DOCUMENTED_IN_MR__C,  EVENT_PROCEDURE__C,  FALL_RISK_ASSESSMENT_DOCUMENTED__C,  GENERIC_MEDICATION__C,  GENERIC_NAME__C,  HISTORY_OF_ALLERGIES__C,  HOSPITALIZED__C,  HOW_PREVENTABLE_WAS_EVENT__C,  IM_STATUS__C,  INCORRECT_ACTION_INVOLVED__C,  INCORRECT_DOSE_S__C,  INCORRECT_RATE__C,  INCORRECT_STRENGTH_OR_CONCENTRATION__C,  INCORRECT_TIMING__C,  INITIAL_INTERVENTIONS__C,  INITIAL_PDF_CREATED__C,  INTENDED_ROUTE_OF_ADMIN__C,  INTENDED_ROUTE_OF_ADMINISTRATION__C,  INTERVENTION_ATTEMPTED__C,  INTERVENTION_DOCUMENTED__C,  LEVEL_OF_SEDATION__C,  LOCATION_OF_CATHETER_CANNULA__C,  MANUFACTURER__C,  MEASURES_IN_PLACE_TO_PREVENT_FALL__C,  MED_SUB_CONTRAINDICATION__C,  MEDICATION_CONTRIBUTED_TO_FALL__C,  MEDICATION_SUBSTANCE_EXPIRATION_DATE__C,  MEDICATION_SUBSTANCE_INCORRECT_ACTION__C,  MEDICATION_TYPE__C,  NQF_REPORTABLE_EVENT__C,  NAME_OF_DEVICE_INFORMATION_SYSTEM__C,  NAME_OF_PROVIDER__C,  NUTRITION_ISSUE__C,  ON_MEDS_KNOWN_TO_INCREASE_FALL__C,  OTHER_ADR_REACTION__C,  OTHER_ACTIVITY_PRIOR_TO_FALL__C,  OTHER_ACTUAL_ROUTE_OF_ADMIN__C,  OTHER_ADVERSE_OUTCOME__C,  OTHER_BEHAVIOR_ISSUE__C,  OTHER_BLOOD_PRODUCT_INCORRECT_ACTION__C,  OTHER_BLOOD_PRODUCT_INVOLVED__C,  OTHER_DIAGNOSTIC_RADIOLOGY_ISSUE__C,  OTHER_FALL_RISK_FACTORS_PRESENT_AT_FALL__C,  OTHER_INTENDED_ROUTE_OF_ADMIN__C,  OTHER_INTERVENTION_DOCUMENTED__C,  OTHER_LABORATORY_ISSUE__C,  OTHER_LOCATION_OF_CATHETER_CANNULA__C,  OTHER_MEASURES_IN_PLACE_TO_PREVENT_FALL__C,  OTHER_MED_SUB_INCORRECT_ACTION__C,  OTHER_PRODUCTS__C,  OTHER_REASON_FOR_HOSP_TRANS_ADMISSION__C,  OTHER_RETAINED_OBJECT__C,  OTHER_STAGE_MED_SUB_EVENT_ORIGINATED__C,  OTHER_SUBSTANCE_INVOLVED__C,  OTHER_TEMPATURE_EXCURSION__C,  OTHER_TREATMENT_PROCEDURE_ISSUE__C,  OTHER_TYPE_OF_AIRWAY_MANAGEMENT_PROBLEM__C,  OTHER_TYPE_OF_ANESTHESIA_SEDATION_EVENT__C,  OTHER_TYPE_OF_INCORRECT_SURGERY__C,  OTHER_TYPE_OF_INJURY_SUSTAINED__C,  OTHER_TYPE_OF_SEDATION_ISSUE__C,  OTHER_TYPE_OF_SURGICAL_EVENT__C,  PSO_TIME_SUBMISSION__C,  PAIN_LEVEL__C,  PATIENT_ACCOUNT_NUMBER__C,  PATIENT_ACTIVITY_PRIOR_TO_FALL__C,  PATIENT_ADDRESS_1__C,  PATIENT_ADDRESS_2__C,  PATIENT_BUSINESS_PHONE__C,  PATIENT_CITY__C,  PATIENT_CLASS__C,  PATIENT_DOB__C,  PATIENT_DOD__C,  PATIENT_EMAIL__C,  PATIENT_FEEDBACK__C,  PATIENT_FIRST_NAME__C,  PATIENT_GENDER__C,  PATIENT_HOME_PHONE__C,  PATIENT_LAST_NAME__C,  PATIENT_MRN__C,  PATIENT_MARITAL_STATUS__C,  PATIENT_MIDDLE_NAME__C,  PATIENT_NOTIFIED_OF_EVENT__C,  PATIENT_SSN__C,  PATIENT_STATE__C,  PATIENT_SUFFIX__C,  PATIENT_VISIT__C,  PATIENT_ZIP_CODE__C,  PATIENT_AT_INCREASED_RISK_FOR_FALL__C,  PATIENT_REFERED_TO_SOCIAL_WORKER__C,  PATIENT_S_RACE__C,  PHASE_OF_LAB_PROCESS__C,  PHASE_OF_RADIOLOGY_PROCESS__C,  PHYSICAL_DEVICE_CONTRBUTE_TO_FALL__C,  PHYSICAL_INJURY_AS_A_RESULT_OF_THE_FALL__C,  PRIMARY_FACILITY__C,  PRIMARY_LANGUAGE__C,  PRIMARY_LOCATION__C,  PRIMARY_MEDICATION_COUNT__C,  PRIMARY_MEDICATION__C,  PROVIDER_FIRST_NAME__C,  PROVIDER_LAST_NAME__C,  PROVIDER_NOTIFIED__C,  RATE_OF_ADMINISTRATION__C,  RE_SUBMISSION_DATE__C,  RE_SUBMISSION_FILE_NAME__C,  REASON_FOR_HOSPITAL_TRANSFER_ADMISSION__C,  REASON_FOR_TEMPATURE_EXCURSION__C,  REPORT_DATE__C,  REPORTABLE_EVENT_CAUSE__C,  REPORTED_COUNT_STATUS__C,  REPORTER_EMAIL__C,  REPORTER_FIRST_NAME__C,  REPORTER_JOB_OR_POSITION__C,  REPORTER_LAST_NAME__C,  REPORTER__C,  REPORTER_PHONE__C,  RESUBMIT_TO_PSO__C,  REVIEW_RECORD_S_AUTO_CREATED__C,  REVIEWER_ADDITIONAL_DETAILS__C,  REVIWER_COMMENTS__C,  RISK_FACTORS_PRESENT_AT_TIME_OF_FALL__C,  SECONDARY_FACILITY__C,  SECONDARY_LOCATION__C,  SENTINEL_EVENT__C,  SERIAL_NUMBER__C,  SERIOUS_REPORTABLE_EVENT__C,  SERVICE_LINE_AE__C,  SEVERITY_OF_BURN__C,  SEVERITY_OF_EVENT__C,  SHIFT__C,  SKIN_APPEARANCE__C,  STAGE_BLOOD_EVENT_ORIGINATED__C,  STAGE_MED_SUB_EVENT_ORIGINATE__C,  STATE_REGULATORY_AGENCY_IES_NOTIFIED__C,  STATUS__C,  STRENGTH__C,  STRENGTH_OF_DRUG__C,  SUPERVISION_BY_ANESTHESIOLOGIST__C,  SURGICAL_ANESTHESIA_EVENT_DISCOVERED__C,  SURGICAL_EVENT_DISCOVERED__C,  SWELLING__C,  TIME_PROVIDER_NOTIFIED__C,  TIME_OF_EVENT__C,  TYPE__C,  TYPE_OF_AIRWAY_MANAGEMENT_PROBLEM__C,  TYPE_OF_ANESTHESIA_EVENT__C,  TYPE_OF_ANESTHESIA__C,  TYPE_OF_BLOOD_PRODUCT_INVOLVED__C,  TYPE_OF_CONSENT_INVOVLED__C,  TYPE_OF_EVENT__C,  TYPE_OF_INCORRECT_SURGERY__C,  TYPE_OF_MEDICATION_SUBSTANCE_INVOLVED__C,  TYPE_OF_OBJECT_RETAINED__C,  TYPE_OF_SEDATION_ISSUE__C,  TYPE_OF_SURGICAL_EVENT__C,  TYPE_OF_TREATMENT_PROCEDURE__C,  WAS_DEVICE_IN_THE_PATIENT__C,  WAS_ISSUE_DOCUMENTED_IN_THE_EHR__C,  WAS_SURGERY_REQUIRED__C,  WAS_THE_FALL_OBSERVED__C,  WAS_THE_FALL_UNASSISTED_OR_ASSISTED__C,  WAS_THE_DRUG_INVOLVED_A_NARCOTIC__C,  WERE_SYMPTOMS_RESOLVED__C,  WHAT_DEVICE_WAS_INVOLVED__C,  WHAT_TYPE_OF_BIOLOGICAL_PRODUCTS__C,  WHAT_TYPE_OF_INJURY_WAS_SUSTAINED__C,  WHAT_WAS_THE_VOLUME__C,  WHAT_WAS_THE_ADMISSION_EVENT_OTHER__C,  WHAT_WAS_THE_ADMISSION_EVENT__C,  WHAT_WAS_THE_DISCHARGE_EVENT_OTHER__C,  WHAT_WAS_THE_DISCHARGE_EVENT__C,  WHAT_WAS_THE_TRANSFER_EVENT_OTHER__C,  WHAT_WAS_THE_TRANSFER_EVENT__C,  WHEN_WAS_HARM_ASSESSED__C,  WHERE_DID_THE_FALL_OCCUR__C,  WHICH_FIRE_BURN_OCCURRED__C,  WHO_ADMINISTERED_ANESTHESIA__C,  WHO_OBSERVED_THE_FALL__C,  WITNESS_NAME__C,  X_RAY_OBTAINED_TO_DETECT_OBJECT__C,  AGE_OF_EVENT__C,  DEPARTMENT_NAME__C,  FACILITY_NAME__C,  IM_DELETE_FLAG__C,  NAME_OF_TREATMENT_PROCEDURE__C,  OFFICE_NAME__C,  PATIENT_NAME__C,  PATIENT_S_AGE_AT_EVENT_AHRQ__C,  PATIENT_S_AGE_AT_EVENT__C,  PATIENT_S_AGE_AT_EVENT_IN_DAYS__C,  REGION__C,  RISK_MANAGEMENT_REVIEWED__C,  CONVERT_TO_CLAIM__C,  STAFF_ON_SHIFT__C,  REVIEWED_BY_Q_C__C,  INTERNAL_NOTES__C,  COMPLIANCE_CONCERN__C,  ALLEGED_THEFT__C,  POPULATES_DATE_FOR_LETTERS__C, :TaskKey AS ETL_TASK_KEY, :TaskKey AS ETL_INSERTED_TASK_KEY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, CURRENT_USER() AS ETL_INSERTED_BY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, CURRENT_USER() AS ETL_LAST_UPDATED_BY, 0 AS ETL_DELETED_FLAG FROM DISC_PROD.RISKONNECT.HIST_HC_Ambulatory_Event WHERE (ID,ETL_LAST_UPDATED_DATE) IN (SELECT ID,MAX(ETL_LAST_UPDATED_DATE) FROM DISC_PROD.RISKONNECT.HIST_HC_Ambulatory_Event GROUP BY ID);

    return ''Success'';
END;
';