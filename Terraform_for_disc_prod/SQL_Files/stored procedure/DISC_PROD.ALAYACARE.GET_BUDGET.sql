CREATE OR REPLACE PROCEDURE DISC_PROD.ALAYACARE.GET_BUDGET()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
--*****************************************************************************************************************************
-- NAME:  GET_BUDGET 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2021-11-11		UNKNOWN					INITIAL DEVELOPMENT
-- 2023-09-05  		RAVI SUTHAR            	MIGRATED JavaScript to SQL
--*****************************************************************************************************************************
    return_result varchar(1000);
BEGIN
	
    INSERT OVERWRITE INTO ALAYACARE.BUDGET (
        BUDGET_ITEM_ID, BUDGET_ID, BUDGET_NAME, BUDGET_STATUS, BUDGET_IS_DISABLE, BUDGET_ITEM_START_AT, BUDGET_ITEM_END_AT, DAYS, BUDGET_START_AT, BUDGET_END_AT, BUDGET_CREATION_DATE, BUDGET_REVISION_DATE, CLIENT_ID, CONTACT_ID, EMPLOYEE_ID, EMPLOYEE_CREATE_ID, EMPLOYEE_UPDATE_ID, SERVICE_ID, BILLITEM_ID, FUNDER_ID, PREMIUM_ID, CATALOGUEITEM_ID, BUDGET_ITEM_NAME, BUDGET_ITEM_CODE, BUDGET_ITEM_CATEGORY, INCOME_CODE_DESCRIPTION, BUDGET_ITEM_CONTIGENCY, AMOUNT, CONTIGENCY_AMOUNT, BUDGET_CONTIGENCY_AMOUNT, CUSTOM_BUDGET_ITEM_RATE, BUDGET_ITEM_RATE, BUDGET_ITEM_UNIT)
        SELECT BUDGET_ITEM_ID AS BUDGET_ITEM_ID, BUDGET_ID AS BUDGET_ID, BUDGET_NAME AS BUDGET_NAME, BUDGET_STATUS AS BUDGET_STATUS, BUDGET_IS_DISABLE AS BUDGET_IS_DISABLE, BUDGET_ITEM_START_AT AS BUDGET_ITEM_START_AT, BUDGET_ITEM_END_AT AS BUDGET_ITEM_END_AT, DAYS AS DAYS, BUDGET_START_AT AS BUDGET_START_AT, BUDGET_END_AT AS BUDGET_END_AT, BUDGET_CREATION_DATE AS BUDGET_CREATION_DATE, BUDGET_REVISION_DATE AS BUDGET_REVISION_DATE, CLIENT_ID AS CLIENT_ID, CONTACT_ID AS CONTACT_ID, EMPLOYEE_ID AS EMPLOYEE_ID, EMPLOYEE_CREATE_ID AS EMPLOYEE_CREATE_ID, EMPLOYEE_UPDATE_ID AS EMPLOYEE_UPDATE_ID, SERVICE_ID AS SERVICE_ID, BILLITEM_ID AS BILLITEM_ID, FUNDER_ID AS FUNDER_ID, PREMIUM_ID AS PREMIUM_ID, CATALOGUEITEM_ID AS CATALOGUEITEM_ID, BUDGET_ITEM_NAME AS BUDGET_ITEM_NAME, BUDGET_ITEM_CODE AS BUDGET_ITEM_CODE, BUDGET_ITEM_CATEGORY AS BUDGET_ITEM_CATEGORY, INCOME_CODE_DESCRIPTION AS INCOME_CODE_DESCRIPTION, BUDGET_ITEM_CONTIGENCY AS BUDGET_ITEM_CONTIGENCY, AMOUNT AS AMOUNT, CONTIGENCY_AMOUNT AS CONTIGENCY_AMOUNT, BUDGET_CONTIGENCY_AMOUNT AS BUDGET_CONTIGENCY_AMOUNT, CUSTOM_BUDGET_ITEM_RATE AS CUSTOM_BUDGET_ITEM_RATE, BUDGET_ITEM_RATE AS BUDGET_ITEM_RATE, BUDGET_ITEM_UNIT AS BUDGET_ITEM_UNIT 
        FROM ALAYACARE_PRODUCTION."5C3EE5FE-45A5-4DA7-A35B-BD7CDAFE3548".SHARED_BUDGET;

	SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
	return return_result;
END;
';