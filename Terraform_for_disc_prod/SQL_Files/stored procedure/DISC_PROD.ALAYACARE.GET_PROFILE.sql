CREATE OR REPLACE PROCEDURE DISC_PROD.ALAYACARE.GET_PROFILE()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
--*****************************************************************************************************************************
-- NAME:  GET_PROFILE 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2021-11-11		UNKNOWN					INITIAL DEVELOPMENT
-- 2023-09-05  		RAVI SUTHAR            	MIGRATED JavaScript to SQL
--*****************************************************************************************************************************
    return_result varchar(1000);
BEGIN
	
    INSERT OVERWRITE INTO ALAYACARE.PROFILE (
        PROFILE_ID, PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_USER_ID, PROPERTIES_TBL_PROSPECT_CONTACT_ID, PROPERTIES_TBL_PROSPECT_CONTACT_IDACCOUNT, 
PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT_OP, PROPERTIES_TBL_PROSPECT_CONTACT_DEPRECATED_GUID_TO, PROPERTIES_TBL_PROSPECT_CONTACT_GUID, 
PROPERTIES_TBL_PROSPECT_CONTACT_FULLTEXT_INDEX, PROPERTIES_TBL_PROSPECT_CONTACT_LIST_ID, PROPERTIES_TBL_PROSPECT_CONTACT_ADDRESS_VALID, PROPERTIES_TBL_PROSPECT_CONTACT_VERSION, 
PROPERTIES_TBL_PROSPECT_CONTACT_IS_ACTIVE, PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT_GEO_LON, PROPERTIES_TBL_PROSPECT_CONTACT_GEO_CODED, 
PROPERTIES_TBL_PROSPECT_CONTACT_GEO_LAT, PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_USER_ID, PROFILE_NAME, PROFILE_GUARDIAN_OR_PRIMARY_CONTACT_PHONE_NUMBER, PROFILE_ADDRESS, 
PROFILE_COUNTY, PROFILE_COMPANY_, PROFILE_COMPANY, PROFILE_LEGACY_ID, PROFILE_COUNTRY, PROFILE_STATE, PROFILE_UID, PROFILE_PAYER_1, PROFILE_JOB_CLASS, PROFILE_CITY, 
PROFILE_GUARDIAN_OR_PRIMARY_CONTACT, PROFILE_SANDATA, PROFILE_TERMINATION_REASON, PROFILE_ETHNICITY, PROFILE_REFERRAL_DATE, PROFILE_LAST_NAME, PROFILE_ZIP, 
PROFILE_MEDICAID_PRIOR_AUTHORIZATION_NUMBER, PROFILE_ADDRESS_SUITE, PROFILE_IMPORT_ID, PROFILE_PHONE_PERSONAL, PROFILE_START_ON, PROFILE_SSN, PROFILE_BIRTHDAY,
 PROFILE_START_DATE, PROFILE_PHONE_MAIN, PROFILE_PERSONAL_EMAIL, PROFILE_BUSINESS_ENTITY_, PROFILE_MEMBER_ID, PROFILE_EMAIL, PROFILE_REMARKS, PROFILE_PAYMENT_ARRANGEMENT, 
PROFILE_TELLUS, PROFILE_MANAGEMENT_LEVEL, PROFILE_PHONE_OTHER, PROFILE_STATE_ID, PROFILE_JOB_TITLE, PROFILE_TERMINATION_DATE, PROFILE_FAX, PROFILE_DO_NOT_HIRE_,
 PROFILE_SALUTATION, PROFILE_GENDER, PROFILE_DATAFLEX_CONTRACT_IDS, PROFILE_MIDDLE_NAME, PROFILE_COMMUNICATION_METHOD, PROFILE_MEDICAID_ID, PROFILE_MARITAL_STATUS, 
PROFILE_TYPE_OF_CAREGIVER, PROFILE_FIRST_NAME, PREFERRED_LANGUAGE, AGE, AGE_RANGE,PROFILE_REFERRAL_SOURCE)
        SELECT PROFILE_ID AS PROFILE_ID, PROPERTIES_TBL_PROSPECT_CONTACT:create_user_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_USER_ID,
 PROPERTIES_TBL_PROSPECT_CONTACT:id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_ID, PROPERTIES_TBL_PROSPECT_CONTACT:idaccount::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_IDACCOUNT,
 PROPERTIES_TBL_PROSPECT_CONTACT:update_time::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_TIME, 
PROPERTIES_TBL_PROSPECT_CONTACT:Op::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_OP, 
PROPERTIES_TBL_PROSPECT_CONTACT:deprecated_guid_to::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_DEPRECATED_GUID_TO, 
PROPERTIES_TBL_PROSPECT_CONTACT:guid::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GUID, 
PROPERTIES_TBL_PROSPECT_CONTACT:fulltext_index::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_FULLTEXT_INDEX, 
PROPERTIES_TBL_PROSPECT_CONTACT:list_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_LIST_ID, 
PROPERTIES_TBL_PROSPECT_CONTACT:address_valid::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_ADDRESS_VALID, 
PROPERTIES_TBL_PROSPECT_CONTACT:version::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_VERSION, 
PROPERTIES_TBL_PROSPECT_CONTACT:is_active::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_IS_ACTIVE, 
PROPERTIES_TBL_PROSPECT_CONTACT:create_time::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_TIME, 
PROPERTIES_TBL_PROSPECT_CONTACT:geo_lon::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GEO_LON, 
PROPERTIES_TBL_PROSPECT_CONTACT:geo_coded::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GEO_CODED, 
PROPERTIES_TBL_PROSPECT_CONTACT:geo_lat::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GEO_LAT, 
PROPERTIES_TBL_PROSPECT_CONTACT:update_user_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_USER_ID, 
PROFILE:name::STRING AS PROFILE_NAME, PROFILE:guardian_or_primary_contact_phone_number::STRING AS PROFILE_GUARDIAN_OR_PRIMARY_CONTACT_PHONE_NUMBER, 
PROFILE:address::STRING AS PROFILE_ADDRESS, PROFILE:county::STRING AS PROFILE_COUNTY, PROFILE:company_::STRING AS PROFILE_COMPANY_, 
PROFILE:company::STRING AS PROFILE_COMPANY, PROFILE:legacy_id::STRING AS PROFILE_LEGACY_ID, PROFILE:country::STRING AS PROFILE_COUNTRY, 
PROFILE:state::STRING AS PROFILE_STATE, PROFILE:uid::STRING AS PROFILE_UID, PROFILE:payer_1::STRING AS PROFILE_PAYER_1, 
PROFILE:job_class::STRING AS PROFILE_JOB_CLASS, PROFILE:city::STRING AS PROFILE_CITY, PROFILE:guardian_or_primary_contact::STRING AS PROFILE_GUARDIAN_OR_PRIMARY_CONTACT, 
PROFILE:sandata::STRING AS PROFILE_SANDATA, PROFILE:termination_reason::STRING AS PROFILE_TERMINATION_REASON, PROFILE:ethnicity::STRING AS PROFILE_ETHNICITY, 
PROFILE:referral_date::STRING AS PROFILE_REFERRAL_DATE, PROFILE:last_name::STRING AS PROFILE_LAST_NAME, PROFILE:zip::STRING AS PROFILE_ZIP, 
PROFILE:medicaid_prior_authorization_number::STRING AS PROFILE_MEDICAID_PRIOR_AUTHORIZATION_NUMBER, PROFILE:address_suite::STRING AS PROFILE_ADDRESS_SUITE, 
PROFILE:import_id::STRING AS PROFILE_IMPORT_ID, PROFILE:phone_personal::STRING AS PROFILE_PHONE_PERSONAL, PROFILE:start_on::STRING AS PROFILE_START_ON,
 PROFILE:ssn::STRING AS PROFILE_SSN, PROFILE:birthday::STRING AS PROFILE_BIRTHDAY, PROFILE:start_date::STRING AS PROFILE_START_DATE, 
PROFILE:phone_main::STRING AS PROFILE_PHONE_MAIN, PROFILE:personal_email::STRING AS PROFILE_PERSONAL_EMAIL, PROFILE:business_entity_::STRING AS PROFILE_BUSINESS_ENTITY_, 
PROFILE:member_id::STRING AS PROFILE_MEMBER_ID, PROFILE:email::STRING AS PROFILE_EMAIL, PROFILE:remarks::STRING AS PROFILE_REMARKS, 
PROFILE:payment_arrangement::STRING AS PROFILE_PAYMENT_ARRANGEMENT, PROFILE:tellus::STRING AS PROFILE_TELLUS, PROFILE:management_level::STRING AS PROFILE_MANAGEMENT_LEVEL,
 PROFILE:phone_other::STRING AS PROFILE_PHONE_OTHER, PROFILE:state_id::STRING AS PROFILE_STATE_ID, PROFILE:job_title::STRING AS PROFILE_JOB_TITLE, 
PROFILE:termination_date::STRING AS PROFILE_TERMINATION_DATE, PROFILE:fax::STRING AS PROFILE_FAX, PROFILE:do_not_hire_::STRING AS PROFILE_DO_NOT_HIRE_, 
PROFILE:salutation::STRING AS PROFILE_SALUTATION, PROFILE:gender::STRING AS PROFILE_GENDER, PROFILE:dataflex_contract_ids::STRING AS PROFILE_DATAFLEX_CONTRACT_IDS, 
PROFILE:middle_name::STRING AS PROFILE_MIDDLE_NAME, PROFILE:communication_method::STRING AS PROFILE_COMMUNICATION_METHOD, PROFILE:medicaid_id::STRING AS PROFILE_MEDICAID_ID, 
PROFILE:marital_status::STRING AS PROFILE_MARITAL_STATUS, PROFILE:type_of_caregiver::STRING AS PROFILE_TYPE_OF_CAREGIVER, PROFILE:first_name::STRING AS PROFILE_FIRST_NAME, 
PREFERRED_LANGUAGE AS PREFERRED_LANGUAGE, AGE AS AGE, AGE_RANGE AS AGE_RANGE, PROFILE:referral_source::STRING AS PROFILE_REFERRAL_SOURCE 
FROM ALAYACARE_PRODUCTION."5C3EE5FE-45A5-4DA7-A35B-BD7CDAFE3548".SHARED_PROFILE;

	SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
	return return_result;
END;
';