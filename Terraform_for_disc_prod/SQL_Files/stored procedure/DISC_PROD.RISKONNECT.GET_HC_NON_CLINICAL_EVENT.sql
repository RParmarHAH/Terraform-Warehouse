CREATE OR REPLACE PROCEDURE DISC_PROD.RISKONNECT.GET_HC_NON_CLINICAL_EVENT("TASKKEY" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS ' 
--*****************************************************************************************************************************
-- NAME:  DISC_PROD.RISKONNECT.GET_HC_NON_CLINICAL_EVENT 
--
-- PURPOSE: To Load Discovery Layer Tables
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2023-11-20 		Ravi Suthar            	Initial Development
--*****************************************************************************************************************************

BEGIN 
    --TargetSQL
    COPY INTO DISC_PROD.RISKONNECT.HIST_HC_Non_Clinical_Event from (SELECT T.$1 AS Id,  T.$2 AS OwnerId,  T.$3 AS IsDeleted,  T.$4 AS Name,  T.$5 AS RecordTypeId,  REPLACE(T.$6,''T'','' '')::TIMESTAMP_NTZ(9) AS CreatedDate,  T.$7 AS CreatedById,  REPLACE(T.$8,''T'','' '')::TIMESTAMP_NTZ(9) AS LastModifiedDate,  T.$9 AS LastModifiedById,  REPLACE(T.$10,''T'','' '')::TIMESTAMP_NTZ(9) AS SystemModstamp,  T.$11 AS LastActivityDate,  T.$12 AS LastViewedDate,  T.$13 AS LastReferencedDate,  T.$14 AS ConnectionReceivedId,  T.$15 AS ConnectionSentId,  T.$16 AS Action_Taken_to_Resolve_Event__c,  T.$17 AS Action_taken_as_a_result_of_accident__c,  T.$18 AS Additional_Event_Details__c,  T.$19 AS Admin_billing_system_component__c,  T.$20 AS Admit_Visit_Date__c,  T.$21 AS Admitting_Diagnosis__c,  T.$22 AS Agency_Involved__c,  T.$23 AS Anonymous_Reporter__c,  T.$24 AS Anticipated_Harm_Duration__c,  T.$25 AS Associated_with_Handoff__c,  T.$26 AS Body_Part_Injured__c,  T.$27 AS Body_part_affected_be_specific_please__c,  T.$28 AS Cause_of_Flood__c,  T.$29 AS Claim__c,  T.$30 AS Client_Injury__c,  T.$31 AS Communication_Method__c,  T.$32 AS Communication_Time_Frame__c,  T.$33 AS Company_Vehicle__c,  T.$34 AS Complete_Patient_Form__c,  T.$35 AS Compliance_item_Violated__c,  T.$36 AS Converted_to_Claim__c,  T.$37 AS Converted_to_Patient_Feedback__c,  T.$38 AS Date_Event_Closed__c,  T.$39 AS Date_Provider_Notified__c,  T.$40 AS Date_Reopened__c,  T.$41 AS Date_Reported_to_Reg_Govt_Agency__c,  T.$42 AS Date_of_Event__c,  T.$43 AS Department_Notified__c,  T.$44 AS Did_Fire_EMS_respond__c,  T.$45 AS Did_the_emergency_generator_turn_on__c,  T.$46 AS Did_you_contact_communications_dept__c,  T.$47 AS Disclosure_billing_or_account_errors__c,  T.$48 AS Discrepancy_Type__c,  T.$49 AS Do_Not_Submit_to_PSO__c,  T.$50 AS EHR_Type_or_Component_Involved__c,  T.$51 AS EMS_911_Called__c,  T.$52 AS Employee_in_vehicle__c,  T.$53 AS Employee_s_Person_s_involved__c,  T.$54 AS Employees_involved_in_accident__c,  T.$55 AS Event_Description__c,  T.$56 AS Event_Discovery_Date__c,  T.$57 AS Event_Discovery_Time__c,  T.$58 AS Event_Documented_in_MR__c,  T.$59 AS Everyone_evacuated_due_to_event__c,  T.$60 AS Fire_Department_Specific_Findings__c,  T.$61 AS Fire_alarm_activate_automatically__c,  T.$62 AS Fire_at_Client_Home_Staff_present__c,  T.$63 AS Fire_dept_report_anything_specific__c,  T.$64 AS Flood_at_Client_Home_Staff_Present__c,  T.$65 AS Follow_up_Details__c,  T.$66 AS Follow_up__c,  T.$67 AS Gender_of_Caller__c,  T.$68 AS Govt_agency_involved_at_this_time__c,  T.$69 AS HIT_Device_Related_to_Event_Unsafe_Cond__c,  T.$70 AS Has_the_facility_been_closed__c,  T.$71 AS Hospitalized__c,  T.$72 AS How_Incident_Discovered_Reported__c,  T.$73 AS How_Preventable_was_Event__c,  T.$74 AS How_made_aware_of_this_investigation__c,  T.$75 AS How_many_days_is_the_facility_closed__c,  T.$76 AS How_was_contact_initiated__c,  T.$77 AS How_was_information_returned__c,  T.$78 AS How_was_the_health_hazard_discovered__c,  T.$79 AS How_was_threat_received__c,  T.$80 AS IM_Status__c,  T.$81 AS Identity_known__c,  T.$82 AS Information_Disclosed_Description__c,  T.$83 AS Information_Disclosed_Format__c,  T.$84 AS Information_Disclosed_Other_Format__c,  T.$85 AS Information_Disclosed__c,  T.$86 AS Information_recovered_destroyed__c,  T.$87 AS Initial_PDF_Created__c,  T.$88 AS Injury_from_the_accident__c,  T.$89 AS Involved_Party_Address_1__c,  T.$90 AS Involved_Party_Address_2__c,  T.$91 AS Involved_Party_City__c,  T.$92 AS Involved_Party_Email__c,  T.$93 AS Involved_Party_First_Name__c,  T.$94 AS Involved_Party_Job_Position__c,  T.$95 AS Involved_Party_Last_Name__c,  T.$96 AS Involved_Party_Phone__c,  T.$97 AS Involved_Party_Postal_Code__c,  T.$98 AS Involved_Party_State__c,  T.$99 AS Is_this_a_patient_related_event__c,  T.$100 AS Location_damages__c,  T.$101 AS Location_or_alleged_location_of_weapon__c,  T.$102 AS Manufacturer__c,  T.$103 AS Many_Individuals__c,  T.$104 AS Medical_Treatment_or_First_Aid_Provided__c,  T.$105 AS Name_of_Device_Information_System__c,  T.$106 AS Name_of_Provider__c,  T.$107 AS Name_of_media_outlet__c,  T.$108 AS Name_of_person_contacting_the_Facility__c,  T.$109 AS Name_of_utility_vendor_contacted__c,  T.$110 AS Non_Clinical_Event_Status__c,  T.$111 AS Notify_when_Investigation_complete__c,  T.$112 AS Number_of_Individuals__c,  T.$113 AS Other_HIT_Device_related_to_event__c,  T.$114 AS Other_Property_Missing_Damaged__c,  T.$115 AS Other_Responder__c,  T.$116 AS Other_Type_of_Involved_Party__c,  T.$117 AS Other_Type_of_Media__c,  T.$118 AS Other_Written_Threat_Type__c,  T.$119 AS Other_admin_billing_system_component__c,  T.$120 AS Other_flood_cause__c,  T.$121 AS Other_health_hazard__c,  T.$122 AS Other_infestation_detail__c,  T.$123 AS Other_injured__c,  T.$124 AS Other_injury_from_event__c,  T.$125 AS Other_internal_department_notified__c,  T.$126 AS Other_natural_disaster__c,  T.$127 AS Other_s_involved_in_investigation__c,  T.$128 AS Other_s_involved_in_media_event__c,  T.$129 AS Other_s_person_possessing_weapon__c,  T.$130 AS Other_type_of_EHR_component_of_the_EHR__c,  T.$131 AS Other_type_of_injury__c,  T.$132 AS Other_type_of_investigation__c,  T.$133 AS Other_weapon_involved__c,  T.$134 AS PSO_Time_Submission__c,  T.$135 AS Patient_Account_Number__c,  T.$136 AS Patient_Address_1__c,  T.$137 AS Patient_Address_2__c,  T.$138 AS Patient_Business_Phone__c,  T.$139 AS Patient_City__c,  T.$140 AS Patient_Class__c,  T.$141 AS Patient_DOB__c,  T.$142 AS Patient_DOD__c,  T.$143 AS Patient_Disposition__c,  T.$144 AS Patient_Email__c,  T.$145 AS Patient_Feedback__c,  T.$146 AS Patient_First_Name__c,  T.$147 AS Patient_Gender__c,  T.$148 AS Patient_Home_Phone__c,  T.$149 AS Patient_Last_Name__c,  T.$150 AS Patient_MRN__c,  T.$151 AS Patient_Marital_Status__c,  T.$152 AS Patient_Middle_Name__c,  T.$153 AS Patient_Notified_of_Event__c,  T.$154 AS Patient_Protection_Issue__c,  T.$155 AS Patient_Received_Improper_Data_DOB__c,  T.$156 AS Patient_Received_Improper_Data_First_Nm__c,  T.$157 AS Patient_Received_Improper_Data_Last_Name__c,  T.$158 AS Patient_Received_Improper_Data_MRN__c,  T.$159 AS Patient_SSN__c,  T.$160 AS Patient_State__c,  T.$161 AS Patient_Suffix__c,  T.$162 AS Patient_Visit2__c,  T.$163 AS Patient_Visit__c,  T.$164 AS Patient_Zip_Code__c,  T.$165 AS Patient_injured_from_accident__c,  T.$166 AS Patient_s_Race__c,  T.$167 AS Person_making_threat__c,  T.$168 AS Person_s_taken_hostage__c,  T.$169 AS Personal_Property_Missing_Damaged__c,  T.$170 AS Primary_Employee__c,  T.$171 AS Primary_Facility__c,  T.$172 AS Primary_Language__c,  T.$173 AS Primary_Location__c,  T.$174 AS Privacy_Confidentiality_Category__c,  T.$175 AS Privacy_Office_follow_up__c,  T.$176 AS Property_Damage_Description__c,  T.$177 AS Property_Damage__c,  T.$178 AS Provider_First_Name__c,  T.$179 AS Provider_Last_Name__c,  T.$180 AS Provider_Notified__c,  T.$181 AS Re_Submission_Date__c,  T.$182 AS Re_submission_File_Name__c,  T.$183 AS Reason_for_investigation__c,  T.$184 AS Recipient_Healthcare_Provider__c,  T.$185 AS Regulatory_Government_Agency_Reported_To__c,  T.$186 AS Report_Date__c,  T.$187 AS Reportable_Event_Cause__c,  T.$188 AS Reportable_to_reg_govt_agency__c,  T.$189 AS Reported_to_the_compliance_officer__c,  T.$190 AS Reporter_Email__c,  T.$191 AS Reporter_First_Name__c,  T.$192 AS Reporter_Job_or_Position__c,  T.$193 AS Reporter_Last_Name__c,  T.$194 AS Reporter__c,  T.$195 AS Reporter_phone__c,  T.$196 AS Reporters_First_Last_Name_and_Contact__c,  T.$197 AS Reporting_for_someone_else__c,  T.$198 AS Request__c,  T.$199 AS Resubmit_to_PSO__c,  T.$200 AS Review_Record_s_Auto_Created__c,  T.$201 AS Reviewer_Additional_Details__c,  T.$202 AS Reviwer_Comments__c,  T.$203 AS Secondary_Employee__c,  T.$204 AS Secondary_Facility__c,  T.$205 AS Secondary_Location__c,  T.$206 AS Sentinel_Event__c,  T.$207 AS Serious_Reportable_Event__c,  T.$208 AS Service_Line_NCE__c,  T.$209 AS Severity_of_Event__c,  T.$210 AS Specific_Location__c,  T.$211 AS Specific_location_of_weapon__c,  T.$212 AS Specify_Rooms_Affected__c,  T.$213 AS Specify_outside_vendor__c,  T.$214 AS Staff_Injury__c,  T.$215 AS State_or_Regulatory_Agency_ies_Notified__c,  T.$216 AS Status__c,  T.$217 AS Time_Provider_Notified__c,  T.$218 AS Time_of_Event__c,  T.$219 AS Type__c,  T.$220 AS Type_of_Burn__c,  T.$221 AS Type_of_Event__c,  T.$222 AS Type_of_Flag__c,  T.$223 AS Type_of_Involved_Party__c,  T.$224 AS Type_of_Security_Issue__c,  T.$225 AS Type_of_Visitor_Non_Employee_Event__c,  T.$226 AS Type_of_health_hazard__c,  T.$227 AS Type_of_infestation__c,  T.$228 AS Type_of_investigation__c,  T.$229 AS Type_of_media_contacting_Facility__c,  T.$230 AS Type_of_natural_disaster__c,  T.$231 AS Type_of_weapon_was_involved_or_mentioned__c,  T.$232 AS Utility_vendor_company_contacted__c,  T.$233 AS Vehicle_Damages__c,  T.$234 AS Vehicle_License_Plate__c,  T.$235 AS Vendor_s_Involved_in_Violation__c,  T.$236 AS Was_911_Called__c,  T.$237 AS Was_a_fire_watch_initiated__c,  T.$238 AS Was_a_threat_made_to_use_the_weapon__c,  T.$239 AS Was_an_internal_department_notified__c,  T.$240 AS Was_anyone_injured__c,  T.$241 AS Was_individual_s_apprehended__c,  T.$242 AS Was_the_fire_alarm_activated_manually__c,  T.$243 AS Was_the_fire_alarm_operational__c,  T.$244 AS Was_the_fire_alarm_panel_reset__c,  T.$245 AS Was_the_fire_department_notified__c,  T.$246 AS Was_the_patient_sent_to_the_ER__c,  T.$247 AS Was_the_threat_carried_out_weapon_used__c,  T.$248 AS Were_any_rooms_affected__c,  T.$249 AS Were_fire_alarms_triggered_by_flood__c,  T.$250 AS Were_the_doors_supervised_or_monitored__c,  T.$251 AS Were_the_police_called__c,  T.$252 AS Were_there_any_envrinomental_damages__c,  T.$253 AS Were_there_any_human_injuries_or_death__c,  T.$254 AS Were_there_any_structural_damages__c,  T.$255 AS What_areas_were_cleaned__c,  T.$256 AS What_event_lead_to_media_involvement__c,  T.$257 AS What_has_been_done_with_information__c,  T.$258 AS What_type_of_injury_was_reported__c,  T.$259 AS What_was_the_cause_of_the_fire_smoke__c,  T.$260 AS Which_utility_was_affected__c,  T.$261 AS Who_Received_Accessed_Information__c,  T.$262 AS Who_Responded__c,  T.$263 AS Who_activated_the_fire_alarm__c,  T.$264 AS Who_did_the_cleaning__c,  T.$265 AS Who_did_the_violation_s_affect__c,  T.$266 AS Who_if_any_were_involved__c,  T.$267 AS Who_possessed_the_weapon_made_threat__c,  T.$268 AS Who_requesting_follow_up_and_why__c,  T.$269 AS Who_was_injured__c,  T.$270 AS Who_was_involved_impacted_by_the_event__c,  T.$271 AS Who_was_taken_as_hostage__c,  T.$272 AS Why_didn_t_the_fire_alarm_activate__c,  T.$273 AS Why_was_fire_alarm_not_operational__c,  T.$274 AS Witness_Contact_Information__c,  T.$275 AS Witness_Name__c,  T.$276 AS Department_Name__c,  T.$277 AS Facility_Name__c,  T.$278 AS IM_Delete_Flag__c,  T.$279 AS Involved_Party__c,  T.$280 AS Office_Name__c,  T.$281 AS Patient_Name__c,  T.$282 AS Patient_s_Age_at_Event__c,  T.$283 AS Privacy_Confidentiality_Detail__c,  T.$284 AS Region__c,  T.$285 AS Risk_Management_Reviewed__c,  T.$286 AS Convert_to_Claim__c,  T.$287 AS Staff_on_Shift__c,  T.$288 AS Reviewed_by_Q_C__c,  T.$289 AS Event_State__c,  T.$290 AS Vehicle__c,  T.$291 AS Alleged_Theft__c,  T.$292 AS Compliance_Concern__c, -1 AS ETL_TASK_KEY, -1 AS ETL_INSERTED_TASK_KEY, current_timestamp::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, current_user() AS ETL_INSERTED_BY, current_timestamp::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE,  current_user() AS ETL_LAST_UPDATED_BY, 0 as ETL_DELETED_FLAG FROM @DISC_PROD.STAGE.AWSAZSTAGEPROD/Riskonnect/Daily_data (file_format => DISC_PROD.STAGE.CSV_FORMAT_UTF8_FALSE,PATTERN => ''.*HC_Non_Clinical_Event_.*[.]csv'')T);

    --ViewSQL
    CREATE OR REPLACE TABLE DISC_PROD.RISKONNECT.HC_Non_Clinical_Event AS SELECT ID,  OWNERID,  ISDELETED,  NAME,  RECORDTYPEID,  CREATEDDATE,  CREATEDBYID,  LASTMODIFIEDDATE,  LASTMODIFIEDBYID,  SYSTEMMODSTAMP,  LASTACTIVITYDATE,  LASTVIEWEDDATE,  LASTREFERENCEDDATE,  CONNECTIONRECEIVEDID,  CONNECTIONSENTID,  ACTION_TAKEN_TO_RESOLVE_EVENT__C,  ACTION_TAKEN_AS_A_RESULT_OF_ACCIDENT__C,  ADDITIONAL_EVENT_DETAILS__C,  ADMIN_BILLING_SYSTEM_COMPONENT__C,  ADMIT_VISIT_DATE__C,  ADMITTING_DIAGNOSIS__C,  AGENCY_INVOLVED__C,  ANONYMOUS_REPORTER__C,  ANTICIPATED_HARM_DURATION__C,  ASSOCIATED_WITH_HANDOFF__C,  BODY_PART_INJURED__C,  BODY_PART_AFFECTED_BE_SPECIFIC_PLEASE__C,  CAUSE_OF_FLOOD__C,  CLAIM__C,  CLIENT_INJURY__C,  COMMUNICATION_METHOD__C,  COMMUNICATION_TIME_FRAME__C,  COMPANY_VEHICLE__C,  COMPLETE_PATIENT_FORM__C,  COMPLIANCE_ITEM_VIOLATED__C,  CONVERTED_TO_CLAIM__C,  CONVERTED_TO_PATIENT_FEEDBACK__C,  DATE_EVENT_CLOSED__C,  DATE_PROVIDER_NOTIFIED__C,  DATE_REOPENED__C,  DATE_REPORTED_TO_REG_GOVT_AGENCY__C,  DATE_OF_EVENT__C,  DEPARTMENT_NOTIFIED__C,  DID_FIRE_EMS_RESPOND__C,  DID_THE_EMERGENCY_GENERATOR_TURN_ON__C,  DID_YOU_CONTACT_COMMUNICATIONS_DEPT__C,  DISCLOSURE_BILLING_OR_ACCOUNT_ERRORS__C,  DISCREPANCY_TYPE__C,  DO_NOT_SUBMIT_TO_PSO__C,  EHR_TYPE_OR_COMPONENT_INVOLVED__C,  EMS_911_CALLED__C,  EMPLOYEE_IN_VEHICLE__C,  EMPLOYEE_S_PERSON_S_INVOLVED__C,  EMPLOYEES_INVOLVED_IN_ACCIDENT__C,  EVENT_DESCRIPTION__C,  EVENT_DISCOVERY_DATE__C,  EVENT_DISCOVERY_TIME__C,  EVENT_DOCUMENTED_IN_MR__C,  EVERYONE_EVACUATED_DUE_TO_EVENT__C,  FIRE_DEPARTMENT_SPECIFIC_FINDINGS__C,  FIRE_ALARM_ACTIVATE_AUTOMATICALLY__C,  FIRE_AT_CLIENT_HOME_STAFF_PRESENT__C,  FIRE_DEPT_REPORT_ANYTHING_SPECIFIC__C,  FLOOD_AT_CLIENT_HOME_STAFF_PRESENT__C,  FOLLOW_UP_DETAILS__C,  FOLLOW_UP__C,  GENDER_OF_CALLER__C,  GOVT_AGENCY_INVOLVED_AT_THIS_TIME__C,  HIT_DEVICE_RELATED_TO_EVENT_UNSAFE_COND__C,  HAS_THE_FACILITY_BEEN_CLOSED__C,  HOSPITALIZED__C,  HOW_INCIDENT_DISCOVERED_REPORTED__C,  HOW_PREVENTABLE_WAS_EVENT__C,  HOW_MADE_AWARE_OF_THIS_INVESTIGATION__C,  HOW_MANY_DAYS_IS_THE_FACILITY_CLOSED__C,  HOW_WAS_CONTACT_INITIATED__C,  HOW_WAS_INFORMATION_RETURNED__C,  HOW_WAS_THE_HEALTH_HAZARD_DISCOVERED__C,  HOW_WAS_THREAT_RECEIVED__C,  IM_STATUS__C,  IDENTITY_KNOWN__C,  INFORMATION_DISCLOSED_DESCRIPTION__C,  INFORMATION_DISCLOSED_FORMAT__C,  INFORMATION_DISCLOSED_OTHER_FORMAT__C,  INFORMATION_DISCLOSED__C,  INFORMATION_RECOVERED_DESTROYED__C,  INITIAL_PDF_CREATED__C,  INJURY_FROM_THE_ACCIDENT__C,  INVOLVED_PARTY_ADDRESS_1__C,  INVOLVED_PARTY_ADDRESS_2__C,  INVOLVED_PARTY_CITY__C,  INVOLVED_PARTY_EMAIL__C,  INVOLVED_PARTY_FIRST_NAME__C,  INVOLVED_PARTY_JOB_POSITION__C,  INVOLVED_PARTY_LAST_NAME__C,  INVOLVED_PARTY_PHONE__C,  INVOLVED_PARTY_POSTAL_CODE__C,  INVOLVED_PARTY_STATE__C,  IS_THIS_A_PATIENT_RELATED_EVENT__C,  LOCATION_DAMAGES__C,  LOCATION_OR_ALLEGED_LOCATION_OF_WEAPON__C,  MANUFACTURER__C,  MANY_INDIVIDUALS__C,  MEDICAL_TREATMENT_OR_FIRST_AID_PROVIDED__C,  NAME_OF_DEVICE_INFORMATION_SYSTEM__C,  NAME_OF_PROVIDER__C,  NAME_OF_MEDIA_OUTLET__C,  NAME_OF_PERSON_CONTACTING_THE_FACILITY__C,  NAME_OF_UTILITY_VENDOR_CONTACTED__C,  NON_CLINICAL_EVENT_STATUS__C,  NOTIFY_WHEN_INVESTIGATION_COMPLETE__C,  NUMBER_OF_INDIVIDUALS__C,  OTHER_HIT_DEVICE_RELATED_TO_EVENT__C,  OTHER_PROPERTY_MISSING_DAMAGED__C,  OTHER_RESPONDER__C,  OTHER_TYPE_OF_INVOLVED_PARTY__C,  OTHER_TYPE_OF_MEDIA__C,  OTHER_WRITTEN_THREAT_TYPE__C,  OTHER_ADMIN_BILLING_SYSTEM_COMPONENT__C,  OTHER_FLOOD_CAUSE__C,  OTHER_HEALTH_HAZARD__C,  OTHER_INFESTATION_DETAIL__C,  OTHER_INJURED__C,  OTHER_INJURY_FROM_EVENT__C,  OTHER_INTERNAL_DEPARTMENT_NOTIFIED__C,  OTHER_NATURAL_DISASTER__C,  OTHER_S_INVOLVED_IN_INVESTIGATION__C,  OTHER_S_INVOLVED_IN_MEDIA_EVENT__C,  OTHER_S_PERSON_POSSESSING_WEAPON__C,  OTHER_TYPE_OF_EHR_COMPONENT_OF_THE_EHR__C,  OTHER_TYPE_OF_INJURY__C,  OTHER_TYPE_OF_INVESTIGATION__C,  OTHER_WEAPON_INVOLVED__C,  PSO_TIME_SUBMISSION__C,  PATIENT_ACCOUNT_NUMBER__C,  PATIENT_ADDRESS_1__C,  PATIENT_ADDRESS_2__C,  PATIENT_BUSINESS_PHONE__C,  PATIENT_CITY__C,  PATIENT_CLASS__C,  PATIENT_DOB__C,  PATIENT_DOD__C,  PATIENT_DISPOSITION__C,  PATIENT_EMAIL__C,  PATIENT_FEEDBACK__C,  PATIENT_FIRST_NAME__C,  PATIENT_GENDER__C,  PATIENT_HOME_PHONE__C,  PATIENT_LAST_NAME__C,  PATIENT_MRN__C,  PATIENT_MARITAL_STATUS__C,  PATIENT_MIDDLE_NAME__C,  PATIENT_NOTIFIED_OF_EVENT__C,  PATIENT_PROTECTION_ISSUE__C,  PATIENT_RECEIVED_IMPROPER_DATA_DOB__C,  PATIENT_RECEIVED_IMPROPER_DATA_FIRST_NM__C,  PATIENT_RECEIVED_IMPROPER_DATA_LAST_NAME__C,  PATIENT_RECEIVED_IMPROPER_DATA_MRN__C,  PATIENT_SSN__C,  PATIENT_STATE__C,  PATIENT_SUFFIX__C,  PATIENT_VISIT2__C,  PATIENT_VISIT__C,  PATIENT_ZIP_CODE__C,  PATIENT_INJURED_FROM_ACCIDENT__C,  PATIENT_S_RACE__C,  PERSON_MAKING_THREAT__C,  PERSON_S_TAKEN_HOSTAGE__C,  PERSONAL_PROPERTY_MISSING_DAMAGED__C,  PRIMARY_EMPLOYEE__C,  PRIMARY_FACILITY__C,  PRIMARY_LANGUAGE__C,  PRIMARY_LOCATION__C,  PRIVACY_CONFIDENTIALITY_CATEGORY__C,  PRIVACY_OFFICE_FOLLOW_UP__C,  PROPERTY_DAMAGE_DESCRIPTION__C,  PROPERTY_DAMAGE__C,  PROVIDER_FIRST_NAME__C,  PROVIDER_LAST_NAME__C,  PROVIDER_NOTIFIED__C,  RE_SUBMISSION_DATE__C,  RE_SUBMISSION_FILE_NAME__C,  REASON_FOR_INVESTIGATION__C,  RECIPIENT_HEALTHCARE_PROVIDER__C,  REGULATORY_GOVERNMENT_AGENCY_REPORTED_TO__C,  REPORT_DATE__C,  REPORTABLE_EVENT_CAUSE__C,  REPORTABLE_TO_REG_GOVT_AGENCY__C,  REPORTED_TO_THE_COMPLIANCE_OFFICER__C,  REPORTER_EMAIL__C,  REPORTER_FIRST_NAME__C,  REPORTER_JOB_OR_POSITION__C,  REPORTER_LAST_NAME__C,  REPORTER__C,  REPORTER_PHONE__C,  REPORTERS_FIRST_LAST_NAME_AND_CONTACT__C,  REPORTING_FOR_SOMEONE_ELSE__C,  REQUEST__C,  RESUBMIT_TO_PSO__C,  REVIEW_RECORD_S_AUTO_CREATED__C,  REVIEWER_ADDITIONAL_DETAILS__C,  REVIWER_COMMENTS__C,  SECONDARY_EMPLOYEE__C,  SECONDARY_FACILITY__C,  SECONDARY_LOCATION__C,  SENTINEL_EVENT__C,  SERIOUS_REPORTABLE_EVENT__C,  SERVICE_LINE_NCE__C,  SEVERITY_OF_EVENT__C,  SPECIFIC_LOCATION__C,  SPECIFIC_LOCATION_OF_WEAPON__C,  SPECIFY_ROOMS_AFFECTED__C,  SPECIFY_OUTSIDE_VENDOR__C,  STAFF_INJURY__C,  STATE_OR_REGULATORY_AGENCY_IES_NOTIFIED__C,  STATUS__C,  TIME_PROVIDER_NOTIFIED__C,  TIME_OF_EVENT__C,  TYPE__C,  TYPE_OF_BURN__C,  TYPE_OF_EVENT__C,  TYPE_OF_FLAG__C,  TYPE_OF_INVOLVED_PARTY__C,  TYPE_OF_SECURITY_ISSUE__C,  TYPE_OF_VISITOR_NON_EMPLOYEE_EVENT__C,  TYPE_OF_HEALTH_HAZARD__C,  TYPE_OF_INFESTATION__C,  TYPE_OF_INVESTIGATION__C,  TYPE_OF_MEDIA_CONTACTING_FACILITY__C,  TYPE_OF_NATURAL_DISASTER__C,  TYPE_OF_WEAPON_WAS_INVOLVED_OR_MENTIONED__C,  UTILITY_VENDOR_COMPANY_CONTACTED__C,  VEHICLE_DAMAGES__C,  VEHICLE_LICENSE_PLATE__C,  VENDOR_S_INVOLVED_IN_VIOLATION__C,  WAS_911_CALLED__C,  WAS_A_FIRE_WATCH_INITIATED__C,  WAS_A_THREAT_MADE_TO_USE_THE_WEAPON__C,  WAS_AN_INTERNAL_DEPARTMENT_NOTIFIED__C,  WAS_ANYONE_INJURED__C,  WAS_INDIVIDUAL_S_APPREHENDED__C,  WAS_THE_FIRE_ALARM_ACTIVATED_MANUALLY__C,  WAS_THE_FIRE_ALARM_OPERATIONAL__C,  WAS_THE_FIRE_ALARM_PANEL_RESET__C,  WAS_THE_FIRE_DEPARTMENT_NOTIFIED__C,  WAS_THE_PATIENT_SENT_TO_THE_ER__C,  WAS_THE_THREAT_CARRIED_OUT_WEAPON_USED__C,  WERE_ANY_ROOMS_AFFECTED__C,  WERE_FIRE_ALARMS_TRIGGERED_BY_FLOOD__C,  WERE_THE_DOORS_SUPERVISED_OR_MONITORED__C,  WERE_THE_POLICE_CALLED__C,  WERE_THERE_ANY_ENVRINOMENTAL_DAMAGES__C,  WERE_THERE_ANY_HUMAN_INJURIES_OR_DEATH__C,  WERE_THERE_ANY_STRUCTURAL_DAMAGES__C,  WHAT_AREAS_WERE_CLEANED__C,  WHAT_EVENT_LEAD_TO_MEDIA_INVOLVEMENT__C,  WHAT_HAS_BEEN_DONE_WITH_INFORMATION__C,  WHAT_TYPE_OF_INJURY_WAS_REPORTED__C,  WHAT_WAS_THE_CAUSE_OF_THE_FIRE_SMOKE__C,  WHICH_UTILITY_WAS_AFFECTED__C,  WHO_RECEIVED_ACCESSED_INFORMATION__C,  WHO_RESPONDED__C,  WHO_ACTIVATED_THE_FIRE_ALARM__C,  WHO_DID_THE_CLEANING__C,  WHO_DID_THE_VIOLATION_S_AFFECT__C,  WHO_IF_ANY_WERE_INVOLVED__C,  WHO_POSSESSED_THE_WEAPON_MADE_THREAT__C,  WHO_REQUESTING_FOLLOW_UP_AND_WHY__C,  WHO_WAS_INJURED__C,  WHO_WAS_INVOLVED_IMPACTED_BY_THE_EVENT__C,  WHO_WAS_TAKEN_AS_HOSTAGE__C,  WHY_DIDN_T_THE_FIRE_ALARM_ACTIVATE__C,  WHY_WAS_FIRE_ALARM_NOT_OPERATIONAL__C,  WITNESS_CONTACT_INFORMATION__C,  WITNESS_NAME__C,  DEPARTMENT_NAME__C,  FACILITY_NAME__C,  IM_DELETE_FLAG__C,  INVOLVED_PARTY__C,  OFFICE_NAME__C,  PATIENT_NAME__C,  PATIENT_S_AGE_AT_EVENT__C,  PRIVACY_CONFIDENTIALITY_DETAIL__C,  REGION__C,  RISK_MANAGEMENT_REVIEWED__C,  CONVERT_TO_CLAIM__C,  STAFF_ON_SHIFT__C,  REVIEWED_BY_Q_C__C,  EVENT_STATE__C,  VEHICLE__C,  ALLEGED_THEFT__C,  COMPLIANCE_CONCERN__C, :TaskKey AS ETL_TASK_KEY, :TaskKey AS ETL_INSERTED_TASK_KEY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, CURRENT_USER() AS ETL_INSERTED_BY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, CURRENT_USER() AS ETL_LAST_UPDATED_BY, 0 AS ETL_DELETED_FLAG FROM DISC_PROD.RISKONNECT.HIST_HC_Non_Clinical_Event WHERE (ID,ETL_LAST_UPDATED_DATE) IN (SELECT ID,MAX(ETL_LAST_UPDATED_DATE) FROM DISC_PROD.RISKONNECT.HIST_HC_Non_Clinical_Event GROUP BY ID);

    return ''Success'';
END;
';