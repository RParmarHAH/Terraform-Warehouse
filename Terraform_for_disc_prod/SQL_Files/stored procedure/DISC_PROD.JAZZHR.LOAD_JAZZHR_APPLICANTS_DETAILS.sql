CREATE OR REPLACE PROCEDURE DISC_PROD.JAZZHR.LOAD_JAZZHR_APPLICANTS_DETAILS()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
BEGIN
	COPY INTO JAZZHR.HIST_APPLICANTS_DETAILS FROM (
		SELECT DISTINCT j.$1:id::STRING AS ID,j.$1:first_name::STRING AS FIRST_NAME,j.$1:last_name::STRING AS LAST_NAME,j.$1:email::STRING AS EMAIL,j.$1:address::STRING AS ADDRESS,j.$1:LOCATION::STRING AS LOCATION,j.$1:phone::STRING AS PHONE,j.$1:linkedin_url::STRING AS LINKEDIN_URL,j.$1:eeo_gender::STRING AS EEO_GENDER,j.$1:eeo_race::STRING AS EEO_RACE,j.$1:eeo_disability::STRING AS EEO_DISABILITY,j.$1:website::STRING AS WEBSITE,j.$1:desired_salary::STRING AS DESIRED_SALARY,j.$1:desired_start_date::STRING AS DESIRED_START_DATE,j.$1:referrer::STRING AS REFERRER,j.$1:languages::STRING AS LANGUAGES,j.$1:wmyu::STRING AS WMYU,j.$1:has_driver_license::STRING AS HAS_DRIVER_LICENSE,j.$1:willing_to_relocate::STRING AS WILLING_TO_RELOCATE,j.$1:citizenship_status::STRING AS CITIZENSHIP_STATUS,j.$1:education_level::STRING AS EDUCATION_LEVEL,j.$1:has_cdl::STRING AS HAS_CDL,j.$1:over_18::STRING AS OVER_18,j.$1:can_work_weekends::STRING AS CAN_WORK_WEEKENDS,j.$1:can_work_evenings::STRING AS CAN_WORK_EVENINGS,j.$1:can_work_overtime::STRING AS CAN_WORK_OVERTIME,j.$1:has_felony::STRING AS HAS_FELONY,j.$1:felony_explanation::STRING AS FELONY_EXPLANATION,j.$1:twitter_username::STRING AS TWITTER_USERNAME,j.$1:college::STRING AS COLLEGE,j.$1:REFERENCES::STRING AS REFERENCES,j.$1:notes::STRING AS NOTES,j.$1:apply_date::STRING AS APPLY_DATE,j.$1:comments_count::STRING AS COMMENTS_COUNT,j.$1:SOURCE::STRING AS SOURCE,j.$1:recruiter_id::STRING AS RECRUITER_ID,j.$1:eeoc_veteran::STRING AS EEOC_VETERAN,j.$1:eeoc_disability::STRING AS EEOC_DISABILITY,j.$1:eeoc_disability_signature::STRING AS EEOC_DISABILITY_SIGNATURE,j.$1:eeoc_disability_date::STRING AS EEOC_DISABILITY_DATE,333379 AS ETL_TASK_KEY  ,333379 AS ETL_INSERTED_TASK_KEY  ,current_timestamp::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE  ,current_user() AS ETL_INSERTED_BY  ,current_timestamp::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE  ,current_user() AS ETL_LAST_UPDATED_BY  ,FALSE AS ETL_DELETED_FLAG FROM @DISC_PROD.STAGE.AZSTAGEPROD/JazzHR/WeeklyFiles/applicants_details(file_format => DW_PROD.PUBLIC.MY_JSON_FORMAT) j
	);
END;
';