CREATE OR REPLACE PROCEDURE DISC_PROD.ALAYACARE.GET_EMPLOYEE_CONTACT()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
--*****************************************************************************************************************************
-- NAME:  GET_EMPLOYEE_CONTACT 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2021-11-11		UNKNOWN					INITIAL DEVELOPMENT
-- 2023-09-05  		RAVI SUTHAR            	MIGRATED JavaScript to SQL
--*****************************************************************************************************************************
    return_result varchar(1000);
BEGIN
	
    INSERT OVERWRITE INTO ALAYACARE.EMPLOYEE_CONTACT (
        LAKE_ID, CONTACT_ID, CONTACT_GUID_TO, CREATED_AT, 
		PROPERTIES_TBL_PROSPECT_CONTACT_OP, PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_USER_ID, PROPERTIES_TBL_PROSPECT_CONTACT_DEPRECATED_GUID_TO, PROPERTIES_TBL_PROSPECT_CONTACT_FULLTEXT_INDEX, PROPERTIES_TBL_PROSPECT_CONTACT_GUID, PROPERTIES_TBL_PROSPECT_CONTACT_ID, PROPERTIES_TBL_PROSPECT_CONTACT_IDACCOUNT, PROPERTIES_TBL_PROSPECT_CONTACT_IS_ACTIVE, PROPERTIES_TBL_PROSPECT_CONTACT_LIST_ID, PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_USER_ID, 
		PROPERTIES_TBL_GUID_PROFILES_OP, PROPERTIES_TBL_GUID_PROFILES_CONTACT_TYPE, PROPERTIES_TBL_GUID_PROFILES_EB_MEDICAID_NPI, PROPERTIES_TBL_GUID_PROFILES_EB_MEDICAID_PROVIDER_TYPE, PROPERTIES_TBL_GUID_PROFILES_GUID_TO, PROPERTIES_TBL_GUID_PROFILES_IS_ACTIVE, PROPERTIES_TBL_GUID_PROFILES_IS_BILLING, PROPERTIES_TBL_GUID_PROFILES_IS_EMERGENCY, PROPERTIES_TBL_GUID_PROFILES_IS_MAIN, PROPERTIES_TBL_GUID_PROFILES_PROFILE_ID, PROPERTIES_TBL_GUID_PROFILES_RELATIONSHIP, 
		CONTACT_IS_ACTIVE, BRANCH_ID, 
		PROFILE_COUNTRY, PROFILE_FIRST_NAME, PROFILE_LAST_NAME, PROFILE_PHONE_MAIN, 
		AGE, AGE_RANGE)
		SELECT LAKE_ID AS LAKE_ID, CONTACT_ID AS CONTACT_ID, CONTACT_GUID_TO AS CONTACT_GUID_TO, CREATED_AT AS CREATED_AT, 
			PROPERTIES_TBL_PROSPECT_CONTACT:Op::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_OP, PROPERTIES_TBL_PROSPECT_CONTACT:create_time::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT:create_user_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_CREATE_USER_ID, PROPERTIES_TBL_PROSPECT_CONTACT:deprecated_guid_to::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_DEPRECATED_GUID_TO, PROPERTIES_TBL_PROSPECT_CONTACT:fulltext_index::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_FULLTEXT_INDEX, PROPERTIES_TBL_PROSPECT_CONTACT:guid::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_GUID, PROPERTIES_TBL_PROSPECT_CONTACT:id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_ID, PROPERTIES_TBL_PROSPECT_CONTACT:idaccount::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_IDACCOUNT, PROPERTIES_TBL_PROSPECT_CONTACT:is_active::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_IS_ACTIVE, PROPERTIES_TBL_PROSPECT_CONTACT:list_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_LIST_ID, PROPERTIES_TBL_PROSPECT_CONTACT:update_time::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_TIME, PROPERTIES_TBL_PROSPECT_CONTACT:update_user_id::STRING AS PROPERTIES_TBL_PROSPECT_CONTACT_UPDATE_USER_ID, 
			PROPERTIES_TBL_GUID_PROFILES:Op::STRING AS PROPERTIES_TBL_GUID_PROFILES_OP, PROPERTIES_TBL_GUID_PROFILES:contact_type::STRING AS PROPERTIES_TBL_GUID_PROFILES_CONTACT_TYPE, PROPERTIES_TBL_GUID_PROFILES:eb_medicaid_npi::STRING AS PROPERTIES_TBL_GUID_PROFILES_EB_MEDICAID_NPI, PROPERTIES_TBL_GUID_PROFILES:eb_medicaid_provider_type::STRING AS PROPERTIES_TBL_GUID_PROFILES_EB_MEDICAID_PROVIDER_TYPE, PROPERTIES_TBL_GUID_PROFILES:guid_to::STRING AS PROPERTIES_TBL_GUID_PROFILES_GUID_TO, PROPERTIES_TBL_GUID_PROFILES:is_active::STRING AS PROPERTIES_TBL_GUID_PROFILES_IS_ACTIVE, PROPERTIES_TBL_GUID_PROFILES:is_billing::STRING AS PROPERTIES_TBL_GUID_PROFILES_IS_BILLING, PROPERTIES_TBL_GUID_PROFILES:is_emergency::STRING AS PROPERTIES_TBL_GUID_PROFILES_IS_EMERGENCY, PROPERTIES_TBL_GUID_PROFILES:is_main::STRING AS PROPERTIES_TBL_GUID_PROFILES_IS_MAIN, PROPERTIES_TBL_GUID_PROFILES:profile_id::STRING AS PROPERTIES_TBL_GUID_PROFILES_PROFILE_ID, PROPERTIES_TBL_GUID_PROFILES:relationship::STRING AS PROPERTIES_TBL_GUID_PROFILES_RELATIONSHIP, 
			CONTACT_IS_ACTIVE AS CONTACT_IS_ACTIVE, BRANCH_ID AS BRANCH_ID, 
			PROFILE:country::STRING AS PROFILE_COUNTRY, PROFILE:first_name::STRING AS PROFILE_FIRST_NAME, PROFILE:last_name::STRING AS PROFILE_LAST_NAME, PROFILE:phone_main::STRING AS PROFILE_PHONE_MAIN, 
			AGE AS AGE, AGE_RANGE AS AGE_RANGE 
        FROM ALAYACARE_PRODUCTION."5C3EE5FE-45A5-4DA7-A35B-BD7CDAFE3548".SHARED_EMPLOYEE_CONTACT;

	SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
	return return_result;
END;
';