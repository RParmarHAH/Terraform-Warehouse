CREATE OR REPLACE PROCEDURE DISC_PROD.PARADOX.GET_GA_ONBOARDING_ADMIN("TASKKEY" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
--*****************************************************************************************************************************
-- NAME:  GET_GA_ONBOARDING_ADMIN 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE				AUTHOR										NOTES:
-- ----------		-------------------							-----------------------------------------------------------------------------------------------
-- 2023-11-20		KOMAL DHOKAI/RAVI SUTHAR					INITIAL DEVELOPMENT
--*****************************************************************************************************************************

BEGIN 
    --TargetSQL
    COPY INTO DISC_PROD.PARADOX.HIST_GA_ONBOARDING_ADMIN from (SELECT A.$1 Form_Name, A.$2 Location_Code, A.$3 Location_Name, A.$4 Job_Applied_to, A.$5 Job_Req_ID, A.$6 Job_Title, A.$7 Current_Candidate_Journey_Status, A.$8 Candidate_ID, A.$9 Candidate_Name, A.$10 Form_Date_Sent, A.$11 Form_In_Progress_Date, A.$12 Form_Completion_Status, A.$13 Form_Date_Submitted, A.$14 Form_Preview_Link, A.$15 Published_Date, A.$16 Published_Version, A.$17 Profile_ID, A.$18 Multiple_Records, A.$19 Primary_Identifier, A.$20 Reapply_in_Capture, A.$21 Reapply_in_Job_Search, A.$22 Reapply_in_Campaign, A.$23 Welcome_Letter_Help_at_Home_EEO_Survey, A.$24 Welcome_Letter_Please_review_and_accept_the_job_requirements_jd, A.$25 Welcome_Letter_Welcome_Letter, A.$26 Emergency_Contact_Your_full_name, A.$27 Emergency_Contact_Street_address_Line_1, A.$28 Emergency_Contact_Street_address_Line_2, A.$29 Emergency_Contact_City, A.$30 Emergency_Contact_State, A.$31 Emergency_Contact_ZIP_code, A.$32 Emergency_Contact_Employee_Phone_number, A.$33 Emergency_Contact_Employee_Email_address, A.$34 Emergency_Contact_Primary_Emergency_Contact_Name, A.$35 Emergency_Contact_Primary_Emergency_Contact_Cell_Phone_Number, A.$36 Emergency_Contact_Secondary_Emergency_Contact_Name, A.$37 Emergency_Contact_Secondary_Emergency_Contact_Cell_Phone_Number, A.$38 Emergency_Contact_Relation_to_Caregiver, A.$39 Statement_of_No_Abuse_Statement_of_No_Abuse, A.$40 Job_Description_Please_review_and_accept_the_job_requirements_jd, A.$41 Tax_Documents__Direct_Deposit_I9, A.$42 Tax_Documents__Direct_Deposit_Direct_Deposit, A.$43 Tax_Withholding_Tax_Withholding, A.$44 Tax_Withholding_Federal_tax_forms, A.$45 Tax_Withholding_State_tax_forms, A.$46 CODE_OF_CONDUCT__HANDBOOK_HELP_AT_HOME_ADMIN_HANDBOOK, A.$47 CODE_OF_CONDUCT__HANDBOOK_HAH_CODE_OF_ETHICAL_STANDARDS, A.$48 Employment_Eligibility_Certification_Form_Employment_Eligibility_Certification_Form, A.$49 Acknowledgement_of_Insurance_Acknowledgment_of_the_Insurance, A.$50 HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION_HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION, A.$51 Vehicle_Use_Policy_and_Agreement_Vehicle_Use_Policy_and_Agreement, A.$52 Client_Rights__Responsibilities_Client_Rights__Responsibilities, A.$53 Final_Submission, :TaskKey AS ETL_TASK_KEY, :TaskKey AS ETL_INSERTED_TASK_KEY, current_timestamp::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, current_user() AS ETL_INSERTED_BY, current_timestamp::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, current_user() AS ETL_LAST_UPDATED_BY, 0 as ETL_DELETED_FLAG FROM @DISC_PROD.STAGE.AWSAZSTAGEPROD/PARADOX/Upload_file/FormsCandidate.Forms.Detail.Report.Wide.Format.Ga.Admin.Onboarding (file_format => DISC_PROD.PUBLIC.CSV_Format) A);  

    --ViewSQL
    CREATE OR REPLACE TABLE DISC_PROD.PARADOX.GA_ONBOARDING_ADMIN AS SELECT Form_Name Form_Name, Location_Code Location_Code, Location_Name Location_Name, Job_Applied_to Job_Applied_to, Job_Req_ID Job_Req_ID, Job_Title Job_Title, Current_Candidate_Journey_Status Current_Candidate_Journey_Status, Candidate_ID Candidate_ID, Candidate_Name Candidate_Name, Form_Date_Sent Form_Date_Sent, Form_In_Progress_Date Form_In_Progress_Date, Form_Completion_Status Form_Completion_Status, Form_Date_Submitted Form_Date_Submitted, Form_Preview_Link Form_Preview_Link, Published_Date Published_Date, Published_Version Published_Version, Profile_ID Profile_ID, Multiple_Records Multiple_Records, Primary_Identifier Primary_Identifier, Reapply_in_Capture Reapply_in_Capture, Reapply_in_Job_Search Reapply_in_Job_Search, Reapply_in_Campaign Reapply_in_Campaign, Welcome_Letter_Help_at_Home_EEO_Survey Welcome_Letter_Help_at_Home_EEO_Survey, Welcome_Letter_Please_review_and_accept_the_job_requirements_jd Welcome_Letter_Please_review_and_accept_the_job_requirements_jd, Welcome_Letter_Welcome_Letter Welcome_Letter_Welcome_Letter, Emergency_Contact_Your_full_name Emergency_Contact_Your_full_name, Emergency_Contact_Street_address_Line_1 Emergency_Contact_Street_address_Line_1, Emergency_Contact_Street_address_Line_2 Emergency_Contact_Street_address_Line_2, Emergency_Contact_City Emergency_Contact_City, Emergency_Contact_State Emergency_Contact_State, Emergency_Contact_ZIP_code Emergency_Contact_ZIP_code, Emergency_Contact_Employee_Phone_number Emergency_Contact_Employee_Phone_number, Emergency_Contact_Employee_Email_address Emergency_Contact_Employee_Email_address, Emergency_Contact_Primary_Emergency_Contact_Name Emergency_Contact_Primary_Emergency_Contact_Name, Emergency_Contact_Primary_Emergency_Contact_Cell_Phone_Number Emergency_Contact_Primary_Emergency_Contact_Cell_Phone_Number, Emergency_Contact_Secondary_Emergency_Contact_Name Emergency_Contact_Secondary_Emergency_Contact_Name, Emergency_Contact_Secondary_Emergency_Contact_Cell_Phone_Number Emergency_Contact_Secondary_Emergency_Contact_Cell_Phone_Number, Emergency_Contact_Relation_to_Caregiver Emergency_Contact_Relation_to_Caregiver, Statement_of_No_Abuse_Statement_of_No_Abuse Statement_of_No_Abuse_Statement_of_No_Abuse, Job_Description_Please_review_and_accept_the_job_requirements_jd Job_Description_Please_review_and_accept_the_job_requirements_jd, Tax_Documents__Direct_Deposit_I9 Tax_Documents__Direct_Deposit_I9, Tax_Documents__Direct_Deposit_Direct_Deposit Tax_Documents__Direct_Deposit_Direct_Deposit, Tax_Withholding_Tax_Withholding Tax_Withholding_Tax_Withholding, Tax_Withholding_Federal_tax_forms Tax_Withholding_Federal_tax_forms, Tax_Withholding_State_tax_forms Tax_Withholding_State_tax_forms, CODE_OF_CONDUCT__HANDBOOK_HELP_AT_HOME_ADMIN_HANDBOOK CODE_OF_CONDUCT__HANDBOOK_HELP_AT_HOME_ADMIN_HANDBOOK,CODE_OF_CONDUCT__HANDBOOK_HAH_CODE_OF_ETHICAL_STANDARDS CODE_OF_CONDUCT__HANDBOOK_HAH_CODE_OF_ETHICAL_STANDARDS, Employment_Eligibility_Certification_Form_Employment_Eligibility_Certification_Form Employment_Eligibility_Certification_Form_Employment_Eligibility_Certification_Form, Acknowledgement_of_Insurance_Acknowledgment_of_the_Insurance Acknowledgement_of_Insurance_Acknowledgment_of_the_Insurance, HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION_HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION_HEPATITIS_B_VIRUS_HBV_VACCINATION_AUTHORIZATION, Vehicle_Use_Policy_and_Agreement_Vehicle_Use_Policy_and_Agreement Vehicle_Use_Policy_and_Agreement_Vehicle_Use_Policy_and_Agreement, Client_Rights__Responsibilities_Client_Rights__Responsibilities Client_Rights__Responsibilities_Client_Rights__Responsibilities, Final_Submission Final_Submission, :TaskKey AS ETL_TASK_KEY, :TaskKey AS ETL_INSERTED_TASK_KEY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_INSERTED_DATE, CURRENT_USER() AS ETL_INSERTED_BY, CURRENT_TIMESTAMP::TIMESTAMP_NTZ(9) AS ETL_LAST_UPDATED_DATE, CURRENT_USER() AS ETL_LAST_UPDATED_BY, 0 AS ETL_DELETED_FLAG FROM DISC_PROD.PARADOX.HIST_GA_ONBOARDING_ADMIN WHERE ETL_LAST_UPDATED_DATE = (SELECT MAX(ETL_LAST_UPDATED_DATE) FROM DISC_PROD.PARADOX.HIST_GA_ONBOARDING_ADMIN);

    return ''Success'';
END;
';