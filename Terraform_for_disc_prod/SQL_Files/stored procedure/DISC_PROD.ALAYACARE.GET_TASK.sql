CREATE OR REPLACE PROCEDURE DISC_PROD.ALAYACARE.GET_TASK()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
--*****************************************************************************************************************************
-- NAME:  GET_TASK 
--
-- PURPOSE: USING THIS SP FOR DISCOVERY TABLE LOAD
--
-- DEVELOPMENT LOG:
-- DATE        		AUTHOR                	NOTES:
-- ----------  		-------------------   	-----------------------------------------------------------------------------------------------
-- 2021-11-11		UNKNOWN					INITIAL DEVELOPMENT
-- 2023-09-05  		RAVI SUTHAR            	MIGRATED JavaScript to SQL
--*****************************************************************************************************************************
    return_result varchar(1000);
BEGIN
	
    INSERT OVERWRITE INTO ALAYACARE.TASK (
        TASK_ID, CLIENT_ID, EMPLOYEE_ID, CREATE_USER_ID, UPDATE_USER_ID, VISIT_ID, CREATE_TIME, UPDATE_TIME, DUE_DATE, OVERDUE, DETAILS, DESCRIPTION, STATUS, BILLABLE, PRIORITY, BRANCH_ID, FORM_NAME, TASK_PROPERTIES_CREATE_TIME, TASK_PROPERTIES_IDMASTERACCOUNT, TASK_PROPERTIES_ID, TASK_PROPERTIES_IDACCOUNT, TASK_PROPERTIES_CREATE_USER_ID, TASK_PROPERTIES_SOURCE, TASK_PROPERTIES_ASSIGNED_TO, TASK_PROPERTIES_UPDATE_USER_ID, TASK_PROPERTIES_FULLTEXT_INDEX, TASK_PROPERTIES_DESCRIPTION, TASK_PROPERTIES_PRIORITY, TASK_PROPERTIES_UPDATE_TIME, TASK_PROPERTIES_STATUS, TASK_PROPERTIES_DETAILS, TASK_PROPERTIES_DUE_DATE, TASK_PROPERTIES_OP)
        SELECT TASK_ID AS TASK_ID, CLIENT_ID AS CLIENT_ID, EMPLOYEE_ID AS EMPLOYEE_ID, CREATE_USER_ID AS CREATE_USER_ID, UPDATE_USER_ID AS UPDATE_USER_ID, VISIT_ID AS VISIT_ID, CREATE_TIME AS CREATE_TIME, UPDATE_TIME AS UPDATE_TIME, DUE_DATE AS DUE_DATE, OVERDUE AS OVERDUE, DETAILS AS DETAILS, DESCRIPTION AS DESCRIPTION, STATUS AS STATUS, BILLABLE AS BILLABLE, PRIORITY AS PRIORITY, BRANCH_ID AS BRANCH_ID, FORM_NAME AS FORM_NAME, TASK_PROPERTIES:create_time::STRING AS TASK_PROPERTIES_CREATE_TIME, TASK_PROPERTIES:idmasteraccount::STRING AS TASK_PROPERTIES_IDMASTERACCOUNT, TASK_PROPERTIES:id::STRING AS TASK_PROPERTIES_ID, TASK_PROPERTIES:idaccount::STRING AS TASK_PROPERTIES_IDACCOUNT, TASK_PROPERTIES:create_user_id::STRING AS TASK_PROPERTIES_CREATE_USER_ID, TASK_PROPERTIES:source::STRING AS TASK_PROPERTIES_SOURCE, TASK_PROPERTIES:assigned_to::STRING AS TASK_PROPERTIES_ASSIGNED_TO, TASK_PROPERTIES:update_user_id::STRING AS TASK_PROPERTIES_UPDATE_USER_ID, TASK_PROPERTIES:fulltext_index::STRING AS TASK_PROPERTIES_FULLTEXT_INDEX, TASK_PROPERTIES:description::STRING AS TASK_PROPERTIES_DESCRIPTION, TASK_PROPERTIES:priority::STRING AS TASK_PROPERTIES_PRIORITY, TASK_PROPERTIES:update_time::STRING AS TASK_PROPERTIES_UPDATE_TIME, TASK_PROPERTIES:status::STRING AS TASK_PROPERTIES_STATUS, TASK_PROPERTIES:details::STRING AS TASK_PROPERTIES_DETAILS, TASK_PROPERTIES:due_date::STRING AS TASK_PROPERTIES_DUE_DATE, TASK_PROPERTIES:Op::STRING AS TASK_PROPERTIES_OP 
        FROM ALAYACARE_PRODUCTION."5C3EE5FE-45A5-4DA7-A35B-BD7CDAFE3548".SHARED_TASK;

	SELECT CONCAT(''Message : '',"number of rows inserted",'' Rows Inserted.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
	return return_result;
END;
';