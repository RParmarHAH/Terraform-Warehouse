create or replace view DISC_PROD.ADP.VW_ANSWERCARE_EMPLOYEE(
	ID,
	EMPLOYEE_NUMBER,
	COMPANY,
	EMPLOYEE_SSN,
	EMPLOYEE_FIRST_NAME,
	EMPLOYEE_MIDDLE_NAME,
	EMPLOYEE_LAST_NAME,
	EMPLOYEE_HIRE_DATE,
	EMPLOYEE_REHIRE_DATE,
	EMPLOYEE_TERMINATE_DATE,
	ACTIVE_EMPLOYEE_FLAG
) as 
SELECT DISTINCT 
	FILE_NUMBER AS ID,
	FILE_NUMBER AS EMPLOYEE_NUMBER,
	'ADP-ANSWERCARE' AS COMPANY,
	TRIM(REPLACE(TAX_ID, '-')) AS EMPLOYEE_SSN,
	TRIM(UPPER(SPLIT_PART(NAME, ',', 2))) AS EMPLOYEE_FIRST_NAME,
	UPPER(TRIM(SPLIT_PART(SPLIT_PART(AP."NAME", ',', 2), ' ', 3))) AS EMPLOYEE_MIDDLE_NAME,
	REPLACE(TRIM(UPPER(SPLIT_PART(NAME, ',', 1))), '-', ' ') AS EMPLOYEE_LAST_NAME,
	HIRE_DATE::DATE AS EMPLOYEE_HIRE_DATE,
	REHIRE_DATE::DATE AS EMPLOYEE_REHIRE_DATE,
	TERMINATION_DATE::DATE AS EMPLOYEE_TERMINATE_DATE,
	CASE
		WHEN AP.STATUS = 'T-Terminated' THEN FALSE
		WHEN AP.STATUS IN ('A-Active', 'L-Leave') THEN TRUE
		ELSE NULL
	END AS ACTIVE_EMPLOYEE_FLAG
FROM DISC_DEV.ADP.ANSWERCARE_PAYROLL AP;