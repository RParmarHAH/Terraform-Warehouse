create or replace view DISC_PROD.DATAFLEXSYNCDATA.ALL_DFINVOICEDETAILS(
	DBNAME,
	REFERENCENO,
	INVOICENO,
	DATEFROM,
	DATETO,
	HOURS,
	AMOUNT,
	AMOUNTPAID,
	BILLCODE,
	CLIENTNUMBER,
	EMPLOYEENO1,
	EMPLOYEENO2,
	EMPLOYEENO3,
	CONTRACTCODE,
	PREAUTHNUMBER,
	STARTTIME,
	CREATEDDATE,
	UPDATEBATCH,
	UPDATEDTIME,
	DATASOURCE,
	SYS_CHANGE_VERSION,
	SYS_CHANGE_OPERATION,
	ETL_TASK_KEY,
	ETL_INSERTED_TASK_KEY,
	ETL_INSERTED_DATE,
	ETL_INSERTED_BY,
	ETL_LAST_UPDATED_DATE,
	ETL_LAST_UPDATED_BY,
	ETL_DELETED_FLAG,
	OLDRECNUM,
	BILLINGNUMBER
) as (
SELECT
	DBNAME,
	REFERENCENO::VARCHAR,
	INVOICENO,
	DATEFROM,
	DATETO,
	HOURS,
	AMOUNT,
	AMOUNTPAID,
	BILLCODE,
	CLIENTNUMBER,
	EMPLOYEENO1,
	EMPLOYEENO2,
	EMPLOYEENO3,
	CONTRACTCODE,
	PREAUTHNUMBER,
	STARTTIME,
	CREATEDDATE,
	UPDATEBATCH,
	UPDATEDTIME,
	DATASOURCE,
	SYS_CHANGE_VERSION,
	SYS_CHANGE_OPERATION,
	ETL_TASK_KEY,
	ETL_INSERTED_TASK_KEY,
	ETL_INSERTED_DATE,
	ETL_INSERTED_BY,
	ETL_LAST_UPDATED_DATE,
	ETL_LAST_UPDATED_BY,
	ETL_DELETED_FLAG,
	NULL AS OLDRECNUM,
	NULL AS BILLINGNUMBER
FROM
	DATAFLEXSYNCDATA.DFINVOICEDETAILS
UNION
SELECT
	'IL' AS DBNAME,
	'OLD_' || RECORD_NUMBER AS REFERENCENO,
	INVOICE_NO AS INVOICENO,
	DATEFROM,
	DATETO,
	HOURS,
	AMOUNT,
	AMOUNT_PAID AS AMOUNTPAID,
	BILLCODE,
	CLIENT_NUMBER AS CLIENTNUMBER,
	NULL AS EMPLOYEENO1,
	NULL AS EMPLOYEENO2,
	NULL AS EMPLOYEENO3,
	CASE BILLCODE
		WHEN 'IDA' THEN '2'
		WHEN 'ADT' THEN 'AT'
		WHEN 'ADS' THEN 'AS'
	END AS CONTRACTCODE,
	NULL AS PREAUTHNUMBER,
	NULL AS STARTTIME,
	NULL AS CREATEDDATE,
	NULL AS UPDATEBATCH,
	NULL AS UPDATEDTIME,
	'INVDTL  ' AS DATASOURCE,
	SYS_CHANGE_VERSION,
	SYS_CHANGE_OPERATION,
	ETL_TASK_KEY,
	ETL_INSERTED_TASK_KEY,
	ETL_INSERTED_DATE,
	ETL_INSERTED_BY,
	ETL_LAST_UPDATED_DATE,
	ETL_LAST_UPDATED_BY,
	ETL_DELETED_FLAG,
	OLDRECNUM,
	BILLING_NUMBER
FROM
	DATAFLEXSYNCDATA.IL_INVDTLOL
);