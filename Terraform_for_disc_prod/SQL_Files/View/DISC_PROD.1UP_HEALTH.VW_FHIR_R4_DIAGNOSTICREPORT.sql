create or replace view DISC_PROD."1UP_HEALTH".VW_FHIR_R4_DIAGNOSTICREPORT(
	ID,
	BASEDON_REFERENCE,
	CATEGORY_CODING_CODE,
	CATEGORY_CODING_DISPLAY,
	CATEGORY_CODING_SYSTEM,
	CATEGORY_TEXT,
	CODE_CODING_SYSTEM,
	CODE_CODING_CODE,
	CODE_CODING_DISPLAY,
	CODE_TEXT,
	EFFECTIVEDATETIME,
	ENCOUNTER_REFERENCE,
	IDENTIFIER_SYSTEM1,
	IDENTIFIER_USE1,
	IDENTIFIER_VALUE1,
	IDENTIFIER_SYSTEM2,
	IDENTIFIER_USE2,
	IDENTIFIER_TYPE_CODING_CODE2,
	IDENTIFIER_TYPE_CODING_DISPLAY2,
	IDENTIFIER_TYPE_CODING_SYSTEM2,
	IDENTIFIER_VALUE2,
	IDENTIFIER_SYSTEM3,
	IDENTIFIER_USE3,
	IDENTIFIER_VALUE3,
	ISSUED,
	META_EXTENSION_URL1,
	META_EXTENSION_VALUEDATETIME1,
	META_EXTENSION_VALUECODEABLECONCEPT_CODING_CODE1,
	META_EXTENSION_VALUECODEABLECONCEPT_CODING_DISPLAY1,
	META_EXTENSION_VALUECODEABLECONCEPT_CODING_SYSTEM1,
	META_EXTENSION_URL2,
	META_EXTENSION_VALUECODEABLECONCEPT_CODING_CODE2,
	META_EXTENSION_VALUECODEABLECONCEPT_CODING_SYSTEM2,
	META_EXTENSION_URL3,
	META_EXTENSION_VALUECODEABLECONCEPT_CODING_CODE3,
	META_EXTENSION_VALUECODEABLECONCEPT_CODING_SYSTEM3,
	META_EXTENSION_URL4,
	META_EXTENSION_VALUEDATETIME4,
	META_EXTENSION_URL5,
	META_EXTENSION_VALUESTRING5,
	META_EXTENSION_URL6,
	META_EXTENSION_VALUESTRING6,
	META_EXTENSION_URL7,
	META_EXTENSION_VALUESTRING7,
	META_LASTUPDATED,
	META_SOURCE,
	META_VERSIONID,
	RESOURCETYPE,
	RESULT_REFERENCE1,
	RESULT_DISPLAY1,
	RESULT_REFERENCE2,
	RESULT_DISPLAY2,
	RESULT_REFERENCE3,
	RESULT_DISPLAY3,
	RESULT_REFERENCE4,
	RESULT_DISPLAY4,
	RESULT_REFERENCE5,
	RESULT_DISPLAY5,
	RESULT_REFERENCE6,
	RESULT_DISPLAY6,
	RESULT_REFERENCE7,
	RESULT_DISPLAY7,
	RESULT_REFERENCE8,
	RESULT_DISPLAY8,
	RESULT_REFERENCE9,
	RESULT_DISPLAY9,
	RESULT_REFERENCE10,
	RESULT_DISPLAY10,
	RESULT_REFERENCE11,
	RESULT_DISPLAY11,
	RESULT_REFERENCE12,
	RESULT_DISPLAY12,
	RESULT_REFERENCE13,
	RESULT_DISPLAY13,
	RESULT_REFERENCE14,
	RESULT_DISPLAY14,
	RESULT_REFERENCE15,
	RESULT_DISPLAY15,
	RESULT_REFERENCE16,
	RESULT_DISPLAY16,
	RESULT_REFERENCE17,
	RESULT_DISPLAY17,
	RESULT_REFERENCE18,
	RESULT_DISPLAY18,
	RESULT_REFERENCE19,
	RESULT_DISPLAY19,
	RESULT_REFERENCE20,
	RESULT_DISPLAY20,
	RESULT_REFERENCE21,
	RESULT_DISPLAY21,
	RESULT_REFERENCE22,
	RESULT_DISPLAY22,
	RESULT_REFERENCE23,
	RESULT_DISPLAY23,
	RESULT_REFERENCE24,
	RESULT_DISPLAY24,
	RESULT_REFERENCE25,
	RESULT_DISPLAY25,
	RESULT_REFERENCE26,
	RESULT_DISPLAY26,
	RESULT_REFERENCE27,
	RESULT_DISPLAY27,
	RESULT_REFERENCE28,
	RESULT_DISPLAY28,
	RESULT_REFERENCE29,
	RESULT_DISPLAY29,
	RESULT_REFERENCE30,
	RESULT_DISPLAY30,
	RESULT_REFERENCE31,
	RESULT_DISPLAY31,
	RESULT_REFERENCE32,
	RESULT_DISPLAY32,
	RESULT_REFERENCE33,
	RESULT_DISPLAY33,
	RESULT_REFERENCE34,
	RESULT_DISPLAY34,
	RESULT_REFERENCE35,
	RESULT_DISPLAY35,
	RESULT_REFERENCE36,
	RESULT_DISPLAY36,
	RESULT_REFERENCE37,
	RESULT_DISPLAY37,
	RESULT_REFERENCE38,
	RESULT_DISPLAY38,
	RESULT_REFERENCE39,
	RESULT_DISPLAY39,
	RESULT_REFERENCE40,
	RESULT_DISPLAY40,
	RESULT_REFERENCE41,
	RESULT_DISPLAY41,
	RESULT_REFERENCE42,
	RESULT_DISPLAY42,
	RESULT_REFERENCE43,
	RESULT_DISPLAY43,
	RESULT_REFERENCE44,
	RESULT_DISPLAY44,
	RESULT_REFERENCE45,
	RESULT_DISPLAY45,
	RESULT_REFERENCE46,
	RESULT_DISPLAY46,
	RESULT_REFERENCE47,
	RESULT_DISPLAY47,
	RESULT_REFERENCE48,
	RESULT_DISPLAY48,
	RESULT_REFERENCE49,
	RESULT_DISPLAY49,
	RESULT_REFERENCE50,
	RESULT_DISPLAY50,
	RESULT_REFERENCE51,
	RESULT_DISPLAY51,
	RESULT_REFERENCE52,
	RESULT_DISPLAY52,
	RESULT_REFERENCE53,
	RESULT_DISPLAY53,
	RESULT_REFERENCE54,
	RESULT_DISPLAY54,
	RESULT_REFERENCE55,
	RESULT_DISPLAY55,
	RESULT_REFERENCE56,
	RESULT_DISPLAY56,
	RESULT_REFERENCE57,
	RESULT_DISPLAY57,
	RESULT_REFERENCE58,
	RESULT_DISPLAY58,
	RESULT_REFERENCE59,
	RESULT_DISPLAY59,
	RESULT_REFERENCE60,
	RESULT_DISPLAY60,
	RESULT_REFERENCE61,
	RESULT_DISPLAY61,
	RESULT_REFERENCE62,
	RESULT_DISPLAY62,
	RESULT_REFERENCE63,
	RESULT_DISPLAY63,
	RESULT_REFERENCE64,
	RESULT_DISPLAY64,
	RESULT_REFERENCE65,
	RESULT_DISPLAY65,
	RESULT_REFERENCE66,
	RESULT_DISPLAY66,
	RESULT_REFERENCE67,
	RESULT_DISPLAY67,
	RESULT_REFERENCE68,
	RESULT_DISPLAY68,
	RESULT_REFERENCE69,
	RESULT_DISPLAY69,
	RESULT_REFERENCE70,
	RESULT_DISPLAY70,
	RESULT_REFERENCE71,
	RESULT_DISPLAY71,
	RESULT_REFERENCE72,
	RESULT_DISPLAY72,
	RESULT_REFERENCE73,
	RESULT_DISPLAY73,
	RESULT_REFERENCE74,
	RESULT_DISPLAY74,
	RESULT_REFERENCE75,
	RESULT_DISPLAY75,
	RESULT_REFERENCE76,
	RESULT_DISPLAY76,
	RESULT_REFERENCE77,
	RESULT_DISPLAY77,
	RESULT_REFERENCE78,
	RESULT_DISPLAY78,
	RESULT_REFERENCE79,
	RESULT_DISPLAY79,
	STATUS,
	PERFORMER_DISPLAY,
	PERFORMER_REFERENCE,
	SUBJECT_DISPLAY,
	SUBJECT_REFERENCE,
	LANDING_INSERTED_DATE,
	LANDING_INSERTED_BY,
	FILENAME,
	ETL_INSERTED_BY,
	ETL_TASK_KEY,
	ETL_INSERTED_DATE
) as (
select 
parse_json(source_data):id::string as id,
parse_json(source_data):basedOn[0]:reference::string as basedOn_reference,
parse_json(source_data):category[0]:coding[0]:code::string as category_coding_code,
parse_json(source_data):category[0]:coding[0]:display::string as category_coding_display,
parse_json(source_data):category[0]:coding[0]:system::string as category_coding_system,
parse_json(source_data):category[0]:text::string as category_text,
parse_json(source_data):code:coding[0]:system::string as code_coding_system,
parse_json(source_data):code:coding[0]:code::string as code_coding_code,
parse_json(source_data):code:coding[0]:display::string as code_coding_display,
parse_json(source_data):code:text::string as code_text,
parse_json(source_data):effectiveDateTime::TIMESTAMP_NTZ(9) as effectiveDateTime,
parse_json(source_data):encounter:reference::string as encounter_reference,
parse_json(source_data):identifier[0]:system::string as identifier_system1,
parse_json(source_data):identifier[0]:use::string as identifier_use1,
parse_json(source_data):identifier[0]:value::string as identifier_value1,
parse_json(source_data):identifier[1]:system::string as identifier_system2,
parse_json(source_data):identifier[1]:use::string as identifier_use2,
parse_json(source_data):identifier[1]:type:coding[0]:code::string as identifier_type_coding_code2,
parse_json(source_data):identifier[1]:type:coding[0]:display::string as identifier_type_coding_display2,
parse_json(source_data):identifier[1]:type:coding[0]:system::string as identifier_type_coding_system2,
parse_json(source_data):identifier[1]:value::string as identifier_value2,
parse_json(source_data):identifier[2]:system::string as identifier_system3,
parse_json(source_data):identifier[2]:use::string as identifier_use3,
parse_json(source_data):identifier[2]:value::string as identifier_value3,
parse_json(source_data):issued::string as issued,
parse_json(source_data):meta:extension[0]:url::string as meta_extension_url1,
parse_json(source_data):meta:extension[0]:valueDateTime::TIMESTAMP_NTZ(9) as meta_extension_valueDateTime1,
PARSE_JSON(SOURCE_DATA):meta:extension[0]:valueCodeableConcept:coding[0]:code::STRING AS meta_extension_valueCodeableConcept_coding_code1,
PARSE_JSON(SOURCE_DATA):meta:extension[0]:valueCodeableConcept:coding[0]:display::STRING AS meta_extension_valueCodeableConcept_coding_display1,
PARSE_JSON(SOURCE_DATA):meta:extension[0]:valueCodeableConcept:coding[0]:system::STRING AS meta_extension_valueCodeableConcept_coding_system1,
parse_json(source_data):meta:extension[1]:url::string as meta_extension_url2,
parse_json(source_data):meta:extension[1]:valueCodeableConcept:coding[0]:code::string as meta_extension_valueCodeableConcept_coding_code2,
parse_json(source_data):meta:extension[1]:valueCodeableConcept:coding[0]:system::string as meta_extension_valueCodeableConcept_coding_system2,
parse_json(source_data):meta:extension[2]:url::string as meta_extension_url3,
parse_json(source_data):meta:extension[2]:valueCodeableConcept:coding[0]:code::string as meta_extension_valueCodeableConcept_coding_code3,
parse_json(source_data):meta:extension[2]:valueCodeableConcept:coding[0]:system::string as meta_extension_valueCodeableConcept_coding_system3,
parse_json(source_data):meta:extension[3]:url::string as meta_extension_url4,
parse_json(source_data):meta:extension[3]:valueDateTime::TIMESTAMP_NTZ(9) as meta_extension_valueDateTime4,
parse_json(source_data):meta:extension[4]:url::string as meta_extension_url5,
parse_json(source_data):meta:extension[4]:valueString::string as meta_extension_valueString5,
parse_json(source_data):meta:extension[5]:url::string as meta_extension_url6,
parse_json(source_data):meta:extension[5]:valueString::string as meta_extension_valueString6,
parse_json(source_data):meta:extension[6]:url::string as meta_extension_url7,
parse_json(source_data):meta:extension[6]:valueString::string as meta_extension_valueString7,
parse_json(source_data):meta:lastUpdated::TIMESTAMP_NTZ(9) as meta_lastUpdated,
parse_json(source_data):meta:source::string as meta_source,
parse_json(source_data):meta:versionId::string as meta_versionId,
parse_json(source_data):resourceType::string as resourceType,
parse_json(source_data):result[0]:reference::string as result_reference1,
parse_json(source_data):result[0]:display::string as result_display1,
parse_json(source_data):result[1]:reference::string as result_reference2,
parse_json(source_data):result[1]:display::string as result_display2,
parse_json(source_data):result[2]:reference::string as result_reference3,
parse_json(source_data):result[2]:display::string as result_display3,
parse_json(source_data):result[3]:reference::string as result_reference4,
parse_json(source_data):result[3]:display::string as result_display4,
parse_json(source_data):result[4]:reference::string as result_reference5,
parse_json(source_data):result[4]:display::string as result_display5,
parse_json(source_data):result[5]:reference::string as result_reference6,
parse_json(source_data):result[5]:display::string as result_display6,
parse_json(source_data):result[6]:reference::string as result_reference7,
parse_json(source_data):result[6]:display::string as result_display7,
parse_json(source_data):result[7]:reference::string as result_reference8,
parse_json(source_data):result[7]:display::string as result_display8,
parse_json(source_data):result[8]:reference::string as result_reference9,
parse_json(source_data):result[8]:display::string as result_display9,
parse_json(source_data):result[9]:reference::string as result_reference10,
parse_json(source_data):result[9]:display::string as result_display10,
parse_json(source_data):result[10]:reference::string as result_reference11,
parse_json(source_data):result[10]:display::string as result_display11,
parse_json(source_data):result[11]:reference::string as result_reference12,
parse_json(source_data):result[11]:display::string as result_display12,
parse_json(source_data):result[12]:reference::string as result_reference13,
parse_json(source_data):result[12]:display::string as result_display13,
parse_json(source_data):result[13]:reference::string as result_reference14,
parse_json(source_data):result[13]:display::string as result_display14,
parse_json(source_data):result[14]:reference::string as result_reference15,
parse_json(source_data):result[14]:display::string as result_display15,
parse_json(source_data):result[15]:reference::string as result_reference16,
parse_json(source_data):result[15]:display::string as result_display16,
parse_json(source_data):result[16]:reference::string as result_reference17,
parse_json(source_data):result[16]:display::string as result_display17,
parse_json(source_data):result[17]:reference::string as result_reference18,
parse_json(source_data):result[17]:display::string as result_display18,
parse_json(source_data):result[18]:reference::string as result_reference19,
parse_json(source_data):result[18]:display::string as result_display19,
parse_json(source_data):result[19]:reference::string as result_reference20,
parse_json(source_data):result[19]:display::string as result_display20,
parse_json(source_data):result[20]:reference::string as result_reference21,
parse_json(source_data):result[20]:display::string as result_display21,
parse_json(source_data):result[21]:reference::string as result_reference22,
parse_json(source_data):result[21]:display::string as result_display22,
parse_json(source_data):result[22]:reference::string as result_reference23,
parse_json(source_data):result[22]:display::string as result_display23,
parse_json(source_data):result[23]:reference::string as result_reference24,
parse_json(source_data):result[23]:display::string as result_display24,
parse_json(source_data):result[24]:reference::string as result_reference25,
parse_json(source_data):result[24]:display::string as result_display25,
parse_json(source_data):result[25]:reference::string as result_reference26,
parse_json(source_data):result[25]:display::string as result_display26,
parse_json(source_data):result[26]:reference::string as result_reference27,
parse_json(source_data):result[26]:display::string as result_display27,
parse_json(source_data):result[27]:reference::string as result_reference28,
parse_json(source_data):result[27]:display::string as result_display28,
parse_json(source_data):result[28]:reference::string as result_reference29,
parse_json(source_data):result[28]:display::string as result_display29,
parse_json(source_data):result[29]:reference::string as result_reference30,
parse_json(source_data):result[29]:display::string as result_display30,
parse_json(source_data):result[30]:reference::string as result_reference31,
parse_json(source_data):result[30]:display::string as result_display31,
parse_json(source_data):result[31]:reference::string as result_reference32,
parse_json(source_data):result[31]:display::string as result_display32,
parse_json(source_data):result[32]:reference::string as result_reference33,
parse_json(source_data):result[32]:display::string as result_display33,
parse_json(source_data):result[33]:reference::string as result_reference34,
parse_json(source_data):result[33]:display::string as result_display34,
parse_json(source_data):result[34]:reference::string as result_reference35,
parse_json(source_data):result[34]:display::string as result_display35,
parse_json(source_data):result[35]:reference::string as result_reference36,
parse_json(source_data):result[35]:display::string as result_display36,
parse_json(source_data):result[36]:reference::string as result_reference37,
parse_json(source_data):result[36]:display::string as result_display37,
parse_json(source_data):result[37]:reference::string as result_reference38,
parse_json(source_data):result[37]:display::string as result_display38,
parse_json(source_data):result[38]:reference::string as result_reference39,
parse_json(source_data):result[38]:display::string as result_display39,
parse_json(source_data):result[39]:reference::string as result_reference40,
parse_json(source_data):result[39]:display::string as result_display40,
parse_json(source_data):result[40]:reference::string as result_reference41,
parse_json(source_data):result[40]:display::string as result_display41,
parse_json(source_data):result[41]:reference::string as result_reference42,
parse_json(source_data):result[41]:display::string as result_display42,
parse_json(source_data):result[42]:reference::string as result_reference43,
parse_json(source_data):result[42]:display::string as result_display43,
parse_json(source_data):result[43]:reference::string as result_reference44,
parse_json(source_data):result[43]:display::string as result_display44,
parse_json(source_data):result[44]:reference::string as result_reference45,
parse_json(source_data):result[44]:display::string as result_display45,
parse_json(source_data):result[45]:reference::string as result_reference46,
parse_json(source_data):result[45]:display::string as result_display46,
parse_json(source_data):result[46]:reference::string as result_reference47,
parse_json(source_data):result[46]:display::string as result_display47,
parse_json(source_data):result[47]:reference::string as result_reference48,
parse_json(source_data):result[47]:display::string as result_display48,
parse_json(source_data):result[48]:reference::string as result_reference49,
parse_json(source_data):result[48]:display::string as result_display49,
parse_json(source_data):result[49]:reference::string as result_reference50,
parse_json(source_data):result[49]:display::string as result_display50,
parse_json(source_data):result[50]:reference::string as result_reference51,
parse_json(source_data):result[50]:display::string as result_display51,
parse_json(source_data):result[51]:reference::string as result_reference52,
parse_json(source_data):result[51]:display::string as result_display52,
parse_json(source_data):result[52]:reference::string as result_reference53,
parse_json(source_data):result[52]:display::string as result_display53,
parse_json(source_data):result[53]:reference::string as result_reference54,
parse_json(source_data):result[53]:display::string as result_display54,
parse_json(source_data):result[54]:reference::string as result_reference55,
parse_json(source_data):result[54]:display::string as result_display55,
parse_json(source_data):result[55]:reference::string as result_reference56,
parse_json(source_data):result[55]:display::string as result_display56,
parse_json(source_data):result[56]:reference::string as result_reference57,
parse_json(source_data):result[56]:display::string as result_display57,
parse_json(source_data):result[57]:reference::string as result_reference58,
parse_json(source_data):result[57]:display::string as result_display58,
parse_json(source_data):result[58]:reference::string as result_reference59,
parse_json(source_data):result[58]:display::string as result_display59,
parse_json(source_data):result[59]:reference::string as result_reference60,
parse_json(source_data):result[59]:display::string as result_display60,
parse_json(source_data):result[60]:reference::string as result_reference61,
parse_json(source_data):result[60]:display::string as result_display61,
parse_json(source_data):result[61]:reference::string as result_reference62,
parse_json(source_data):result[61]:display::string as result_display62,
parse_json(source_data):result[62]:reference::string as result_reference63,
parse_json(source_data):result[62]:display::string as result_display63,
parse_json(source_data):result[63]:reference::string as result_reference64,
parse_json(source_data):result[63]:display::string as result_display64,
parse_json(source_data):result[64]:reference::string as result_reference65,
parse_json(source_data):result[64]:display::string as result_display65,
parse_json(source_data):result[65]:reference::string as result_reference66,
parse_json(source_data):result[65]:display::string as result_display66,
parse_json(source_data):result[66]:reference::string as result_reference67,
parse_json(source_data):result[66]:display::string as result_display67,
parse_json(source_data):result[67]:reference::string as result_reference68,
parse_json(source_data):result[67]:display::string as result_display68,
parse_json(source_data):result[68]:reference::string as result_reference69,
parse_json(source_data):result[68]:display::string as result_display69,
parse_json(source_data):result[69]:reference::string as result_reference70,
parse_json(source_data):result[69]:display::string as result_display70,
parse_json(source_data):result[70]:reference::string as result_reference71,
parse_json(source_data):result[70]:display::string as result_display71,
parse_json(source_data):result[71]:reference::string as result_reference72,
parse_json(source_data):result[71]:display::string as result_display72,
parse_json(source_data):result[72]:reference::string as result_reference73,
parse_json(source_data):result[72]:display::string as result_display73,
parse_json(source_data):result[73]:reference::string as result_reference74,
parse_json(source_data):result[73]:display::string as result_display74,
parse_json(source_data):result[74]:reference::string as result_reference75,
parse_json(source_data):result[74]:display::string as result_display75,
parse_json(source_data):result[75]:reference::string as result_reference76,
parse_json(source_data):result[75]:display::string as result_display76,
parse_json(source_data):result[76]:reference::string as result_reference77,
parse_json(source_data):result[76]:display::string as result_display77,
parse_json(source_data):result[77]:reference::string as result_reference78,
parse_json(source_data):result[77]:display::string as result_display78,
parse_json(source_data):result[78]:reference::string as result_reference79,
parse_json(source_data):result[78]:display::string as result_display79,
parse_json(source_data):status::string as status,
parse_json(source_data):performer[0]:display::string AS performer_display,
parse_json(source_data):performer[0]:reference::string as performer_reference,
parse_json(source_data):subject:display::string AS subject_display,
parse_json(source_data):subject:reference::string as subject_reference,
LANDING_INSERTED_DATE,
LANDING_INSERTED_BY,
FILENAME,
ETL_INSERTED_BY,
ETL_TASK_KEY,
ETL_INSERTED_DATE 
FROM DISC_PROD."1UP_HEALTH".HIST_FHIR_R4_DIAGNOSTICREPORT
);