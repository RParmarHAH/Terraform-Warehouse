create or replace view DISC_PROD.AXXESS.VW_AXXESS_EMPLOYEES(
	EMPLOYEE_ID,
	SSN,
	FIRST_NAME,
	LAST_NAME,
	HIRE_DATE,
	TERMINATION_DATE,
	GENDER,
	DATE_OF_BIRTH,
	EMPLOYMENT_TYPE,
	TITLE_TYPE,
	ACTIVE_STATUS,
	ADDRESS_LINE_1,
	ADDRESS_CITY,
	ADDRESS_ZIPCODE,
	ADDRESS_STATECODE,
	WORKING_LOCATION_STATECODE,
	IS_CASE_MANAGER,
	ETL_TASK_KEY,
	ETL_INSERTED_TASK_KEY,
	ETL_INSERTED_DATE,
	ETL_INSERTED_BY,
	ETL_LAST_UPDATED_DATE,
	ETL_LAST_UPDATED_BY,
	ETL_DELETED_FLAG,
	REVENUE_CATEGORY
) as
SELECT
EMPLOYEE_ID,
SSN,
UPPER(FIRST_NAME),
UPPER(LAST_NAME),
HIRE_DATE,
TERMINATION_DATE,
GENDER,
DATE_OF_BIRTH,
EMPLOYMENT_TYPE,
TITLE_TYPE,
UPPER(ACTIVE_STATUS),
ADDRESS_LINE_1 ,
ADDRESS_CITY,
ADDRESS_ZIPCODE,
ADDRESS_STATECODE,
WORKING_LOCATION_STATECODE,
IS_CASE_MANAGER,
ETL_TASK_KEY,
ETL_INSERTED_TASK_KEY,
ETL_INSERTED_DATE,
ETL_INSERTED_BY,
ETL_LAST_UPDATED_DATE ,
ETL_LAST_UPDATED_BY,
ETL_DELETED_FLAG,
'HH' AS REVENUE_CATEGORY
FROM axxess.AXXESS_EMPLOYEEINFO
WHERE EMPLOYEE_ID IS NOT NULL
UNION ALL
/*
SELECT DISTINCT
TD.ASSIGNED_WORKER_ID AS EMPLOYEE_ID,
NULL AS SSN,
 SUBSTRING(TD.ASSIGNED_TO_WORKER , CHARINDEX(' ', TD.ASSIGNED_TO_WORKER)+1,LENGTH(TD.ASSIGNED_TO_WORKER) )  AS FIRST_NAME ,
SUBSTRING(TD.ASSIGNED_TO_WORKER , 1, CHARINDEX(' ', TD.ASSIGNED_TO_WORKER)-1) AS  LAST_NAME,
NULL AS HIRE_DATE,
NULL AS TERMINATION_DATE,
NULL AS GENDER,
NULL AS DATE_OF_BIRTH,
NULL AS EMPLOYMENT_TYPE,
NULL AS TITLE_TYPE,
NULL AS ACTIVE_STATUS,
NULL AS ADDRESS_LINE_1,
NULL AS ADDRESS_CITY,
NULL AS ADDRESS_ZIPCODE,
NULL AS ADDRESS_STATECODE,
NULL AS WORKING_LOCATION_STATECODE,
NULL AS IS_CASE_MANAGER,
NULL AS ETL_TASK_KEY,
NULL AS ETL_INSERTED_TASK_KEY,
NULL AS ETL_INSERTED_DATE,
NULL AS ETL_INSERTED_BY,
NULL AS ETL_LAST_UPDATED_DATE ,
NULL AS ETL_LAST_UPDATED_BY,
NULL AS ETL_DELETED_FLAG,
'HC' AS REVENUE_CATEGORY
FROM DISC_DEV.AXXESS.AXXESS_TASKDETAILS TD
WHERE EMPLOYEE_ID IS NOT NULL;
*/
-- AS PER ARBIN'S MAIL ON 12/11, FETCHING HC EMP FROM WORKDETAILS TABLE
SELECT 	DISTINCT
		WD.WORKER_ID AS EMPLOYEE_ID,
		NULL AS SSN,
		UPPER(WD.WORKER_FIRSTNAME) AS FIRST_NAME,
		UPPER(WD.WORKER_LASTNAME) AS LAST_NAME,
		WD.DATE_OF_HIRE AS HIRE_DATE,
		WD.TERMINATION_DATE AS TERMINATION_DATE,
		NULL AS GENDER,
		NULL AS DATE_OF_BIRTH,
		WD.WORKER_TYPE AS EMPLOYMENT_TYPE,
		NULL AS TITLE_TYPE,
		CASE WHEN UPPER(WD.WORKER_STATUS)='ACTIVE' THEN '1' 
      		 WHEN UPPER(WD.WORKER_STATUS)='TERMINATE' THEN '2' 
      		 END AS ACTIVE_STATUS,
		NULL AS ADDRESS_LINE_1,
		NULL AS ADDRESS_CITY,
		NULL AS ADDRESS_ZIPCODE,
		NULL AS ADDRESS_STATECODE,
		NULL AS WORKING_LOCATION_STATECODE,
		NULL AS IS_CASE_MANAGER,
		NULL AS ETL_TASK_KEY,
		NULL AS ETL_INSERTED_TASK_KEY,
		NULL AS ETL_INSERTED_DATE,
		NULL AS ETL_INSERTED_BY,
		NULL AS ETL_LAST_UPDATED_DATE ,
		NULL AS ETL_LAST_UPDATED_BY,
		NULL AS ETL_DELETED_FLAG,
		'HC' AS REVENUE_CATEGORY
--SELECT * 
FROM AXXESS.AXXESS_WORKERDETAILS WD
WHERE EMPLOYEE_ID IS NOT NULL;