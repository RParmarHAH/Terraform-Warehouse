create or replace view DISC_PROD.DATA_CLEANSING.EMPLOYEE_ADDRESS_STANDARDIZATION_INPUT(
	SOURCE_SYSTEM_ID,
	SYSTEM_CODE,
	EMPLOYEE_ID,
	EMPLOYEE_FIRST_NAME,
	EMPLOYEE_LAST_NAME,
	ADDRESS,
	CITY,
	STATE,
	ZIP
) as
SELECT SOURCE_SYSTEM_ID, SYSTEM_CODE, EMPLOYEE_ID, 
       EMPLOYEE_FIRST_NAME, EMPLOYEE_LAST_NAME, 
       SRC_EMPLOYEE_ADDRESS AS Address, SRC_EMPLOYEE_CITY AS City, SRC_EMPLOYEE_STATE_CODE AS State, TRIM( LEFT( SRC_EMPLOYEE_ZIP, 5)) AS Zip
FROM DATA_CLEANSING.EMPLOYEE_SRC_ATTRIBUTES 
WHERE Source_System_ID IN (17)
AND SYSTEM_CODE ='PREFERRED'
AND System_Code NOT IN ( 'GATOR')
--AND COALESCE ( SRC_EMPLOYEE_MAX_ACTIVITY_DATE,'1999-12-01') <= CAST( '2019-12-30' AS DATE)
AND SRC_Employee_Address_Processed_Flag = 'FALSE'
AND Src_Employee_Address IS NOT NULL AND TRIM(Src_Employee_Address) <> ''
AND ((Src_Employee_City IS NOT NULL AND TRIM(Src_Employee_City) <> '' 
AND Src_Employee_State_Code IS NOT NULL AND TRIM(Src_Employee_State_Code) <> '') 
OR (Src_Employee_Zip IS NOT NULL AND TRIM(Src_Employee_Zip) <> '' AND TRIM(Src_Employee_Zip) <> 'None'))
AND EMPLOYEE_ID IS NOT NULL AND EMPLOYEE_ID <> ''
AND EMPLOYEE_FIRST_NAME IS NOT NULL AND EMPLOYEE_FIRST_NAME <> ''
AND EMPLOYEE_LAST_NAME IS NOT NULL AND EMPLOYEE_LAST_NAME <> ''
--AND EMPLOYEE_ID ='243958252'
ORDER BY System_Code, Employee_Last_Name, Employee_First_Name;