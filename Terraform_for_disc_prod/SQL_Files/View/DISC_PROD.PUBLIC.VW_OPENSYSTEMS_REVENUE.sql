create or replace view DISC_PROD.PUBLIC.VW_OPENSYSTEMS_REVENUE(
	SERVICECODEID,
	CONTRACTID,
	REVENUE_SUBCATEGORY_CODE,
	REVENUE_SUBCATEGORY_NAME,
	REVENUE_CATEGORY
) as (
WITH VW_OPENSYSTEMS_REVENUE AS (
SELECT 

SERVICECODEID,
CONTRACTID,
case
when SERVICECODEID in ('165003','427259','427328','427397','427466','427535','427604','427673','427742','427811','427880','181461','165004','427260',
'427329','427398','427467','427536','427605','427674','427743','427812','427881','183436','179557','94420','95394','95404','95405','95406','95407','99374',
'127371','95402','95403','175996','99213','165005','427258','427327','427396','427465','427534','427603','427672','427741','427810','427879','177170',
'427265','427334','427403','427472','427541','427610','427679','427748','427817','427886','177171','173635','427257','427326','427395','427464','427533',
'427602','427671','427740','427809','427878','177172','177173','177174','427264','427333','427402','427471','427540','427609','427678','427747','427816',
'427885','232999','427256','427325','427394','427463','427532','427601','427670','427739','427808','427877','181510','177175','177176','144137','165006',
'191314','427261','427330','427399','427468','427537','427606','427675','427744','427813','427882','184788','427262','427331','427400','427469','427538',
'427607','427676','427745','427814','427883','94430','231430','427263','427332','427401','427470','427539','427608','427677','427746','427815','427884',
'524013','524014','466865','466866','466867','466868','466869','466870','466871','466872','466873','466874','466875','466876','175496','427249','427318',
'427387','427456','427525','427594','427663','427732','427801','427870','144307','181232','181235','427250','427319','427388','427457','427526','427595',
'427664','427733','427802','427871','181791','179559','91982','95352','112356','112358','95362','95363','95364','95365','99370','112388','112390','112392',
'112394','112396','112398','531504','95360','95361','112348','112350','112352','112354','165436','99214','112400','112402','184197','427248','427317','427386',
'427455','427524','427593','427662','427731','427800','427869','177177','427255','427324','427393','427462','427531','427600','427669','427738','427807',
'427876','112357','112359','112389','112391','112393','112395','112397','112399','112349','112351','112353','112355','177178','112401','112403','174085',
'427247','427316','427385','427454','427523','427592','427661','427730','427799','427868','177179','177180','177181','427254','427323','427392','427461',
'427530','427599','427668','427737','427806','427875','174084','427246','427315','427384','427453','427522','427591','427660','427729','427798','427867',
'177182','177183','184460','427251','427320','427389','427458','427527','427596','427665','427734','427803','427872','180620','232952','427252','427321',
'427390','427459','427528','427597','427666','427735','427804','427873','91992','232997','427253','427322','427391','427460','427529','427598','427667',
'427736','427805','427874','242142','242327','427303','427372','427441','427510','427579','427648','427717','427786','427855','427924','299523','172544',
'427282','427351','427420','427489','427558','427627','427696','427765','427834','427903','186654','186655','174947','174948','175385','427285','427354',
'427423','427492','427561','427630','427699','427768','427837','427906','128570','128571','128572','128573','128575','128576','128580','128568','128569',
'128577','128578','128579','130362','130363','130364','130365','130366','130368','130369','130370','149354','149436','166806','166807','166808','166809',
'174665','174666','174668','174670','174672','174673','174674','174675','174676','174677','174678','174679','174682','174683','174684','174685','178802',
'178803','181420','181421','181422','181423','181424','181425','181427','181428','181429','184795','184796','184797','184798','197275','197276','197277',
'371142','371143','371144','371145','389115','389116','389117','389118','427267','427336','427405','427474','427543','427612','427681','427750','427819',
'427888','524010','524011','524012','241422','241424','241425','241426','427301','427370','427439','427508','427577','427646','427715','427784','427853',
'427922','524015','524016','174626','427271','427340','427409','427478','427547','427616','427685','427754','427823','427892','251370','427272','427341',
'427410','427479','427548','427617','427686','427755','427824','427893','179298','427270','427339','427408','427477','427546','427615','427684','427753',
'427822','427891','427269','427338','427407','427476','427545','427614','427683','427752','427821','427890','130961','181462','130969','177185','427276',
'427345','427414','427483','427552','427621','427690','427759','427828','427897','130972','130975','130978','130970','427268','427337','427406','427475',
'427544','427613','427682','427751','427820','427889','181511','184505','427273','427342','427411','427480','427549','427618','427687','427756','427825',
'427894','130971','130973','144017','427274','427343','427412','427481','427550','427619','427688','427757','427826','427895','130976','427275','427344',
'427413','427482','427551','427620','427689','427758','427827','427896','172545','427283','427352','427421','427490','427559','427628','427697','427766',
'427835','427904','407405','172543','427281','427350','427419','427488','427557','427626','427695','427764','427833','427902','172277','172278','172279',
'172280','172281','427280','427349','427418','427487','427556','427625','427694','427763','427832','427901','537993','174946','427284','427353','427422',
'427491','427560','427629','427698','427767','427836','427905','177227','177228','177229','177230','177231','177232','177233','177234','178579','178580',
'178581','178582','178583','178584','178585','178586','178587','178588','178589','178590','178591','178592','178593','178594','178595','178596','178597',
'178598','178643','186932','404430','525520','178645','178646','178647','178648','178649','308814','362676','362677','362678','362679','177226','427292',
'427361','427430','427499','427568','427637','427706','427775','427844','427913','184671','184672','186656','174949','174950','180293','427286','427355',
'427424','427493','427562','427631','427700','427769','427838','427907','141460','180642','427277','427346','427415','427484','427553','427622','427691',
'427760','427829','427898','177166','177167','177168','427291','427360','427429','427498','427567','427636','427705','427774','427843','427912','175407',
'175408','175409','175411','175412','175419','175420','175421','175423','175424','175426','175428','175429','175431','175432','175434','175439','175441',
'175442','175443','175444','175445','175446','175447','175448','175449','175450','175451','175457','175458','175459','175460','175461','175462','175463',
'175464','175465','175466','175467','175468','175469','175470','175471','175472','175473','175475','175476','175477','175480','175481','175482','175483',
'175484','175485','175486','175487','177164','177165','427290','427359','427428','427497','427566','427635','427704','427773','427842','427911','180178',
'427293','427362','427431','427500','427569','427638','427707','427776','427845','427914','174615','180978','427278','427347','427416','427485','427554',
'427623','427692','427761','427830','427899','191145','191146','191147','427296','427365','427434','427503','427572','427641','427710','427779','427848',
'427917','530504','530505','167408','167409','167410','167411','176817','427279','427348','427417','427486','427555','427624','427693','427762','427831',
'427900','359133','359134','169412','427239','427308','427377','427446','427515','427584','427653','427722','427791','427860','143773','181463','240087',
'427240','427309','427378','427447','427516','427585','427654','427723','427792','427861','143775','233000','179561','95336','95350','96850','96852','96854',
'135528','135524','152310','95348','135526','174618','427238','427307','427376','427445','427514','427583','427652','427721','427790','427859','177186',
'427245','427314','427383','427452','427521','427590','427659','427728','427797','427866','177187','173602','427237','427306','427375','427444','427513',
'427582','427651','427720','427789','427858','177188','177189','177190','427244','427313','427382','427451','427520','427589','427658','427727','427796',
'427865','95344','95346','300180','427236','427305','427374','427443','427512','427581','427650','427719','427788','427857','177191','95351','95345','95347',
'177192','95349','184504','427241','427310','427379','427448','427517','427586','427655','427724','427793','427862','135527','135529','143772','143774',
'144306','135525','143770','143771','179988','427242','427311','427380','427449','427518','427587','427656','427725','427794','427863','96851','96853','197124',
'427243','427312','427381','427450','427519','427588','427657','427726','427795','427864','128515','128516','128517','128518','427266','427335','427404',
'427473','427542','427611','427680','427749','427818','427887','186658','186659','186660','427295','427364','427433','427502','427571','427640','427709',
'427778','427847','427916') then 'HC'
when SERVICECODEID in (
'95395','95397','95398','95399','95400','95396','95401','235083','235085','776442','776443','776444','776445','776446','776447','776448','776457',
'776453','776454','776455','776456','776460','776461','776471','776472','776473','776441','776462','776435','776436','776437','776464','776425',
'776426','776427','776428','776429','776430','776431','776466','776467','776432','776433','776434','776465','776440','776449','776450','776451',
'776452','776458','776459','776468','776469','776470','776438','776439','776463','95353','112364','112366','95355','95356','112376','112378','112380',
'112382','95357','95358','112368','112370','112372','112374','95354','112360','112362','95359','112384','112386','112365','112367','112377','112379',
'112381','112383','112369','112371','112373','112375','112361','112363','112385','112387','251425','463139','463140','241423','235088','235089','776392',
'776393','776394','776395','776396','776397','776398','776407','776403','776404','776405','776406','776410','776411','776421','776422','776423','776391',
'776412','776385','776386','776387','776414','776375','776376','776377','776378','776379','776380','776381','776416','776417','776382','776383','776384',
'776415','776390','776399','776400','776401','776402','776408','776409','776418','776419','776420','776388','776389','776413','130965','130967','130963',
'130962','130964','130966','130968','209640','467066','95337','95339','95340','95341','95342','95338','95343','152156','186661'
) then 'HH'
ELSE 'UNKNOWN'
END
as REVENUE_CATEGORY,
CASE WHEN REVENUE_CATEGORY = 'HH' THEN 'HHA'
     WHEN REVENUE_CATEGORY = 'HC' THEN 'HC'
     END 
     AS REVENUE_SUBCATEGORY_CODE,
CASE WHEN   REVENUE_SUBCATEGORY_CODE= 'HHA' THEN 'Home Health Aide'
     WHEN   REVENUE_SUBCATEGORY_CODE= 'HC' THEN 'Home Care'
     END 
     AS REVENUE_SUBCATEGORY_NAME

FROM 
DISC_PROD.HHAEXCHANGEOPENSYSTEMS.SERVICECODES 
)
SELECT SERVICECODEID ,
	CONTRACTID,
	REVENUE_SUBCATEGORY_CODE,
	REVENUE_SUBCATEGORY_NAME,
	REVENUE_CATEGORY
	FROM VW_OPENSYSTEMS_REVENUE);