resource "snowflake_view" "DW_REPORT_VW_EXECUTIVE_OPERATIONS_EXCELLENCE_STEP_INCENTIVE" {
	database = "DW_${var.SF_ENVIRONMENT}"
	schema = "REPORT"
	name = "VW_EXECUTIVE_OPERATIONS_EXCELLENCE_STEP_INCENTIVE"
	statement = <<-SQL
	 SELECT REGION
	  ,STEP 
	  ,HRS_GOAL_BIWEEKLY 
	  ,FLAT_INCREASE 
	  ,REGION_NUMBER 
	  ,CASE WHEN HOURS_SERVED_EXEC_OPS_HOURS > HRS_GOAL_BIWEEKLY  THEN PAY_PERIOD_START_DATE END PAY_PERIOD_START_DATE
	  ,CASE WHEN HOURS_SERVED_EXEC_OPS_HOURS > HRS_GOAL_BIWEEKLY  THEN PAY_PERIOD_END_DATE END PAY_PERIOD_END_DATE
	  ,CASE WHEN HOURS_SERVED_EXEC_OPS_HOURS > HRS_GOAL_BIWEEKLY  THEN PAY_PERIOD_CHECK_DATE END PAY_PERIOD_CHECK_DATE
	  ,CASE WHEN HOURS_SERVED_EXEC_OPS_HOURS > HRS_GOAL_BIWEEKLY  THEN HOURS_SERVED_EXEC_OPS_HOURS END HOURS_SERVED
FROM REPORT.STEP_INCENTIVE 
ORDER BY REGION,STEP;
SQL
	or_replace = true 
	is_secure = false 
}

