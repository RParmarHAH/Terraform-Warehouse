resource "snowflake_view" "DW_REPORT_VW_SLT_DASHBOARD_SCHEDULED_HOURS_DAILY" {
	database = "DW_${var.SF_ENVIRONMENT}"
	schema = "REPORT"
	name = "VW_SLT_DASHBOARD_SCHEDULED_HOURS_DAILY"
	statement = <<-SQL
	 
  SELECT VISIT_KEY, BRANCH_KEY, CLIENT_KEY, CONTRACT_KEY, EMPLOYEE_KEY,SUPERVISOR_KEY, REPORT_DATE, SYSTEM_CODE, BRANCH_NAME,
  SUM(SCHEDULE_DURATION) AS SCHEDULED_HOURS_ALL
  FROM DW_${var.SF_ENVIRONMENT}.HAH.FACT_EVV_VISIT
  WHERE REPORT_DATE >= '2020-01-01'
  AND STATUS_DESCRIPTION != 'Cancelled'
  GROUP BY 1,2,3,4,5,6,7,8,9;
SQL
	or_replace = true 
	is_secure = false 
}

