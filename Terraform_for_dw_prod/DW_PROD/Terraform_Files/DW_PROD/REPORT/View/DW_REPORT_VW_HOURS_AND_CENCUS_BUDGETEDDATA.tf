resource "snowflake_view" "DW_REPORT_VW_HOURS_AND_CENCUS_BUDGETEDDATA" {
	database = "DW_${var.SF_ENVIRONMENT}"
	schema = "REPORT"
	name = "VW_HOURS_AND_CENCUS_BUDGETEDDATA"
	statement = <<-SQL
	 WITH BUDGETEDDATA AS (	
	SELECT CALENDAR_DATE AS MONTH, STATE_CODE AS OFFICE_STATE_CODE, OFFICE_NUMBER, BRANCH_KEY, SERVICE_LINE_CODE AS SERVICELINE,
		CLIENT_COUNT_BUDGETED_MONTHLY AS BUDGETEDCLIENTS,
		HOURS_BUDGETED_MONTHLY AS BUDGETEDHOURS,CAREGIVER_COUNT_BUDGETED_MONTHLY  AS BUDGETEDCAREGIVERS
	FROM INTEGRATION.FACT_BUDGET_MERGED 
	WHERE DAY(CALENDAR_DATE) = 1
)
	SELECT *
	FROM BUDGETEDDATA;
SQL
	or_replace = true 
	is_secure = false 
}

