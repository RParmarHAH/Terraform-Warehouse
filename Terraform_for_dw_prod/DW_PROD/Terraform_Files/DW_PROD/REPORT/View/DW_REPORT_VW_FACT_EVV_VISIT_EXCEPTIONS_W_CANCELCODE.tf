resource "snowflake_view" "DW_REPORT_VW_FACT_EVV_VISIT_EXCEPTIONS_W_CANCELCODE" {
	database = "DW_${var.SF_ENVIRONMENT}"
	schema = "REPORT"
	name = "VW_FACT_EVV_VISIT_EXCEPTIONS_W_CANCELCODE"
	statement = <<-SQL
	 SELECT E.*,V.CANCEL_REASON_CODE ,V.CANCEL_REASON_DESCRIPTION ,V.CANCEL_REASON_NOTES 
FROM DW_${var.SF_ENVIRONMENT}.HAH.FACT_EVV_VISIT_EXCEPTIONS_NEW E 
JOIN DW_${var.SF_ENVIRONMENT}.HAH.FACT_EVV_VISIT V ON E.VISIT_KEY = V.VISIT_KEY;
SQL
	or_replace = true 
	is_secure = false 
}

