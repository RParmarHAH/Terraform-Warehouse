resource "snowflake_view" "DW_REPORT_VW_EXECUTIVE_OPERATIONS_EXCELLENCE_OVERTIME" {
	database = "DW_${var.SF_ENVIRONMENT}"
	schema = "REPORT"
	name = "VW_EXECUTIVE_OPERATIONS_EXCELLENCE_OVERTIME"
	statement = <<-SQL
	 
SELECT
CLIENT_KEY ,
SERVICE_MONTH,
O.BRANCH_KEY,
O.CONTRACT_KEY,
EMPLOYEE_KEY, 
SUPERVISOR_KEY ,
PAYROLL_SERVICE_HOURS, 
OVERTIME_HOURS, 
OVERTIME_PAY_AMOUNT
FROM REPORT.OVERTIME_2 O
JOIN REPORT.VW_DASHBOARD_CONTRACTS DC ON O.CONTRACT_KEY=DC.CONTRACT_KEY
        AND DC.INCLUDE_FOR_EXEC_OPS_CLIENTS=1
WHERE SERVICE_MONTH BETWEEN DATE_TRUNC('YEAR',DATEADD('YEAR',-2,CURRENT_DATE())) AND CURRENT_DATE;
SQL
	or_replace = true 
	is_secure = false 
}

