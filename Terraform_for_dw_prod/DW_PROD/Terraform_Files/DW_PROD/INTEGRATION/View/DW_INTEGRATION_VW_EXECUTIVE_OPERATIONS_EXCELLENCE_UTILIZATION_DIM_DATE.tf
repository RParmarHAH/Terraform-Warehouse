resource "snowflake_view" "DW_INTEGRATION_VW_EXECUTIVE_OPERATIONS_EXCELLENCE_UTILIZATION_DIM_DATE" {
	database = "DW_${var.SF_ENVIRONMENT}"
	schema = "INTEGRATION"
	name = "VW_EXECUTIVE_OPERATIONS_EXCELLENCE_UTILIZATION_DIM_DATE"
	statement = <<-SQL
	 	SELECT DISTINCT FIRST_DAY_OF_MONTH, CONCAT(MONTH_NAME, ' ', "YEAR") PERIOD_NAME
	FROM HAH.DIM_DATE 
	WHERE FIRST_DAY_OF_MONTH BETWEEN DATE_TRUNC(MONTH, DATEADD(YEAR, -2, CURRENT_DATE())) AND DATE_TRUNC(MONTH, DATEADD(MONTH, 2, CURRENT_DATE()));
SQL
	or_replace = true 
	is_secure = false 
}

