resource "snowflake_view" "DW_INTEGRATION_VW_DIM_EMPLOYEE_AL" {
	database = "DW_${var.SF_ENVIRONMENT}"
	schema = "INTEGRATION"
	name = "VW_DIM_EMPLOYEE_AL"
	statement = <<-SQL
	 
select TRIM(EMPLOYEE_KEY) ID,TRIM(EMPLOYEE_ID) EMPLOYEE_ID,TRIM(SYSTEM_CODE) SYSTEM_CODE,TRIM(SOURCE_SYSTEM_ID) SOURCE_SYSTEM_ID,TRIM(EMPLOYEE_PID) EMPLOYEE_PID,TRIM(EMPLOYEE_DOB) EMPLOYEE_DOB,TRIM(EMPLOYEE_FIRST_NAME)EMPLOYEE_FIRST_NAME,TRIM(EMPLOYEE_LAST_NAME) EMPLOYEE_LAST_NAME,TRIM(EMPLOYEE_ADDRESS1) EMPLOYEE_ADDRESS1,TRIM(EMPLOYEE_CITY) EMPLOYEE_CITY,regexp_replace( coalesce(EMPLOYEE_HOME_PHONE,EMPLOYEE_CELL_PHONE),'\\\\(|\\\\)|\\\\-|\\\\ ','') EMPLOYEE_HOME_PHONE,EMPLOYEE_PERSONAL_EMAIL,TRIM(LINKED_ID_source) LINKED_ID_source ,TRIM(LINKED_ID_match) LINKED_ID_match  from ( select CASE WHEN split_part(LINKED_ID::varchar,'-',2) = 'SHC' THEN 'SHC_SAVANNAH'             WHEN split_part(LINKED_ID::varchar,'-',2) = 'AL' THEN 'AL'            WHEN split_part(LINKED_ID::varchar,'-',2) = 'IL' THEN 'IL' END            as LINKED_ID_SOURCE,   split_part(LINKED_ID::varchar,'-',3) as LINKED_ID_MATCH,            * from DW_${var.SF_ENVIRONMENT}.HAH.DIM_EMPLOYEE             WHERE (SOURCE_SYSTEM_ID =9 AND SYSTEM_CODE ='ALABAMA (3554)')             union      select system_code as LINKED_ID_source, PAYROLL_ID::varchar as LINKED_ID_match,* from DW_${var.SF_ENVIRONMENT}.HAH.DIM_EMPLOYEE WHERE (SOURCE_SYSTEM_ID =3 AND SYSTEM_CODE ='AL'));
SQL
	or_replace = true 
	is_secure = false 
}

