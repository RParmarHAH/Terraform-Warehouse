CREATE OR REPLACE PROCEDURE DW_PROD.HAH.MERGE_STAGE_OSHAH_DIM_SERVICES_1_0()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
BEGIN 
MERGE INTO DW_PROD.HAH.DIM_SERVICES_1_0 AS tgt
USING DW_PROD.STAGE.OSHAH_DIM_SERVICES_1_0 AS src
ON tgt.SERVICE_KEY=src.SERVICE_KEY
WHEN MATCHED THEN 
UPDATE SET
	 tgt.SYSTEM_CODE=src.SYSTEM_CODE
	,tgt.SOURCE_SYSTEM_ID=src.SOURCE_SYSTEM_ID
	,tgt.SERVICE_CODE_ID=src.SERVICE_CODE_ID
	,tgt."NAME"=src."NAME"
	,tgt.BILL_CODE_ID=src.BILL_CODE_ID
	,tgt.IS_EXPENSE=src.IS_EXPENSE
	,tgt.IS_MULTIPLE=src.IS_MULTIPLE
	,tgt.OTHER_CODE=src.OTHER_CODE
	,tgt.DEFAULT_COST=src.DEFAULT_COST
	,tgt.DEFAULT_PAY_UNIT_FLAG=src.DEFAULT_PAY_UNIT_FLAG
	,tgt.DEFAULT_BILL_UNIT_FLAG=src.DEFAULT_BILL_UNIT_FLAG
	,tgt.CATEGORY_ID=src.CATEGORY_ID
	,tgt.PAYROLL_CODE=src.PAYROLL_CODE
	,tgt.DEFAULT_REIMBURSMENT=src.DEFAULT_REIMBURSMENT
	,tgt.WC=src.WC
	,tgt.SHIFT_PAY=src.SHIFT_PAY
	,tgt.OT_PAY=src.OT_PAY
	,tgt.BILL_EXCLUDE_HOLIDAY=src.BILL_EXCLUDE_HOLIDAY
	,tgt.PAY_EXCLUDED_HOLIDAY=src.PAY_EXCLUDED_HOLIDAY
	,tgt.IS_CAT=src.IS_CAT
	,tgt.COMMISSION_RATE=src.COMMISSION_RATE
	,tgt.BONUS_POINTS=src.BONUS_POINTS
	,tgt.ACTIVE=src.ACTIVE
	,tgt.REVENUE_CODE=src.REVENUE_CODE
	,tgt.PAY=src.PAY
	,tgt.POC_FIRST_BIL_LABLE_FLAG=src.POC_FIRST_BIL_LABLE_FLAG
	,tgt.EXPENCE_TYPE_ID=src.EXPENCE_TYPE_ID
	,tgt.CREATED_DATE=src.CREATED_DATE
	,tgt.CREATED_USER=src.CREATED_USER
	,tgt.MODIFIED_DATE=src.MODIFIED_DATE
	,tgt.MODIFIED_USER=src.MODIFIED_USER
	,tgt."TS"=src."TS"
	,tgt.LIST_ITEM_TYPE=src.LIST_ITEM_TYPE
	,tgt.RPT_GROUP_ID=src.RPT_GROUP_ID
	,tgt.BRANCH_ID=src.BRANCH_ID
	,tgt.OVERRIDE_ID=src.OVERRIDE_ID
	,tgt.DESCRIPTION=src.DESCRIPTION
	,tgt.TAX_GROUP_ID=src.TAX_GROUP_ID
	,tgt.LEGACY_ID=src.LEGACY_ID
	,tgt.LEGACY_BRANCH_ID=src.LEGACY_BRANCH_ID
	,tgt.ACCT_ID=src.ACCT_ID
	,tgt.UPLOAD_TELEPHONY=src.UPLOAD_TELEPHONY
	,tgt.TELEPHONY_TASK_ID=src.TELEPHONY_TASK_ID
	,tgt.INCLUDE_EFT=src.INCLUDE_EFT
	,tgt.PROJECTED_AVG_BILL_VISIT=src.PROJECTED_AVG_BILL_VISIT
	,tgt.PROJECTED_AVG_PAY_VISIT=src.PROJECTED_AVG_PAY_VISIT
	,tgt.PROJECTED_AVG_PAY_HOURLY=src.PROJECTED_AVG_PAY_HOURLY
	,tgt.PROJECTED_AVG_BILL_HOURLY=src.PROJECTED_AVG_BILL_HOURLY
	,tgt.IS_COPY=src.IS_COPY
	,tgt.IS_WORKING=src.IS_WORKING
	,tgt.DEDUCTE_ARN=src.DEDUCTE_ARN
	,tgt.LIVE_IN_RPT_HRS=src.LIVE_IN_RPT_HRS
	,tgt.ACCT_CODE=src.ACCT_CODE
	,tgt.DISPLAY_ON_CLIENT_PORTAL=src.DISPLAY_ON_CLIENT_PORTAL
	,tgt.DISPLAY_ON_CAREGIVER_PORTAL=src.DISPLAY_ON_CAREGIVER_PORTAL
	,tgt.THERAPY_COUNTING_TYPE=src.THERAPY_COUNTING_TYPE
	,tgt.MEDICARE_DISCIPLINE=src.MEDICARE_DISCIPLINE
	,tgt.DOC_TYPE=src.DOC_TYPE
	,tgt.IS_MULTIPLE_SERVICE=src.IS_MULTIPLE_SERVICE
	,tgt.INSERT_DATE=src.INSERT_DATE
	,tgt.UPDATE_DATE=src.UPDATE_DATE
	,tgt.DELETED_FLAG=src.DELETED_FLAG
	,tgt.SYS_CHANGE_VERSION=src.SYS_CHANGE_VERSION
	,tgt.SYS_CHANGE_OPERATION=src.SYS_CHANGE_OPERATION
	,tgt.REVENUE_CATEGORY=src.REVENUE_CATEGORY
	,tgt.REVENUE_SUBCATEGORY_CODE=src.REVENUE_SUBCATEGORY_CODE
	,tgt.REVENUE_CATEGORY_NAME=src.REVENUE_CATEGORY_NAME
	,tgt.ETL_TASK_KEY=src.ETL_TASK_KEY
	,tgt.ETL_INSERTED_TASK_KEY=src.ETL_INSERTED_TASK_KEY
	,tgt.ETL_INSERTED_DATE=src.ETL_INSERTED_DATE
	,tgt.ETL_INSERTED_BY=src.ETL_INSERTED_BY
	,tgt.ETL_LAST_UPDATED_DATE=src.ETL_LAST_UPDATED_DATE
	,tgt.ETL_LAST_UPDATED_BY=src.ETL_LAST_UPDATED_BY
	,tgt.ETL_DELETED_FLAG=src.ETL_DELETED_FLAG
	,tgt.ETL_INFERRED_MEMBER_FLAG=src.ETL_INFERRED_MEMBER_FLAG	
WHEN NOT MATCHED
THEN INSERT (
	SERVICE_KEY
	,SYSTEM_CODE
	,SOURCE_SYSTEM_ID
	,SERVICE_CODE_ID
	,"NAME"
	,BILL_CODE_ID
	,IS_EXPENSE
	,IS_MULTIPLE
	,OTHER_CODE
	,DEFAULT_COST
	,DEFAULT_PAY_UNIT_FLAG
	,DEFAULT_BILL_UNIT_FLAG
	,CATEGORY_ID
	,PAYROLL_CODE
	,DEFAULT_REIMBURSMENT
	,WC
	,SHIFT_PAY
	,OT_PAY
	,BILL_EXCLUDE_HOLIDAY
	,PAY_EXCLUDED_HOLIDAY
	,IS_CAT
	,COMMISSION_RATE
	,BONUS_POINTS
	,ACTIVE
	,REVENUE_CODE
	,PAY
	,POC_FIRST_BIL_LABLE_FLAG
	,EXPENCE_TYPE_ID
	,CREATED_DATE
	,CREATED_USER
	,MODIFIED_DATE
	,MODIFIED_USER
	,"TS"
	,LIST_ITEM_TYPE
	,RPT_GROUP_ID
	,BRANCH_ID
	,OVERRIDE_ID
	,DESCRIPTION
	,TAX_GROUP_ID
	,LEGACY_ID
	,LEGACY_BRANCH_ID
	,ACCT_ID
	,UPLOAD_TELEPHONY
	,TELEPHONY_TASK_ID
	,INCLUDE_EFT
	,PROJECTED_AVG_BILL_VISIT
	,PROJECTED_AVG_PAY_VISIT
	,PROJECTED_AVG_PAY_HOURLY
	,PROJECTED_AVG_BILL_HOURLY
	,IS_COPY
	,IS_WORKING
	,DEDUCTE_ARN
	,LIVE_IN_RPT_HRS
	,ACCT_CODE
	,DISPLAY_ON_CLIENT_PORTAL
	,DISPLAY_ON_CAREGIVER_PORTAL
	,THERAPY_COUNTING_TYPE
	,MEDICARE_DISCIPLINE
	,DOC_TYPE
	,IS_MULTIPLE_SERVICE
	,INSERT_DATE
	,UPDATE_DATE
	,DELETED_FLAG
	,SYS_CHANGE_VERSION
	,SYS_CHANGE_OPERATION
	,REVENUE_CATEGORY
	,REVENUE_SUBCATEGORY_CODE
	,REVENUE_CATEGORY_NAME
	,ETL_TASK_KEY
	,ETL_INSERTED_TASK_KEY
	,ETL_INSERTED_DATE
	,ETL_INSERTED_BY
	,ETL_LAST_UPDATED_DATE
	,ETL_LAST_UPDATED_BY
	,ETL_DELETED_FLAG
	,ETL_INFERRED_MEMBER_FLAG)	
VALUES (
	src.SERVICE_KEY
	,src.SYSTEM_CODE
	,src.SOURCE_SYSTEM_ID
	,src.SERVICE_CODE_ID
	,src."NAME"
	,src.BILL_CODE_ID
	,src.IS_EXPENSE
	,src.IS_MULTIPLE
	,src.OTHER_CODE
	,src.DEFAULT_COST
	,src.DEFAULT_PAY_UNIT_FLAG
	,src.DEFAULT_BILL_UNIT_FLAG
	,src.CATEGORY_ID
	,src.PAYROLL_CODE
	,src.DEFAULT_REIMBURSMENT
	,src.WC
	,src.SHIFT_PAY
	,src.OT_PAY
	,src.BILL_EXCLUDE_HOLIDAY
	,src.PAY_EXCLUDED_HOLIDAY
	,src.IS_CAT
	,src.COMMISSION_RATE
	,src.BONUS_POINTS
	,src.ACTIVE
	,src.REVENUE_CODE
	,src.PAY
	,src.POC_FIRST_BIL_LABLE_FLAG
	,src.EXPENCE_TYPE_ID
	,src.CREATED_DATE
	,src.CREATED_USER
	,src.MODIFIED_DATE
	,src.MODIFIED_USER
	,src."TS"
	,src.LIST_ITEM_TYPE
	,src.RPT_GROUP_ID
	,src.BRANCH_ID
	,src.OVERRIDE_ID
	,src.DESCRIPTION
	,src.TAX_GROUP_ID
	,src.LEGACY_ID
	,src.LEGACY_BRANCH_ID
	,src.ACCT_ID
	,src.UPLOAD_TELEPHONY
	,src.TELEPHONY_TASK_ID
	,src.INCLUDE_EFT
	,src.PROJECTED_AVG_BILL_VISIT
	,src.PROJECTED_AVG_PAY_VISIT
	,src.PROJECTED_AVG_PAY_HOURLY
	,src.PROJECTED_AVG_BILL_HOURLY
	,src.IS_COPY
	,src.IS_WORKING
	,src.DEDUCTE_ARN
	,src.LIVE_IN_RPT_HRS
	,src.ACCT_CODE
	,src.DISPLAY_ON_CLIENT_PORTAL
	,src.DISPLAY_ON_CAREGIVER_PORTAL
	,src.THERAPY_COUNTING_TYPE
	,src.MEDICARE_DISCIPLINE
	,src.DOC_TYPE
	,src.IS_MULTIPLE_SERVICE
	,src.INSERT_DATE
	,src.UPDATE_DATE
	,src.DELETED_FLAG
	,src.SYS_CHANGE_VERSION
	,src.SYS_CHANGE_OPERATION
	,src.REVENUE_CATEGORY
	,src.REVENUE_SUBCATEGORY_CODE
	,src.REVENUE_CATEGORY_NAME
	,src.ETL_TASK_KEY
	,src.ETL_INSERTED_TASK_KEY
	,src.ETL_INSERTED_DATE
	,src.ETL_INSERTED_BY
	,src.ETL_LAST_UPDATED_DATE
	,src.ETL_LAST_UPDATED_BY
	,src.ETL_DELETED_FLAG
	,src.ETL_INFERRED_MEMBER_FLAG);
RETURN ''Success'';
END;
';