CREATE OR REPLACE PROCEDURE DW_PROD.HAH.MERGE_STAGE_OSHAH_DIM_VISIT_STATUS_MAPPING()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
	RETURN_RESULT VARCHAR;
BEGIN 
MERGE INTO DW_PROD.HAH.DIM_VISIT_STATUS_MAPPING AS tgt
USING DW_PROD."STAGE".OSHAH_DIM_VISIT_STATUS_MAPPING  AS src
ON  TGT.VISIT_STATUS_KEY = src.VISIT_STATUS_KEY
WHEN MATCHED THEN UPDATE SET
	 tgt.VISIT_STATUS_KEY=src.VISIT_STATUS_KEY, 
	 tgt.SOURCE_SYSTEM_ID=src.SOURCE_SYSTEM_ID, 
	 tgt.SYSTEM_CODE=src.SYSTEM_CODE, 
	 tgt.DERIVED_DISC_STATUS=src.DERIVED_DISC_STATUS, 
	 tgt.DISC_SCHEDULE_STATUS=src.DISC_SCHEDULE_STATUS, 
	 tgt.DISC_VISIT_STATUS=src.DISC_VISIT_STATUS, 
	 tgt.DISC_INVOICE_STATUS=src.DISC_INVOICE_STATUS, 
	 tgt.DISC_PAYROLL_STATUS=src.DISC_PAYROLL_STATUS, 
	 tgt.SCHEDULE_STATUS_CODE=src.SCHEDULE_STATUS_CODE, 
	 tgt.SCHEDULE_STATUS_NAME=src.SCHEDULE_STATUS_NAME, 
	 tgt.SCHEDULE_STATUS_DESCRIPTION=src.SCHEDULE_STATUS_DESCRIPTION, 
	 tgt.VISIT_STATUS_CODE=src.VISIT_STATUS_CODE, 
	 tgt.VISIT_STATUS_NAME=src.VISIT_STATUS_NAME, 
	 tgt.VISIT_STATUS_DESCRIPTION=src.VISIT_STATUS_DESCRIPTION, 
	 tgt.INVOICE_STATUS_CODE=src.INVOICE_STATUS_CODE, 
	 tgt.INVOICE_STATUS_NAME=src.INVOICE_STATUS_NAME, 
	 tgt.INVOICE_STATUS_DESCRIPTION=src.INVOICE_STATUS_DESCRIPTION, 
	 tgt.PAYROLL_STATUS_CODE=src.PAYROLL_STATUS_CODE, 
	 tgt.PAYROLL_STATUS_NAME=src.PAYROLL_STATUS_NAME, 
	 tgt.PAYROLL_STATUS_DESCRIPTION=src.PAYROLL_STATUS_DESCRIPTION, 
	 tgt.CONFIRMED_FLAG=src.CONFIRMED_FLAG, 
	 tgt.CONSISTENT_FLAG=src.CONSISTENT_FLAG
WHEN NOT MATCHED THEN INSERT (
	 VISIT_STATUS_KEY, 
	 SOURCE_SYSTEM_ID, 
	 SYSTEM_CODE, 
	 DERIVED_DISC_STATUS, 
	 DISC_SCHEDULE_STATUS, 
	 DISC_VISIT_STATUS, 
	 DISC_INVOICE_STATUS, 
	 DISC_PAYROLL_STATUS, 
	 SCHEDULE_STATUS_CODE, 
	 SCHEDULE_STATUS_NAME, 
	 SCHEDULE_STATUS_DESCRIPTION, 
	 VISIT_STATUS_CODE, 
	 VISIT_STATUS_NAME, 
	 VISIT_STATUS_DESCRIPTION, 
	 INVOICE_STATUS_CODE, 
	 INVOICE_STATUS_NAME, 
	 INVOICE_STATUS_DESCRIPTION, 
	 PAYROLL_STATUS_CODE, 
	 PAYROLL_STATUS_NAME, 
	 PAYROLL_STATUS_DESCRIPTION, 
	 CONFIRMED_FLAG, 
	 CONSISTENT_FLAG)
VALUES (
	src.VISIT_STATUS_KEY, 
	src.SOURCE_SYSTEM_ID, 
	src.SYSTEM_CODE, 
	src.DERIVED_DISC_STATUS, 
	src.DISC_SCHEDULE_STATUS, 
	src.DISC_VISIT_STATUS, 
	src.DISC_INVOICE_STATUS, 
	src.DISC_PAYROLL_STATUS, 
	src.SCHEDULE_STATUS_CODE, 
	src.SCHEDULE_STATUS_NAME, 
	src.SCHEDULE_STATUS_DESCRIPTION, 
	src.VISIT_STATUS_CODE, 
	src.VISIT_STATUS_NAME, 
	src.VISIT_STATUS_DESCRIPTION, 
	src.INVOICE_STATUS_CODE, 
	src.INVOICE_STATUS_NAME, 
	src.INVOICE_STATUS_DESCRIPTION, 
	src.PAYROLL_STATUS_CODE, 
	src.PAYROLL_STATUS_NAME, 
	src.PAYROLL_STATUS_DESCRIPTION, 
	src.CONFIRMED_FLAG, 
	src.CONSISTENT_FLAG);
SELECT CONCAT(''Message : '',"number of rows inserted", '' Rows Insrted & '' ,"number of rows updated",'' Rows Updated.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
return return_result;
END;
';