CREATE OR REPLACE PROCEDURE DW_PROD.HAH.DELETE_STAGE_VIVENTIUM_FACT_PAYROLL()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
BEGIN
    DELETE FROM HAH.FACT_PAYROLL WHERE SOURCE_SYSTEM_ID = 34 AND PAYROLL_KEY
    NOT IN (SELECT PAYROLL_KEY FROM STAGE.VIVENTIUM_FACT_PAYROLL);

 return ''Done'';
END;
 
';