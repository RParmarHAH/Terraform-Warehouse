CREATE OR REPLACE PROCEDURE DW_PROD.HAH.MERGE_STAGE_PAYOR_CONTRACT_UI_DIM_PARTNER_CONTRACT()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
DECLARE
    RETURN_RESULT VARCHAR;
BEGIN
MERGE INTO DW_PROD.HAH.DIM_PARTNER_CONTRACT AS tgt
USING DW_PROD.STAGE.PAYOR_CONTRACT_UI_DIM_PARTNER_CONTRACT AS src
ON tgt.PARTNER_CONTRACT_KEY=src.PARTNER_CONTRACT_KEY
WHEN MATCHED
THEN UPDATE SET
tgt.SOURCE_SYSTEM_ID=src.SOURCE_SYSTEM_ID
,tgt.SYSTEM_CODE=src.SYSTEM_CODE
,tgt.ORIGINAL_SOURCE_SYSTEM_ID=src.ORIGINAL_SOURCE_SYSTEM_ID
,tgt.ORIGINAL_SYSTEM_CODE=src.ORIGINAL_SYSTEM_CODE
,tgt.PARTNER_KEY=src.PARTNER_KEY
,tgt.PARTNER_CODE=src.PARTNER_CODE
,tgt.PARTNER_NAME=src.PARTNER_NAME
,tgt.CONTRACT_CODE=src.CONTRACT_CODE
,tgt.CONTRACT_NAME=src.CONTRACT_NAME
,tgt.ACTIVE_FLAG=src.ACTIVE_FLAG
,tgt.START_DATE=src.START_DATE
,tgt.END_DATE=src.END_DATE
,tgt.ETL_TASK_KEY=src.ETL_TASK_KEY
,tgt.ETL_INSERTED_TASK_KEY=src.ETL_INSERTED_TASK_KEY
,tgt.ETL_INSERTED_DATE=src.ETL_INSERTED_DATE
,tgt.ETL_INSERTED_BY=src.ETL_INSERTED_BY
,tgt.ETL_LAST_UPDATED_DATE=src.ETL_LAST_UPDATED_DATE
,tgt.ETL_LAST_UPDATED_BY=src.ETL_LAST_UPDATED_BY
,tgt.ETL_DELETED_FLAG=src.ETL_DELETED_FLAG
WHEN NOT MATCHED
THEN INSERT (tgt.PARTNER_CONTRACT_KEY
	,tgt.SOURCE_SYSTEM_ID
	,tgt.SYSTEM_CODE
	,tgt.ORIGINAL_SOURCE_SYSTEM_ID
	,tgt.ORIGINAL_SYSTEM_CODE
	,tgt.PARTNER_KEY
	,tgt.PARTNER_CODE
	,tgt.PARTNER_NAME
	,tgt.CONTRACT_CODE
	,tgt.CONTRACT_NAME
	,tgt.ACTIVE_FLAG
	,tgt.START_DATE
	,tgt.END_DATE
	,tgt.ETL_TASK_KEY
	,tgt.ETL_INSERTED_TASK_KEY
	,tgt.ETL_INSERTED_DATE
	,tgt.ETL_INSERTED_BY
	,tgt.ETL_LAST_UPDATED_DATE
	,tgt.ETL_LAST_UPDATED_BY
	,ETL_DELETED_FLAG)
VALUES (src.PARTNER_CONTRACT_KEY
	,src.SOURCE_SYSTEM_ID
	,src.SYSTEM_CODE
	,src.ORIGINAL_SOURCE_SYSTEM_ID
	,src.ORIGINAL_SYSTEM_CODE
	,src.PARTNER_KEY
	,src.PARTNER_CODE
	,src.PARTNER_NAME
	,src.CONTRACT_CODE
	,src.CONTRACT_NAME
	,src.ACTIVE_FLAG
	,src.START_DATE
	,src.END_DATE
	,src.ETL_TASK_KEY
	,src.ETL_INSERTED_TASK_KEY
	,src.ETL_INSERTED_DATE
	,src.ETL_INSERTED_BY
	,src.ETL_LAST_UPDATED_DATE
	,src.ETL_LAST_UPDATED_BY
	,src.ETL_DELETED_FLAG);
SELECT CONCAT(''Message : '',"number of rows inserted", '' Rows Inserted & '' ,"number of rows updated",'' Rows Updated.'') into :return_result FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
return return_result;
END;
';