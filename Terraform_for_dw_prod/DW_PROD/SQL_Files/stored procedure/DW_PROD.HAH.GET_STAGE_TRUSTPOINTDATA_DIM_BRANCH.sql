CREATE OR REPLACE PROCEDURE DW_PROD.HAH.GET_STAGE_TRUSTPOINTDATA_DIM_BRANCH("STR_ETL_TASK_KEY" VARCHAR(16777216), "STR_CDC_START" VARCHAR(16777216), "STR_CDC_END" VARCHAR(16777216))
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '

BEGIN

--*****************************************************************************************************************************
-- NAME: TRUSTPOINTDATA_DIM_BRANCH
--
-- PURPOSE: Creates one row for each Branch in Trustpoint
--
-- DEVELOPMENT LOG:
-- DATE				AUTHOR                NOTES:
-- ----------		----------------- 	  -------------------------------------------------------------------------------------        
-- 2023/04/11		Aditya Shukla 		  Updated branches
-- 2023/05/25		Shikhar Saxena		  Changed the logic to add SOURCE_SYSTEM_TYPE field
-- 2023/06/05		Aditya Shukla		  Updated branches
-- 2023/10/31		Dhaval Vachheta		  Updated parent branch name
--*****************************************************************************************************************************
 

INSERT OVERWRITE INTO DW_PROD.STAGE.TRUSTPOINTDATA_DIM_BRANCH

WITH PROSPER AS (
	SELECT 898 AS OFFICE_NUMBER, ''Coastal - Atlanta Northeast'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''COASTAL'' AS SYSTEM_CODE, ''3088 Mercer University Drive'' AS ADDRESS1, ''Suite 100'' AS ADDRESS2, ''30341'' AS ZIP, ''Atlanta'' AS CITY, ''GA'' AS STATE
	UNION
	SELECT 834 AS OFFICE_NUMBER, ''Coastal - Atlanta Central'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''COASTAL'' AS SYSTEM_CODE, ''2970 Clairmont Road'' AS ADDRESS1, NULL AS ADDRESS2, ''30329'' AS ZIP, ''Atlanta'' AS CITY, ''GA'' AS STATE
), 
HAHDELAWARE AS (
	SELECT 561 AS OFFICE_NUMBER, ''HAHDELAWARE - Wilmington'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHDELAWARE'' AS SYSTEM_CODE, ''3 Mill Road'' AS ADDRESS1, ''Suite 303'' AS ADDRESS2, ''19806'' AS ZIP, ''Wilmington'' AS CITY, ''DE'' AS STATE
)
, EXCEL AS (
	SELECT 519 AS OFFICE_NUMBER, ''Excel - HHAX Dubois'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''51 Delaware Street'' AS ADDRESS1, NULL AS ADDRESS2, ''15801'' AS ZIP, ''DuBois'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 524 AS OFFICE_NUMBER, ''Excel - HHAX New Castle'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''119 East North Street'' AS ADDRESS1, NULL AS ADDRESS2, ''16101'' AS ZIP, ''New Castle'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT -1 AS OFFICE_NUMBER, ''Excel - North Philadelphia'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''8485'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	UNION
	SELECT -1 AS OFFICE_NUMBER, ''Excel - Warrington'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''8485'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
--	UNION
--	SELECT 520 AS OFFICE_NUMBER, ''Excel - HHAX Allentown'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE
	UNION
	SELECT 521 AS OFFICE_NUMBER, ''Excel - HHAX Harrisburg'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''2001 North Front Street'' AS ADDRESS1, ''Building 1, Suite 212'' AS ADDRESS2, ''17102'' AS ZIP, ''Harrisburg'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 522 AS OFFICE_NUMBER, ''Excel - HHAX Horsham'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''400 Horsham Road'' AS ADDRESS1, ''Suite 130'' AS ADDRESS2, ''19044'' AS ZIP, ''Horsham'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 523 AS OFFICE_NUMBER, ''Excel - HHAX Lancaster'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''600F Eden Road'' AS ADDRESS1, NULL AS ADDRESS2, ''17601'' AS ZIP, ''Lancaster'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 525 AS OFFICE_NUMBER, ''Excel - HHAX Philadelphia'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''1500 Spring Garden Street'' AS ADDRESS1, ''6th Floor'' AS ADDRESS2, ''19130'' AS ZIP, ''Philadelphia'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 526 AS OFFICE_NUMBER, ''Excel - HHAX Pittsburgh'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''907 West Street'' AS ADDRESS1, ''Suite 111'' AS ADDRESS2, ''15221'' AS ZIP, ''Pittsburgh'' AS CITY, ''PA'' AS STATE
--	UNION
--	SELECT 527 AS OFFICE_NUMBER, ''Excel - Philadelphia'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE
	UNION
	SELECT 527 AS OFFICE_NUMBER, ''Excel - HHAX Reading'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''147 North 5th Street'' AS ADDRESS1, NULL AS ADDRESS2, ''19601'' AS ZIP, ''Reading'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 528 AS OFFICE_NUMBER, ''Excel - HHAX Scranton'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''614 Wyoming Avenue'' AS ADDRESS1, ''Suite 1'' AS ADDRESS2, ''18509'' AS ZIP, ''Scranton'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 530 AS OFFICE_NUMBER, ''Excel - HHAX Williamsport'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''353 Pine Street'' AS ADDRESS1, ''Suite 4'' AS ADDRESS2, ''17701'' AS ZIP, ''Williamsport'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 537 AS OFFICE_NUMBER, ''Excel - OSH Pittsburgh North'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''200 Northpointe Circle'' AS ADDRESS1, ''Suite 203'' AS ADDRESS2, ''16046'' AS ZIP, ''Seven Fields'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 541 AS OFFICE_NUMBER, ''Excel - OSH Bethlehem'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''190 Brodhead Road'' AS ADDRESS1, ''Suite 305'' AS ADDRESS2, ''18017'' AS ZIP, ''Bethlehem'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 547 AS OFFICE_NUMBER, ''Excel - HHAX Allentown'' AS BRANCH_NAME, 4 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''190 Brodhead Road'' AS ADDRESS1, ''Suite 305'' AS ADDRESS2, ''18017'' AS ZIP, ''Bethlehem'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 520 AS OFFICE_NUMBER, ''Excel - HHAX Erie'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''1213 Peach Street'' AS ADDRESS1, NULL AS ADDRESS2, ''16501'' AS ZIP, ''Erie'' AS CITY, ''PA'' AS STATE
--	UNION
--	SELECT 503 AS OFFICE_NUMBER, ''Excel - New Castle'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, ''119 East North Street'' AS ADDRESS1, NULL AS ADDRESS2, ''16101'' AS ZIP, ''New Castle'' AS CITY, ''PA'' AS STATE
--	UNION
--	SELECT -1 AS OFFICE_NUMBER, ''Excel - Warren'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, ''PA'' AS STATE
	UNION
	SELECT 529 AS OFFICE_NUMBER, ''Excel - HHAX Warren'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''EXCEL'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, ''PA'' AS STATE
),
E3_BRANCHES AS 
(
	SELECT 1 AS OFFICE_NUMBER, ''E3 - E3 CASE MANAGERS, LLC (OH)'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''E3'' AS SYSTEM_CODE, ''30200 Telegraph Road'' AS ADDRESS1, ''Suite 245'' AS ADDRESS2, ''48025'' AS ZIP, ''Bingham Farms'' AS CITY, NULL AS STATE
	UNION
	SELECT 290 AS OFFICE_NUMBER, ''E3 - CCU IL'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''CARECOORDINATION'' AS SYSTEM_CODE, ''33 South State Street'' AS ADDRESS1, NULL AS ADDRESS2, ''60603'' AS ZIP, ''Chicago'' AS CITY, ''IL'' AS STATE
	UNION
	SELECT 290 AS OFFICE_NUMBER, ''E3 - CCU IN'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''CARECOORDINATION'' AS SYSTEM_CODE, ''33 South State Street'' AS ADDRESS1, NULL AS ADDRESS2, ''60603'' AS ZIP, ''Chicago'' AS CITY, ''IN'' AS STATE
	UNION
	SELECT 290 AS OFFICE_NUMBER, ''E3 - CCU PA'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''CARECOORDINATION'' AS SYSTEM_CODE, ''33 South State Street'' AS ADDRESS1, NULL AS ADDRESS2, ''60603'' AS ZIP, ''Chicago'' AS CITY, ''PA'' AS STATE
	UNION
	SELECT 290 AS OFFICE_NUMBER, ''E3 - CCU Admin'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''CARECOORDINATION'' AS SYSTEM_CODE, ''33 South State Street'' AS ADDRESS1, NULL AS ADDRESS2, ''60603'' AS ZIP, ''Chicago'' AS CITY, ''IL'' AS STATE
),
HAHMI_BRANCHES AS (
	SELECT 836 AS OFFICE_NUMBER, ''E3 - Grandville'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, ''2976 Ivanrest Avenue Southwest'' AS ADDRESS1, ''Suite 230'' AS ADDRESS2, ''49418'' AS ZIP, ''Grandville'' AS CITY, ''MI'' AS STATE
	UNION
	SELECT 835 AS OFFICE_NUMBER, ''E3 - Allegan'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, ''633 114th Avenue'' AS ADDRESS1, ''#1'' AS ADDRESS2, ''49010'' AS ZIP, ''Allegan'' AS CITY, ''MI'' AS STATE
	UNION
	SELECT 75 AS OFFICE_NUMBER, ''E3 - Warren'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, ''30500 Van Dyke Avenue'' AS ADDRESS1, ''Suite 300'' AS ADDRESS2, ''48093'' AS ZIP, ''Warren'' AS CITY, ''MI'' AS STATE
	UNION
	SELECT 71 AS OFFICE_NUMBER, ''E3 - Niles'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, ''1221 South 11th Street'' AS ADDRESS1, NULL AS ADDRESS2, ''49120'' AS ZIP, ''Niles'' AS CITY, ''MI'' AS STATE
	UNION
	SELECT 840 AS OFFICE_NUMBER, ''E3 - St. Joseph'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, ''2520 South Cleveland Avenue'' AS ADDRESS1, NULL AS ADDRESS2, ''49085'' AS ZIP, ''St. Joseph'' AS CITY, ''MI'' AS STATE
	UNION
	SELECT 74 AS OFFICE_NUMBER, ''E3 - Dearborn'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, ''3200 Greenfield Road'' AS ADDRESS1, ''Suite 210'' AS ADDRESS2, ''48120'' AS ZIP, ''Dearborn'' AS CITY, ''MI'' AS STATE
	UNION
	SELECT 837 AS OFFICE_NUMBER, ''E3 - Holland'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, ''529 East 16th Street'' AS ADDRESS1, NULL AS ADDRESS2, ''49423'' AS ZIP, ''Holland'' AS CITY, ''MI'' AS STATE
	UNION
	SELECT 838 AS OFFICE_NUMBER, ''E3 - Muskegon'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, ''427 Seminole Road'' AS ADDRESS1, ''101'' AS ADDRESS2, ''49444'' AS ZIP, ''Norton Shores'' AS CITY, ''MI'' AS STATE
	UNION
	SELECT -1 AS OFFICE_NUMBER, ''E3 - Flint'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''HAHMI'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, ''Flint'' AS CITY, ''MI'' AS STATE
),
ANSWERCARE_NUMBER AS (
	SELECT 111 AS OFFICE_NUMBER, ''EXCEL - CANTON'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''ANSWERCARE'' AS SYSTEM_CODE, ''4150 Belden Village Street Northwest'' AS ADDRESS1, ''STE 307'' AS ADDRESS2, ''44718'' AS ZIP, ''Canton'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 112 AS OFFICE_NUMBER, ''EXCEL - CLEVELAND'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''ANSWERCARE'' AS SYSTEM_CODE, ''3100 East 45th Street'' AS ADDRESS1, ''STE 128'' AS ADDRESS2, ''44127'' AS ZIP, ''Cleveland'' AS CITY, ''OH'' AS STATE
	UNION
	SELECT 113 AS OFFICE_NUMBER, ''EXCEL - YOUNGSTOWN'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''ANSWERCARE'' AS SYSTEM_CODE, ''1920 Churchill Road'' AS ADDRESS1, ''STE 104'' AS ADDRESS2, ''44420'' AS ZIP, ''Girard'' AS CITY, ''OH'' AS STATE
	UNION
	SELECT 114 AS OFFICE_NUMBER, ''EXCEL - TOLEDO'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''ANSWERCARE'' AS SYSTEM_CODE, ''5810 Southwyck Boulevard'' AS ADDRESS1, ''STE 203G'' AS ADDRESS2, ''43614'' AS ZIP, ''Toledo'' AS CITY, ''OH'' AS STATE
)
, ALTRUS_NUMBER AS (
	SELECT ''3253d1859584356980cf52a5bf224aaf'' AS BRANCH_KEY, 953 AS OFFICE_NUMBER, ''COASTAL - CORE ALTRUS'' AS BRANCH_NAME, ''ALT'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''72c7363c54d7ed987cf091457c0d3c8a'' AS BRANCH_KEY, 904 AS OFFICE_NUMBER, ''COASTAL - AUGUSTA'' AS BRANCH_NAME, ''STG'' AS ALTRUS_OFFICE_CODE, 2 AS SOURCE_SYSTEM_ID, ''SHC_SAVANNAH'' AS SYSTEM_CODE
	UNION
	SELECT ''3f6372595be0d72656838cf5bfc34301'' AS BRANCH_KEY, 910 AS OFFICE_NUMBER, ''COASTAL - BRUNSWICK'' AS BRANCH_NAME, ''BRU'' AS ALTRUS_OFFICE_CODE, 2 AS SOURCE_SYSTEM_ID, ''SHC_SAVANNAH'' AS SYSTEM_CODE
	UNION
	SELECT ''bb016e77a747f52022801cb58d057080'' AS BRANCH_KEY, 951 AS OFFICE_NUMBER, ''COASTAL - CAMDEN'' AS BRANCH_NAME, ''CAM'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''6239c791128e4979dd087adbb91c5ad8'' AS BRANCH_KEY, 953 AS OFFICE_NUMBER, ''COASTAL - CORE'' AS BRANCH_NAME, ''COR'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''f61837f15acbcea5c682ff1ff8117407'' AS BRANCH_KEY, 915 AS OFFICE_NUMBER, ''COASTAL - DUBLIN'' AS BRANCH_NAME, ''DUB'' AS ALTRUS_OFFICE_CODE, 2 AS SOURCE_SYSTEM_ID, ''SHC_SAVANNAH'' AS SYSTEM_CODE
	UNION
	SELECT ''ce80abe275fb37180b2e83ab74c1c69a'' AS BRANCH_KEY, 950 AS OFFICE_NUMBER, ''COASTAL - GASKIN'' AS BRANCH_NAME, ''*GA'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''3aa7ddf7081391eddea5075aa43f0da8'' AS BRANCH_KEY, 907 AS OFFICE_NUMBER, ''COASTAL - HINESVILLE'' AS BRANCH_NAME, ''HIN'' AS ALTRUS_OFFICE_CODE, 2 AS SOURCE_SYSTEM_ID, ''SHC_SAVANNAH'' AS SYSTEM_CODE
	UNION
	SELECT ''1fdbfa41398ddc316b9e569e985ecda7'' AS BRANCH_KEY, 950 AS OFFICE_NUMBER, ''COASTAL - MARLOWE'' AS BRANCH_NAME, ''*MA'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''a7ef26814655ba0edb091841b7aabdcb'' AS BRANCH_KEY, 950 AS OFFICE_NUMBER, ''COASTAL - MORRIS'' AS BRANCH_NAME, ''*MO'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''b25921223ce6af73b9edb842c471da52'' AS BRANCH_KEY, 950 AS OFFICE_NUMBER, ''COASTAL - OLD FERRY'' AS BRANCH_NAME, ''*OF'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''7aed917e15c13d9ebb3d988dc8ec5a47'' AS BRANCH_KEY, 953 AS OFFICE_NUMBER, ''COASTAL - ALS'' AS BRANCH_NAME, ''OPA'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE -- ASK
	UNION
	SELECT ''f136830fd5040dc7cdaea5affaa8f9ee'' AS BRANCH_KEY, 950 AS OFFICE_NUMBER, ''COASTAL - PIPPIN'' AS BRANCH_NAME, ''*PI'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''5993aec6fe517b3731b7ab5cb966a6ef'' AS BRANCH_KEY, 950 AS OFFICE_NUMBER, ''COASTAL - RIVER RIDGE'' AS BRANCH_NAME, ''*RR'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''6e3364ec0b8aa040b37f7d2842042d33'' AS BRANCH_KEY, 950 AS OFFICE_NUMBER, ''COASTAL - SHARONDALE'' AS BRANCH_NAME, ''*SH'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''463c481b105e166792d7bd285d63e450'' AS BRANCH_KEY, 951 AS OFFICE_NUMBER, ''COASTAL - TEBEAU'' AS BRANCH_NAME, ''TEB'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''6423f4bf7c296f3aa88bc678bc5d8517'' AS BRANCH_KEY, 951 AS OFFICE_NUMBER, ''COASTAL - WAVERLY'' AS BRANCH_NAME, ''AWV'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
	UNION
	SELECT ''26e0c170ab9178c5ad7dc188111eb6ba'' AS BRANCH_KEY, 951 AS OFFICE_NUMBER, ''COASTAL - WISTERIA'' AS BRANCH_NAME, ''WIS'' AS ALTRUS_OFFICE_CODE, 1 AS SOURCE_SYSTEM_ID, ''SHC_ALTRUS'' AS SYSTEM_CODE
),
OHIO_NUMBER AS 
(
	SELECT 1 AS OFFICE_NUMBER, ''PRIMEHOMECARE - PRIME HHA, LLC (OH)'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	UNION 
	SELECT 100 AS OFFICE_NUMBER, ''PRIMEHOMECARE - CINCINNATI CORPORATE OFFICE'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, ''2775 US Highway 22 & 2,'' AS ADDRESS1, NULL AS ADDRESS2, ''45039'' AS ZIP, ''Maineville'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 107 AS OFFICE_NUMBER, ''PRIMEHOMECARE - COLUMBUS CIRCLEVILLE'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, ''105 Ohio St'' AS ADDRESS1, NULL AS ADDRESS2, ''43113'' AS ZIP, ''Circleville'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 4 AS OFFICE_NUMBER, ''PRIMEHOMECARE - PRIME HOME CARE, LLC (OH)'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	UNION 
	SELECT 103 AS OFFICE_NUMBER, ''PRIMEHOMECARE - COLUMBUS WEST'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, ''132 N. Wilson Rd'' AS ADDRESS1, NULL AS ADDRESS2, ''43204'' AS ZIP, ''Columbus'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 102 AS OFFICE_NUMBER, ''PRIMEHOMECARE - MANSFIELD OFFICE'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	UNION 
	SELECT 101 AS OFFICE_NUMBER, ''PRIMEHOMECARE - COLUMBUS WASHINGTON COURT'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, ''308 Highland Ave'' AS ADDRESS1, ''Suite B'' AS ADDRESS2, ''43160'' AS ZIP, ''Washington Court House'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 102 AS OFFICE_NUMBER, ''PRIMEHOMECARE - COLUMBUS MAIN'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, ''1105 Schrock Rd'' AS ADDRESS1, ''Suite 108'' AS ADDRESS2, ''43229'' AS ZIP, ''Columbus'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 9 AS OFFICE_NUMBER, ''PRIMEHOMECARE -'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	UNION 
	SELECT 104 AS OFFICE_NUMBER, ''PRIMEHOMECARE - DAYTON OFFICE'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, ''7229 Taylorsville Rd'' AS ADDRESS1, ''Suite 120'' AS ADDRESS2, ''45424'' AS ZIP, ''Huber Heights'' AS CITY, ''OH'' AS CITY
	UNION
	SELECT 105 AS OFFICE_NUMBER, ''PRIMEHOMECARE - TOLEDO'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, ''3454 Oak Alley Court'' AS ADDRESS1, ''Suite 500'' AS ADDRESS2, ''43606'' AS ZIP, ''Toledo'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 105 AS OFFICE_NUMBER, ''HHA - TOLEDO'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIMEHHA'' AS SYSTEM_CODE, ''3454 Oak Alley Court'' AS ADDRESS1, ''Suite 500'' AS ADDRESS2, ''43606'' AS ZIP, ''Toledo'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 105 AS OFFICE_NUMBER, ''HHA - CINCINNATI CORPORATE OFFICE'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIMEHHA'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	UNION 
	SELECT 106 AS OFFICE_NUMBER, ''MIDWAY - MANSFIELD OFFICE'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIMEMIDWAY'' AS SYSTEM_CODE, ''1342 W. 4th Street'' AS ADDRESS1, NULL AS ADDRESS2, ''44906'' AS ZIP, ''Mansfield'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 999 AS OFFICE_NUMBER, ''MIDWAY - OH FSC'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIMEMIDWAY'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	UNION 
	SELECT 106 AS OFFICE_NUMBER, ''MIDWAY - PRIME HOMECARE MIDWAY, INC (OH)'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIMEMIDWAY'' AS SYSTEM_CODE, ''1342 W. 4th Street'' AS ADDRESS1, NULL AS ADDRESS2, ''44906'' AS ZIP, ''Mansfield'' AS CITY, ''OH'' AS STATE
	UNION 
	SELECT 999 AS OFFICE_NUMBER, ''Primehomecare - OH FSC'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	UNION 
	SELECT -1 AS OFFICE_NUMBER, ''Primehomecare - Ohio FSC'' AS BRANCH_NAME, 6 AS SOURCE_SYSTEM_ID, ''PRIME'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
),
OFFICE_NUMBER AS
(
	SELECT 801 AS OFFICE_NUMBER, ''COASTAL - SAVANNAH'' AS BRANCH_NAME ,'''' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 802 AS OFFICE_NUMBER, ''COASTAL - BRUNSWICK'' AS BRANCH_NAME ,''BRU'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 803 AS OFFICE_NUMBER, ''COASTAL - STATESBORO'' AS BRANCH_NAME,''STA'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 804 AS OFFICE_NUMBER, ''COASTAL - CORE'' AS BRANCH_NAME,'''' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 805 AS OFFICE_NUMBER, ''COASTAL - PRIVATE DUTY '' AS BRANCH_NAME,'''' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 806 AS OFFICE_NUMBER, ''COASTAL - HINESVILLE'' AS BRANCH_NAME,''HIN'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 807 AS OFFICE_NUMBER, ''COASTAL - ST. MARYS'' AS BRANCH_NAME,''STM'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 809 AS OFFICE_NUMBER, ''BARNESVILLE'' AS BRANCH_NAME,''BAR'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 810 AS OFFICE_NUMBER, ''COASTAL - WAYCROSS'' AS BRANCH_NAME,''WAY'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 811 AS OFFICE_NUMBER, ''SCL CORE(ENP)'' AS BRANCH_NAME,'''' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 812 AS OFFICE_NUMBER, ''COASTAL - CHC CORE'' AS BRANCH_NAME,'''' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 819 AS OFFICE_NUMBER, ''COASTAL - SAVANNAH CORE'' AS BRANCH_NAME,'''' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 820 AS OFFICE_NUMBER, ''COASTAL - SAVANNAH DD'' AS BRANCH_NAME,''PDD'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 822 AS OFFICE_NUMBER, ''COASTAL - AUGUSTA'' AS BRANCH_NAME,''STG'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 823 AS OFFICE_NUMBER, ''COASTAL - COLUMBUS'' AS BRANCH_NAME,''COL'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 824 AS OFFICE_NUMBER, ''COASTAL - ATHENS'' AS BRANCH_NAME,''ATH'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 825 AS OFFICE_NUMBER, ''COASTAL - BAXLEY'' AS BRANCH_NAME,''WSB'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 826 AS OFFICE_NUMBER, ''COASTAL - VALDOSTA'' AS BRANCH_NAME,''WVL'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 827 AS OFFICE_NUMBER, ''COASTAL - POOLER'' AS BRANCH_NAME,''SAP'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 828 AS OFFICE_NUMBER, ''COASTAL - AMERICUS'' AS BRANCH_NAME,''AME'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 829 AS OFFICE_NUMBER, ''COASTAL - MACON'' AS BRANCH_NAME,''MAC'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 830 AS OFFICE_NUMBER, ''COASTAL - NEWNAN'' AS BRANCH_NAME,''NEW'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 831 AS OFFICE_NUMBER, ''COASTAL - AIKEN'' AS BRANCH_NAME,''AIK'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 832 AS OFFICE_NUMBER, ''HARTSVILLE'' AS BRANCH_NAME,'''' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 833 AS OFFICE_NUMBER, ''COASTAL - DUBLIN'' AS BRANCH_NAME,''DUB'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 801 AS OFFICE_NUMBER, ''COASTAL - SCL DIRECT'' AS BRANCH_NAME,''SCLD'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 834 AS OFFICE_NUMBER, ''COASTAL - ATLANTA'' AS BRANCH_NAME,''ATL'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, ''2970 Clairmont Road'' AS ADDRESS1, NULL AS ADDRESS2, ''30329'' AS ZIP, ''Atlanta'' AS CITY, ''GA'' AS STATE
	union
	SELECT -1 AS OFFICE_NUMBER, ''COASTAL - COASTAL (GA)'' AS BRANCH_NAME,''CGA'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT -1 AS OFFICE_NUMBER, ''COASTAL - WISTERIA'' AS BRANCH_NAME,''WIS'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 811 AS OFFICE_NUMBER, ''COASTAL - SCL ADMIN'' AS BRANCH_NAME,''SCLA'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 804 AS OFFICE_NUMBER, ''COASTAL - CORE - RECRUITING'' AS BRANCH_NAME,''CR'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT 812 AS OFFICE_NUMBER, ''COASTAL - CHC CORE - ADMIN FIELD OPS'' AS BRANCH_NAME,''AFO'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT -1 AS OFFICE_NUMBER, ''COASTAL - CORE ALTRUS'' AS BRANCH_NAME,''ALT'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
	union
	SELECT -1 AS OFFICE_NUMBER, ''COASTAL - ALS'' AS BRANCH_NAME,''ALS'' AS CAREVOYANT_OFFICE_CODE,2 AS SOURCE_SYSTEM_ID,''SHC_SAVANNAH'' AS SYSTEM_CODE, NULL AS ADDRESS1, NULL AS ADDRESS2, NULL AS ZIP, NULL AS CITY, NULL AS STATE
),
ALL_BRANCHES AS(
SELECT 
	MD5(''COASTAL'' || ''-'' || O.OFFICE_NUMBER || O.BRANCH_NAME || ''-''   || ''TRUSTPOINTDATA'') AS BRANCH_KEY,          
	UPPER(TRIM(COALESCE(O.BRANCH_NAME, B.BRANCH_NAME))) AS BRANCH_NAME,
	''COASTAL'' AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	COALESCE(O.OFFICE_NUMBER, B.OFFICE_NUMBER,''-1'') AS OFFICE_NUMBER,
	O.OFFICE_NUMBER::STRING AS OFFICE_CODE,--ASK
	UPPER(TRIM(B.OFFICE_NAME)) AS OFFICE_NAME,
	UPPER(TRIM(B.OFFICE_NAME_ALT)) AS OFFICE_NAME_ALT,
	UPPER(TRIM(B.DEPARTMENT_NAME)) AS DEPARTMENT_NAME,
	B.BRANCH_SERVICE_LINE AS BRANCH_SERVICE_LINE,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS PARENT_FLAG,
	MD5(''COASTAL'' || ''-'' || O.OFFICE_NUMBER || O.BRANCH_NAME || ''-''   || ''TRUSTPOINTDATA'') AS PARENT_BRANCH_KEY,
	COALESCE(O.OFFICE_NUMBER, B.OFFICE_NUMBER,''-1'') AS PARENT_OFFICE_NUMBER,  
	O.OFFICE_NUMBER::STRING AS PARENT_OFFICE_CODE,
	COALESCE(B.OFFICE_STATE_CODE, ''GA'') || '' - '' || UPPER(TRIM(COALESCE(O.BRANCH_NAME, B.BRANCH_NAME))) || '' ('' ||  O.OFFICE_NUMBER || '')'' AS PARENT_BRANCH_NAME,
	UPPER(TRIM(COALESCE(O.ADDRESS1, B.OFFICE_ADDRESS1))) AS OFFICE_ADDRESS1,
	UPPER(TRIM(COALESCE(O.ADDRESS2, B.OFFICE_ADDRESS2))) AS OFFICE_ADDRESS2,
	UPPER(TRIM(COALESCE(O.CITY, B.OFFICE_CITY))) AS OFFICE_CITY,
	COALESCE(B.OFFICE_STATE_CODE, ''GA'') AS OFFICE_STATE_CODE,
	B.OFFICE_ZIP AS OFFICE_ZIP,
	B.OFFICE_PHONE AS  OFFICE_PHONE,
	B.OFFICE_TOLL_FREE_PHONE AS OFFICE_TOLL_FREE_PHONE,
	B.OFFICE_FAX AS OFFICE_FAX,
	B.OFFICE_STATE_CODE || '' - '' || UPPER(TRIM(COALESCE(B.BRANCH_NAME,O.BRANCH_NAME))) || '' ('' || O.OFFICE_NUMBER || '')'' AS DETAILED_OFFICE_NAME,
	B.REGION_NUMBER AS REGION_NUMBER,
	B.REGION_NAME AS REGION_NAME,
	B.REGION_MANAGER AS REGION_MANAGER,
	B.REGION_MANAGER_EMPLOYEE_KEY AS REGION_MANAGER_EMPLOYEE_KEY,
	B.SUBREGION_NAME AS SUBREGION_NAME,
	B.PRIMARY_BRANCH_MANAGER_NAME AS PRIMARY_BRANCH_MANAGER_NAME,
	B.PRIMARY_BRANCH_EMAIL AS PRIMARY_BRANCH_EMAIL,
	B.PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	B.SECONDARY_BRANCH_MANAGER_NAME AS SECONDARY_BRANCH_MANAGER_NAME,
	B.SECONDARY_BRANCH_EMAIL AS SECONDARY_BRANCH_EMAIL,
	B.SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	B.RISKCONNECT_NODE_KEY AS RISKCONNECT_NODE_KEY,
	B.RISKCONNECT_NAME AS RISKCONNECT_NAME,
	B.HR_OFFICE_NUMBER AS HR_OFFICE_NUMBER,
	B.HR_OFFICE_NAME AS HR_OFFICE_NAME,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS ACTIVE_FLAG,
	TO_DATE(''1900-01-01'', ''YYYY-MM-DD'') AS EFFECTIVE_FROM_DATE,
	TO_DATE(''9999-12-31'', ''YYYY-MM-DD'') AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG
FROM OFFICE_NUMBER O
LEFT JOIN DW_PROD.HAH.DIM_BRANCH B
	ON UPPER(B.OFFICE_CODE) = UPPER(O.CAREVOYANT_OFFICE_CODE)
	AND B.SOURCE_SYSTEM_ID=O.SOURCE_SYSTEM_ID
	AND UPPER(B.SYSTEM_CODE) = UPPER(O.SYSTEM_CODE)
	AND B.SOURCE_SYSTEM_ID IN (2)
UNION 
SELECT
	MD5(''EXCEL'' || ''-'' || B.OFFICE_CODE  || ''-'' || ''TRUSTPOINTDATA'') AS BRANCH_KEY,
	UPPER(TRIM(B.BRANCH_NAME)) AS BRANCH_NAME,
	''EXCEL'' AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	CASE WHEN B.BRANCH_NAME = ''DUBOIS'' THEN 513 
		WHEN B.BRANCH_NAME = ''LANCASTER'' THEN 512
		WHEN B.BRANCH_NAME = ''WARREN'' THEN 515
		ELSE NVL(B.OFFICE_NUMBER,''-1'') 
	END AS OFFICE_NUMBER,
	B.OFFICE_CODE::STRING AS OFFICE_CODE,--ASK
	UPPER(TRIM(B.OFFICE_NAME)) AS OFFICE_NAME,
	UPPER(TRIM(B.OFFICE_NAME_ALT)) AS OFFICE_NAME_ALT,
	UPPER(TRIM(B.DEPARTMENT_NAME)) AS DEPARTMENT_NAME,
	B.BRANCH_SERVICE_LINE AS BRANCH_SERVICE_LINE,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS PARENT_FLAG,
	MD5(''EXCEL'' || ''-'' || B.OFFICE_CODE || ''-''  || ''TRUSTPOINTDATA'') AS PARENT_BRANCH_KEY,
	NVL(B.OFFICE_NUMBER,''-1'') AS PARENT_OFFICE_NUMBER,
	B.OFFICE_CODE::STRING AS PARENT_OFFICE_CODE,
	B.OFFICE_STATE_CODE || '' - '' || UPPER(TRIM(B.BRANCH_NAME)) || '' ('' ||  B.OFFICE_CODE || '')'' AS PARENT_BRANCH_NAME,
	UPPER(TRIM(B.OFFICE_ADDRESS1))  AS OFFICE_ADDRESS1,
	UPPER(TRIM(B.OFFICE_ADDRESS2)) AS OFFICE_ADDRESS2,
	UPPER(TRIM(B.OFFICE_CITY)) AS OFFICE_CITY,
	B.OFFICE_STATE_CODE AS OFFICE_STATE_CODE,
	B.OFFICE_ZIP AS OFFICE_ZIP,
	B.OFFICE_PHONE AS  OFFICE_PHONE,
	B.OFFICE_TOLL_FREE_PHONE AS OFFICE_TOLL_FREE_PHONE,
	B.OFFICE_FAX AS OFFICE_FAX,                                                
	B.OFFICE_STATE_CODE || '' - '' || UPPER(TRIM(B.BRANCH_NAME)) || '' ('' || B.OFFICE_NUMBER || '')'' AS DETAILED_OFFICE_NAME,
	B.REGION_NUMBER AS REGION_NUMBER,
	B.REGION_NAME AS REGION_NAME,
	B.REGION_MANAGER AS REGION_MANAGER,
	B.REGION_MANAGER_EMPLOYEE_KEY AS REGION_MANAGER_EMPLOYEE_KEY,
	B.SUBREGION_NAME AS SUBREGION_NAME,
	B.PRIMARY_BRANCH_MANAGER_NAME AS PRIMARY_BRANCH_MANAGER_NAME,
	B.PRIMARY_BRANCH_EMAIL AS PRIMARY_BRANCH_EMAIL,
	B.PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	B.SECONDARY_BRANCH_MANAGER_NAME AS SECONDARY_BRANCH_MANAGER_NAME,
	B.SECONDARY_BRANCH_EMAIL AS SECONDARY_BRANCH_EMAIL,
	B.SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	B.RISKCONNECT_NODE_KEY AS RISKCONNECT_NODE_KEY,
	B.RISKCONNECT_NAME AS RISKCONNECT_NAME,
	B.HR_OFFICE_NUMBER AS HR_OFFICE_NUMBER,
	B.HR_OFFICE_NAME AS HR_OFFICE_NAME,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS ACTIVE_FLAG,
	TO_DATE(''1900-01-01'', ''YYYY-MM-DD'') AS EFFECTIVE_FROM_DATE,
	TO_DATE(''9999-12-31'', ''YYYY-MM-DD'') AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG
FROM DW_PROD.HAH.DIM_BRANCH B WHERE SOURCE_SYSTEM_ID IN(4)
UNION
SELECT
	MD5(''PRIME'' || ''-'' || TRIM(OHN.BRANCH_NAME) || OHN.OFFICE_NUMBER || ''-'' || ''TRUSTPOINTDATA'') AS BRANCH_KEY,
	UPPER(TRIM(OHN.BRANCH_NAME)) AS BRANCH_NAME,
	OHN.SYSTEM_CODE AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	OHN.OFFICE_NUMBER AS OFFICE_NUMBER,
	OHN.OFFICE_NUMBER::STRING AS OFFICE_CODE,--ASK
	NULL AS OFFICE_NAME,
	NULL AS OFFICE_NAME_ALT,
	NULL AS DEPARTMENT_NAME,
	NULL AS BRANCH_SERVICE_LINE,
	TRUE AS PARENT_FLAG,
	MD5(''PRIME'' || ''-'' || TRIM(OHN.BRANCH_NAME) || OHN.OFFICE_NUMBER || ''-'' || ''TRUSTPOINTDATA'') AS PARENT_BRANCH_KEY,
	OHN.OFFICE_NUMBER AS PARENT_OFFICE_NUMBER,
	OHN.OFFICE_NUMBER::STRING AS PARENT_OFFICE_CODE,
	COALESCE(OHN.STATE, ''OH'') || '' - '' || UPPER(TRIM(OHN.BRANCH_NAME)) || '' ('' ||  OFFICE_CODE || '')'' AS PARENT_BRANCH_NAME,
	OHN.ADDRESS1 AS OFFICE_ADDRESS1,
	OHN.ADDRESS2 AS OFFICE_ADDRESS2,
	OHN.CITY AS OFFICE_CITY,
	COALESCE(OHN.STATE, ''OH'') AS OFFICE_STATE_CODE,
	OHN.ZIP AS OFFICE_ZIP,
	NULL AS OFFICE_PHONE,
	NULL AS OFFICE_TOLL_FREE_PHONE,
	NULL AS OFFICE_FAX,                                
	NULL AS DETAILED_OFFICE_NAME,
	NULL AS REGION_NUMBER,
	NULL AS REGION_NAME,
	NULL AS REGION_MANAGER,
	NULL AS REGION_MANAGER_EMPLOYEE_KEY,
	NULL AS SUBREGION_NAME,
	NULL AS PRIMARY_BRANCH_MANAGER_NAME,
	NULL AS PRIMARY_BRANCH_EMAIL,
	NULL AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS SECONDARY_BRANCH_MANAGER_NAME,
	NULL AS SECONDARY_BRANCH_EMAIL,
	NULL AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS RISKCONNECT_NODE_KEY,
	NULL AS RISKCONNECT_NAME,
	NULL AS HR_OFFICE_NUMBER,
	NULL AS HR_OFFICE_NAME,
	TRUE AS ACTIVE_FLAG,
	''2021-01-01'' AS EFFECTIVE_FROM_DATE,
	''2021-01-01'' AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG	
FROM OHIO_NUMBER OHN
UNION
SELECT 
	MD5(''ALTRUS'' || ''-'' || ALT.BRANCH_NAME || ALT.OFFICE_NUMBER || ''-''   || ''TRUSTPOINTDATA'') AS BRANCH_KEY,          
	ALT.BRANCH_NAME AS BRANCH_NAME,
	''ALTRUS'' AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	NVL(br.OFFICE_NUMBER,''-1'') AS OFFICE_NUMBER,
	ALT.OFFICE_NUMBER::STRING AS OFFICE_CODE,--ASK
	UPPER(TRIM(br.OFFICE_NAME)) AS OFFICE_NAME,
	UPPER(TRIM(br.OFFICE_NAME_ALT)) AS OFFICE_NAME_ALT,
	UPPER(TRIM(br.DEPARTMENT_NAME)) AS DEPARTMENT_NAME,
	br.BRANCH_SERVICE_LINE AS BRANCH_SERVICE_LINE,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS PARENT_FLAG,
	MD5(''ALTRUS'' || ''-'' || ALT.BRANCH_NAME || ALT.OFFICE_NUMBER || ''-''   || ''TRUSTPOINTDATA'') AS PARENT_BRANCH_KEY,
	NVL(br.OFFICE_NUMBER,''-1'') AS PARENT_OFFICE_NUMBER,
	ALT.OFFICE_NUMBER::STRING AS PARENT_OFFICE_CODE,
	br.OFFICE_STATE_CODE || '' - '' || UPPER(TRIM(COALESCE(br.BRANCH_NAME, ALT.BRANCH_NAME))) || '' ('' ||  ALT.OFFICE_NUMBER || '')'' AS PARENT_BRANCH_NAME,
	UPPER(TRIM(br.OFFICE_ADDRESS1))  AS OFFICE_ADDRESS1,
	UPPER(TRIM(br.OFFICE_ADDRESS2)) AS OFFICE_ADDRESS2,
	UPPER(TRIM(br.OFFICE_CITY)) AS OFFICE_CITY,
	br.OFFICE_STATE_CODE AS OFFICE_STATE_CODE,
	br.OFFICE_ZIP AS OFFICE_ZIP,
	br.OFFICE_PHONE AS  OFFICE_PHONE,
	br.OFFICE_TOLL_FREE_PHONE AS OFFICE_TOLL_FREE_PHONE,
	br.OFFICE_FAX AS OFFICE_FAX,                  
	br.OFFICE_STATE_CODE || '' - '' || UPPER(TRIM(COALESCE(br.BRANCH_NAME, ALT.BRANCH_NAME))) || '' ('' || ALT.OFFICE_NUMBER || '')'' AS DETAILED_OFFICE_NAME,
	br.REGION_NUMBER AS REGION_NUMBER,
	br.REGION_NAME AS REGION_NAME,
	br.REGION_MANAGER AS REGION_MANAGER,
	br.REGION_MANAGER_EMPLOYEE_KEY AS REGION_MANAGER_EMPLOYEE_KEY,
	br.SUBREGION_NAME AS SUBREGION_NAME,
	br.PRIMARY_BRANCH_MANAGER_NAME AS PRIMARY_BRANCH_MANAGER_NAME,
	br.PRIMARY_BRANCH_EMAIL AS PRIMARY_BRANCH_EMAIL,
	br.PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	br.SECONDARY_BRANCH_MANAGER_NAME AS SECONDARY_BRANCH_MANAGER_NAME,
	br.SECONDARY_BRANCH_EMAIL AS SECONDARY_BRANCH_EMAIL,
	br.SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	br.RISKCONNECT_NODE_KEY AS RISKCONNECT_NODE_KEY,
	br.RISKCONNECT_NAME AS RISKCONNECT_NAME,
	br.HR_OFFICE_NUMBER AS HR_OFFICE_NUMBER,
	br.HR_OFFICE_NAME AS HR_OFFICE_NAME,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS ACTIVE_FLAG,
	TO_DATE(''1900-01-01'', ''YYYY-MM-DD'') AS EFFECTIVE_FROM_DATE,
	TO_DATE(''9999-12-31'', ''YYYY-MM-DD'') AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG
FROM ALTRUS_NUMBER ALT
LEFT JOIN DW_PROD.HAH.DIM_BRANCH br
	ON br.BRANCH_KEY = ALT.BRANCH_KEY
	AND UPPER(br.OFFICE_CODE) = UPPER(ALT.ALTRUS_OFFICE_CODE)
	AND br.SOURCE_SYSTEM_ID= ALT.SOURCE_SYSTEM_ID
	AND UPPER(br.SYSTEM_CODE) = UPPER(ALT.SYSTEM_CODE)
UNION
SELECT
	MD5(''ANSWERCARE'' || ''-'' || TRIM(ANS.BRANCH_NAME) || ANS.OFFICE_NUMBER || ''-'' || ''TRUSTPOINTDATA'') AS BRANCH_KEY,
	UPPER(TRIM(ANS.BRANCH_NAME)) AS BRANCH_NAME,
	ANS.SYSTEM_CODE AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	ANS.OFFICE_NUMBER AS OFFICE_NUMBER,
	ANS.OFFICE_NUMBER::STRING AS OFFICE_CODE,--ASK
	NULL AS OFFICE_NAME,
	NULL AS OFFICE_NAME_ALT,
	NULL AS DEPARTMENT_NAME,
	NULL AS BRANCH_SERVICE_LINE,
	TRUE AS PARENT_FLAG,
	MD5(''ANSWERCARE'' || ''-'' || TRIM(ANS.BRANCH_NAME) || ANS.OFFICE_NUMBER || ''-'' || ''TRUSTPOINTDATA'') AS PARENT_BRANCH_KEY,
	ANS.OFFICE_NUMBER AS PARENT_OFFICE_NUMBER,
	ANS.OFFICE_NUMBER::STRING AS PARENT_OFFICE_CODE,
	ANS.STATE || ''-'' || UPPER(TRIM(ANS.BRANCH_NAME)) || '' ('' || OFFICE_CODE || '')'' AS PARENT_BRANCH_NAME,
	ANS.ADDRESS1 AS OFFICE_ADDRESS1,
	ANS.ADDRESS2 AS OFFICE_ADDRESS2,
	ANS.CITY AS OFFICE_CITY,
	ANS.STATE AS OFFICE_STATE_CODE,
	ANS.ZIP AS OFFICE_ZIP,
	NULL AS OFFICE_PHONE,
	NULL AS OFFICE_TOLL_FREE_PHONE,
	NULL AS OFFICE_FAX,                                
	NULL AS DETAILED_OFFICE_NAME,
	NULL AS REGION_NUMBER,
	NULL AS REGION_NAME,
	NULL AS REGION_MANAGER,
	NULL AS REGION_MANAGER_EMPLOYEE_KEY,
	NULL AS SUBREGION_NAME,
	NULL AS PRIMARY_BRANCH_MANAGER_NAME,
	NULL AS PRIMARY_BRANCH_EMAIL,
	NULL AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS SECONDARY_BRANCH_MANAGER_NAME,
	NULL AS SECONDARY_BRANCH_EMAIL,
	NULL AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS RISKCONNECT_NODE_KEY,
	NULL AS RISKCONNECT_NAME,
	NULL AS HR_OFFICE_NUMBER,
	NULL AS HR_OFFICE_NAME,
	TRUE AS ACTIVE_FLAG,
	''2021-01-01'' AS EFFECTIVE_FROM_DATE,
	''2021-01-01'' AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG	
FROM ANSWERCARE_NUMBER ANS
UNION
SELECT
	MD5(''E3'' || ''-'' || TRIM(BRANCH_NAME) || OFFICE_NUMBER || ''-'' || ''TRUSTPOINTDATA'') AS BRANCH_KEY,
	UPPER(TRIM(BRANCH_NAME)) AS BRANCH_NAME,
	SYSTEM_CODE AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	OFFICE_NUMBER AS OFFICE_NUMBER,
	OFFICE_NUMBER::STRING AS OFFICE_CODE,
	NULL AS OFFICE_NAME,
	NULL AS OFFICE_NAME_ALT,
	NULL AS DEPARTMENT_NAME,
	NULL AS BRANCH_SERVICE_LINE,
	TRUE AS PARENT_FLAG,
	MD5(''E3'' || ''-'' || TRIM(BRANCH_NAME) || OFFICE_NUMBER || ''-'' || ''TRUSTPOINTDATA'') AS PARENT_BRANCH_KEY,
	OFFICE_NUMBER AS PARENT_OFFICE_NUMBER,
	OFFICE_NUMBER::VARCHAR AS PARENT_OFFICE_CODE,
	''MI'' || '' - '' || BRANCH_NAME || '' ('' || OFFICE_NUMBER || '')'' AS PARENT_BRANCH_NAME,
	ADDRESS1 AS OFFICE_ADDRESS1,
	ADDRESS2 AS OFFICE_ADDRESS2,
	CITY AS OFFICE_CITY,
	''MI'' AS OFFICE_STATE_CODE,
	ZIP AS OFFICE_ZIP,
	NULL AS OFFICE_PHONE,
	NULL AS OFFICE_TOLL_FREE_PHONE,
	NULL AS OFFICE_FAX,
	''MI'' || '' - '' || BRANCH_NAME || '' ('' || OFFICE_NUMBER || '')'' AS DETAILED_OFFICE_NAME,
	NULL AS REGION_NUMBER,
	NULL AS REGION_NAME,
	NULL AS REGION_MANAGER,
	NULL AS REGION_MANAGER_EMPLOYEE_KEY,
	NULL AS SUBREGION_NAME,
	NULL AS PRIMARY_BRANCH_MANAGER_NAME,
	NULL AS PRIMARY_BRANCH_EMAIL,
	NULL AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS SECONDARY_BRANCH_MANAGER_NAME,
	NULL AS SECONDARY_BRANCH_EMAIL,
	NULL AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS RISKCONNECT_NODE_KEY,
	NULL AS RISKCONNECT_NAME,
	NULL AS HR_OFFICE_NUMBER,
	NULL AS HR_OFFICE_NAME,
	TRUE AS ACTIVE_FLAG,
	''2021-01-01'' AS EFFECTIVE_FROM_DATE,
	''2021-01-01'' AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG	
FROM E3_BRANCHES
UNION
SELECT
	MD5(''HAHMI'' || ''-'' || TRIM(HAHMI.BRANCH_NAME) || HAHMI.OFFICE_NUMBER || ''-'' || ''TRUSTPOINTDATA'') AS BRANCH_KEY,
	UPPER(TRIM(HAHMI.BRANCH_NAME)) AS BRANCH_NAME,
	HAHMI.SYSTEM_CODE AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	HAHMI.OFFICE_NUMBER AS OFFICE_NUMBER,
	HAHMI.OFFICE_NUMBER::STRING AS OFFICE_CODE,
	NULL AS OFFICE_NAME,
	NULL AS OFFICE_NAME_ALT,
	NULL AS DEPARTMENT_NAME,
	NULL AS BRANCH_SERVICE_LINE,
	TRUE AS PARENT_FLAG,
	MD5(''HAHMI'' || ''-'' || TRIM(HAHMI.BRANCH_NAME) || HAHMI.OFFICE_NUMBER || ''-'' || ''TRUSTPOINTDATA'') AS PARENT_BRANCH_KEY,
	HAHMI.OFFICE_NUMBER AS PARENT_OFFICE_NUMBER,
	OFFICE_NUMBER::VARCHAR AS PARENT_OFFICE_CODE,
	''MI'' || '' - '' || BRANCH_NAME || '' ('' || OFFICE_NUMBER || '')'' AS PARENT_BRANCH_NAME,
	HAHMI.ADDRESS1 AS OFFICE_ADDRESS1,
	HAHMI.ADDRESS2 AS OFFICE_ADDRESS2,
	HAHMI.CITY AS OFFICE_CITY,
	''MI'' AS OFFICE_STATE_CODE,
	HAHMI.ZIP AS OFFICE_ZIP,
	NULL AS OFFICE_PHONE,
	NULL AS OFFICE_TOLL_FREE_PHONE,
	NULL AS OFFICE_FAX,
	''MI'' || '' - '' || BRANCH_NAME || '' ('' || OFFICE_NUMBER || '')'' AS DETAILED_OFFICE_NAME,
	NULL AS REGION_NUMBER,
	NULL AS REGION_NAME,
	NULL AS REGION_MANAGER,
	NULL AS REGION_MANAGER_EMPLOYEE_KEY,
	NULL AS SUBREGION_NAME,
	NULL AS PRIMARY_BRANCH_MANAGER_NAME,
	NULL AS PRIMARY_BRANCH_EMAIL,
	NULL AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS SECONDARY_BRANCH_MANAGER_NAME,
	NULL AS SECONDARY_BRANCH_EMAIL,
	NULL AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS RISKCONNECT_NODE_KEY,
	NULL AS RISKCONNECT_NAME,
	NULL AS HR_OFFICE_NUMBER,
	NULL AS HR_OFFICE_NAME,
	TRUE AS ACTIVE_FLAG,
	''2021-01-01'' AS EFFECTIVE_FROM_DATE,
	''2021-01-01'' AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG	
FROM HAHMI_BRANCHES AS HAHMI
UNION
SELECT
	MD5(''EXCEL'' || ''-'' || B.OFFICE_NUMBER || BRANCH_NAME || ''-'' || ''EXCEL'') AS BRANCH_KEY,
	UPPER(TRIM(B.BRANCH_NAME)) AS BRANCH_NAME,
	''EXCEL'' AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	NVL(B.OFFICE_NUMBER,-1) AS OFFICE_NUMBER,
	OFFICE_NUMBER::STRING AS OFFICE_CODE,--ASK
	NULL AS OFFICE_NAME,
	NULL AS OFFICE_NAME_ALT,
	NULL AS DEPARTMENT_NAME,
	NULL AS BRANCH_SERVICE_LINE,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS PARENT_FLAG,
	MD5(''EXCEL'' || ''-'' || B.OFFICE_NUMBER || BRANCH_NAME || ''-''  || ''EXCEL'') AS PARENT_BRANCH_KEY,
	NVL(B.OFFICE_NUMBER,-1) AS PARENT_OFFICE_NUMBER,
	B.OFFICE_NUMBER::STRING AS PARENT_OFFICE_CODE,
	UPPER(TRIM(B.BRANCH_NAME)) || '' ('' ||  B.OFFICE_NUMBER || '')'' AS PARENT_BRANCH_NAME,
	ADDRESS1 AS OFFICE_ADDRESS1,
	ADDRESS2 AS OFFICE_ADDRESS2,
	CITY AS OFFICE_CITY,
	COALESCE(STATE, ''PA'') AS OFFICE_STATE_CODE,
	ZIP AS OFFICE_ZIP,
	NULL AS OFFICE_PHONE,
	NULL AS OFFICE_TOLL_FREE_PHONE,
	NULL AS OFFICE_FAX,                                                
	UPPER(TRIM(B.BRANCH_NAME)) || '' ('' || B.OFFICE_NUMBER || '')'' AS DETAILED_OFFICE_NAME,
	NULL AS REGION_NUMBER,
	NULL AS REGION_NAME,
	NULL AS REGION_MANAGER,
	NULL AS REGION_MANAGER_EMPLOYEE_KEY,
	NULL AS SUBREGION_NAME,
	NULL AS PRIMARY_BRANCH_MANAGER_NAME,
	NULL AS PRIMARY_BRANCH_EMAIL,
	NULL AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS SECONDARY_BRANCH_MANAGER_NAME,
	NULL AS SECONDARY_BRANCH_EMAIL,
	NULL AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS RISKCONNECT_NODE_KEY,
	NULL AS RISKCONNECT_NAME,
	NULL AS HR_OFFICE_NUMBER,
	NULL AS HR_OFFICE_NAME,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS ACTIVE_FLAG,
	TO_DATE(''1900-01-01'', ''YYYY-MM-DD'') AS EFFECTIVE_FROM_DATE,
	TO_DATE(''9999-12-31'', ''YYYY-MM-DD'') AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG
FROM EXCEL B
UNION
SELECT
	MD5(''HAHDELAWARE'' || ''-'' || B.OFFICE_NUMBER || BRANCH_NAME || ''-'' || ''HAHDELAWARE'') AS BRANCH_KEY,
	UPPER(TRIM(B.BRANCH_NAME)) AS BRANCH_NAME,
	''HAHDELAWARE'' AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	NVL(B.OFFICE_NUMBER,-1) AS OFFICE_NUMBER,
	OFFICE_NUMBER::STRING AS OFFICE_CODE,
	UPPER(TRIM(B.BRANCH_NAME)) AS OFFICE_NAME,
	UPPER(TRIM(B.BRANCH_NAME)) AS OFFICE_NAME_ALT,
	NULL AS DEPARTMENT_NAME,
	NULL AS BRANCH_SERVICE_LINE,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS PARENT_FLAG,
	MD5(''HAHDELAWARE'' || ''-'' || B.OFFICE_NUMBER || BRANCH_NAME || ''-''  || ''HAHDELAWARE'') AS PARENT_BRANCH_KEY,
	NVL(B.OFFICE_NUMBER,-1) AS PARENT_OFFICE_NUMBER,
	B.OFFICE_NUMBER::STRING AS PARENT_OFFICE_CODE,
	UPPER(TRIM(B.BRANCH_NAME)) || '' ('' ||  B.OFFICE_NUMBER || '')'' AS PARENT_BRANCH_NAME,
	ADDRESS1 AS OFFICE_ADDRESS1,
	ADDRESS2 AS OFFICE_ADDRESS2,
	''WILMINGTON'' AS OFFICE_CITY,
	''DE'' AS OFFICE_STATE_CODE,
	ZIP AS OFFICE_ZIP,
	NULL AS OFFICE_PHONE,
	NULL AS OFFICE_TOLL_FREE_PHONE,
	NULL AS OFFICE_FAX,                                                
	UPPER(TRIM(B.BRANCH_NAME)) || '' ('' || B.OFFICE_NUMBER || '')'' AS DETAILED_OFFICE_NAME,
	NULL AS REGION_NUMBER,
	NULL AS REGION_NAME,
	NULL AS REGION_MANAGER,
	NULL AS REGION_MANAGER_EMPLOYEE_KEY,
	NULL AS SUBREGION_NAME,
	NULL AS PRIMARY_BRANCH_MANAGER_NAME,
	NULL AS PRIMARY_BRANCH_EMAIL,
	NULL AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS SECONDARY_BRANCH_MANAGER_NAME,
	NULL AS SECONDARY_BRANCH_EMAIL,
	NULL AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS RISKCONNECT_NODE_KEY,
	NULL AS RISKCONNECT_NAME,
	NULL AS HR_OFFICE_NUMBER,
	NULL AS HR_OFFICE_NAME,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS ACTIVE_FLAG,
	TO_DATE(''1900-01-01'', ''YYYY-MM-DD'') AS EFFECTIVE_FROM_DATE,
	TO_DATE(''9999-12-31'', ''YYYY-MM-DD'') AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG
FROM HAHDELAWARE B
UNION
SELECT
	MD5(''PROSPER'' || ''-'' || B.OFFICE_NUMBER || BRANCH_NAME || ''-'' || ''PROSPER'') AS BRANCH_KEY,
	UPPER(TRIM(B.BRANCH_NAME)) AS BRANCH_NAME,
	''COASTAL'' AS SYSTEM_CODE,
	6 AS SOURCE_SYSTEM_ID,
	NVL(B.OFFICE_NUMBER,-1) AS OFFICE_NUMBER,
	OFFICE_NUMBER::STRING AS OFFICE_CODE,
	UPPER(TRIM(B.BRANCH_NAME)) AS OFFICE_NAME,
	UPPER(TRIM(B.BRANCH_NAME)) AS OFFICE_NAME_ALT,
	NULL AS DEPARTMENT_NAME,
	NULL AS BRANCH_SERVICE_LINE,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS PARENT_FLAG,
	MD5(''PROSPER'' || ''-'' || B.OFFICE_NUMBER || BRANCH_NAME || ''-''  || ''PROSPER'') AS PARENT_BRANCH_KEY,
	NVL(B.OFFICE_NUMBER,-1) AS PARENT_OFFICE_NUMBER,
	B.OFFICE_NUMBER::STRING AS PARENT_OFFICE_CODE,
	UPPER(TRIM(B.BRANCH_NAME)) || '' ('' ||  B.OFFICE_NUMBER || '')'' AS PARENT_BRANCH_NAME,
	ADDRESS1 AS OFFICE_ADDRESS1,
	ADDRESS2 AS OFFICE_ADDRESS2,
	CITY AS OFFICE_CITY,
	STATE AS OFFICE_STATE_CODE,
	ZIP AS OFFICE_ZIP,
	NULL AS OFFICE_PHONE,
	NULL AS OFFICE_TOLL_FREE_PHONE,
	NULL AS OFFICE_FAX,                                                
	UPPER(TRIM(B.BRANCH_NAME)) || '' ('' || B.OFFICE_NUMBER || '')'' AS DETAILED_OFFICE_NAME,
	NULL AS REGION_NUMBER,
	NULL AS REGION_NAME,
	NULL AS REGION_MANAGER,
	NULL AS REGION_MANAGER_EMPLOYEE_KEY,
	NULL AS SUBREGION_NAME,
	NULL AS PRIMARY_BRANCH_MANAGER_NAME,
	NULL AS PRIMARY_BRANCH_EMAIL,
	NULL AS PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS SECONDARY_BRANCH_MANAGER_NAME,
	NULL AS SECONDARY_BRANCH_EMAIL,
	NULL AS SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
	NULL AS RISKCONNECT_NODE_KEY,
	NULL AS RISKCONNECT_NAME,
	NULL AS HR_OFFICE_NUMBER,
	NULL AS HR_OFFICE_NAME,
	TRY_CAST( ''TRUE'' AS BOOLEAN )  AS ACTIVE_FLAG,
	TO_DATE(''1900-01-01'', ''YYYY-MM-DD'') AS EFFECTIVE_FROM_DATE,
	TO_DATE(''9999-12-31'', ''YYYY-MM-DD'') AS EFFECTIVE_TO_DATE,
		:STR_ETL_TASK_KEY AS ETL_TASK_KEY,
		:STR_ETL_TASK_KEY AS ETL_INSERTED_TASK_KEY,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_INSERTED_DATE,
		CURRENT_USER as ETL_INSERTED_BY ,
		convert_timezone(''UTC'', CURRENT_TIMESTAMP)::timestamp_ntz as ETL_LAST_UPDATED_DATE,
		CURRENT_USER as ETL_LAST_UPDATED_BY,
		TRY_CAST( ''FALSE'' AS BOOLEAN )  as ETL_DELETED_FLAG,
		TRY_CAST( ''FALSE'' AS BOOLEAN ) as ETL_INFERRED_MEMBER_FLAG
FROM PROSPER B
)
SELECT ALL_BRANCHES.BRANCH_KEY,
ALL_BRANCHES.BRANCH_NAME,
ALL_BRANCHES.SYSTEM_CODE,
ALL_BRANCHES.SOURCE_SYSTEM_ID,
SOURCE_SYSTEM.SOURCE_SYSTEM_TYPE,
ALL_BRANCHES.OFFICE_NUMBER,
ALL_BRANCHES.OFFICE_CODE,
ALL_BRANCHES.OFFICE_NAME,
ALL_BRANCHES.OFFICE_NAME_ALT,
ALL_BRANCHES.DEPARTMENT_NAME,
ALL_BRANCHES.BRANCH_SERVICE_LINE,
ALL_BRANCHES.PARENT_FLAG,
ALL_BRANCHES.PARENT_BRANCH_KEY,
ALL_BRANCHES.PARENT_OFFICE_NUMBER,
ALL_BRANCHES.PARENT_OFFICE_CODE,
ALL_BRANCHES.PARENT_BRANCH_NAME,
ALL_BRANCHES.OFFICE_ADDRESS1,
ALL_BRANCHES.OFFICE_ADDRESS2,
ALL_BRANCHES.OFFICE_CITY,
ALL_BRANCHES.OFFICE_STATE_CODE,
ALL_BRANCHES.OFFICE_ZIP,
ALL_BRANCHES.OFFICE_PHONE,
ALL_BRANCHES.OFFICE_TOLL_FREE_PHONE,
ALL_BRANCHES.OFFICE_FAX,
ALL_BRANCHES.DETAILED_OFFICE_NAME,
ALL_BRANCHES.REGION_NUMBER,
ALL_BRANCHES.REGION_NAME,
ALL_BRANCHES.REGION_MANAGER,
ALL_BRANCHES.REGION_MANAGER_EMPLOYEE_KEY,
ALL_BRANCHES.SUBREGION_NAME,
ALL_BRANCHES.PRIMARY_BRANCH_MANAGER_NAME,
ALL_BRANCHES.PRIMARY_BRANCH_EMAIL,
ALL_BRANCHES.PRIMARY_BRANCH_MANAGER_EMPLOYEE_KEY,
ALL_BRANCHES.SECONDARY_BRANCH_MANAGER_NAME,
ALL_BRANCHES.SECONDARY_BRANCH_EMAIL,
ALL_BRANCHES.SECONDARY_BRANCH_MANAGER_EMPLOYEE_KEY,
ALL_BRANCHES.RISKCONNECT_NODE_KEY,
ALL_BRANCHES.RISKCONNECT_NAME,
ALL_BRANCHES.HR_OFFICE_NUMBER,
ALL_BRANCHES.HR_OFFICE_NAME,
ALL_BRANCHES.ACTIVE_FLAG,
ALL_BRANCHES.EFFECTIVE_FROM_DATE,
ALL_BRANCHES.EFFECTIVE_TO_DATE,
ALL_BRANCHES.ETL_TASK_KEY,
ALL_BRANCHES.ETL_INSERTED_TASK_KEY,
ALL_BRANCHES.ETL_INSERTED_DATE,
ALL_BRANCHES.ETL_INSERTED_BY,
ALL_BRANCHES.ETL_LAST_UPDATED_DATE,
ALL_BRANCHES.ETL_LAST_UPDATED_BY,
ALL_BRANCHES.ETL_DELETED_FLAG,
ALL_BRANCHES.ETL_INFERRED_MEMBER_FLAG
FROM ALL_BRANCHES 
LEFT JOIN DW_PROD.HAH.DIM_SOURCE_SYSTEM AS SOURCE_SYSTEM ON ALL_BRANCHES.SOURCE_SYSTEM_ID = SOURCE_SYSTEM.SOURCE_SYSTEM_ID;

RETURN ''SUCESS'';

END;
';