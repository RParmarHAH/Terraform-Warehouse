CREATE OR REPLACE PROCEDURE DW_PROD.HAH.DELETE_STAGE_GPSYNCDATA_DIM_EMPLOYEE()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '

	DECLARE 
		RES RESULTSET;
	BEGIN
		DELETE FROM HAH.DIM_EMPLOYEE WHERE SOURCE_SYSTEM_ID = 5 AND EMPLOYEE_KEY
    NOT IN (SELECT EMPLOYEE_KEY FROM STAGE.GPSYNCDATA_DIM_EMPLOYEE);
  
RETURN ''DONE'';
END;
';