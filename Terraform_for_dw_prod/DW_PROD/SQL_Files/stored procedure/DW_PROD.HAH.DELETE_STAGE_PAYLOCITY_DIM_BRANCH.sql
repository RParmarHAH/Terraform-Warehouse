CREATE OR REPLACE PROCEDURE DW_PROD.HAH.DELETE_STAGE_PAYLOCITY_DIM_BRANCH()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
	BEGIN

	DELETE FROM HAH.DIM_BRANCH WHERE SOURCE_SYSTEM_ID = 10 AND BRANCH_KEY
    NOT IN (SELECT BRANCH_KEY FROM STAGE.PAYLOCITY_DIM_BRANCH);

	RETURN ''Message : Done'';
	END;
';