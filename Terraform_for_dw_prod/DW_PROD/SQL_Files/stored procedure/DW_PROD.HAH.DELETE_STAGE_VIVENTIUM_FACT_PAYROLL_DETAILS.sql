CREATE OR REPLACE PROCEDURE DW_PROD.HAH.DELETE_STAGE_VIVENTIUM_FACT_PAYROLL_DETAILS()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS '
BEGIN
 DELETE FROM HAH.FACT_PAYROLL_DETAILS WHERE SOURCE_SYSTEM_ID = 34 AND PAYROLL_DETAIL_KEY
  NOT IN (SELECT PAYROLL_DETAIL_KEY FROM STAGE.VIVENTIUM_FACT_PAYROLL_DETAILS);
return ''Done'';
END;
  
  
';