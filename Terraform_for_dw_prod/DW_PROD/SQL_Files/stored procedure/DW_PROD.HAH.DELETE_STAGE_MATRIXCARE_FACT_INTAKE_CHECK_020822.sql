CREATE OR REPLACE PROCEDURE DW_PROD.HAH.DELETE_STAGE_MATRIXCARE_FACT_INTAKE_CHECK_020822()
RETURNS VARCHAR(16777216)
LANGUAGE JAVASCRIPT
EXECUTE AS OWNER
AS '
  var now = new Date();
  var dayOfWeek = 0;
  if (dayOfWeek == 0) 
  {
    sqlCmd = `DELETE FROM HAH.FACT_INTAKE_BKP_AFTR_DLT_020822 WHERE SOURCE_SYSTEM_ID IN (7) AND INTAKE_KEY \\
    NOT IN (SELECT INTAKE_KEY FROM STAGE.VW_CURRENT_MATRIXCARE_FACT_INTAKE)`;
  }
  else
  {
     sqlCmd = `DELETE FROM HAH.FACT_INTAKE_BKP_AFTR_DLT_020822 WHERE SOURCE_SYSTEM_ID IN (7) AND INTAKE_KEY \\
     IN (SELECT INTAKE_KEY FROM STAGE.VW_CURRENT_DELETED_MATRIXCARE_FACT_INTAKE)`;
  }
  sqlStmt = snowflake.createStatement( {sqlText: sqlCmd} );
  rs = sqlStmt.execute();
  return ''Done'';
';