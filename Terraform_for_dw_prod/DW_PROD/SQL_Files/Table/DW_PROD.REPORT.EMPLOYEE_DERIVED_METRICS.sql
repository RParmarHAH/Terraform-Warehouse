CREATE OR REPLACE TABLE DW_PROD.REPORT.EMPLOYEE_DERIVED_METRICS (
	EMPLOYEE_KEY VARCHAR(32) NOT NULL,
	EMPLOYEE_ID VARCHAR(50) NOT NULL,
	SYSTEM_CODE VARCHAR(20) NOT NULL,
	SOURCE_SYSTEM_ID NUMBER(38,0) NOT NULL,
	ORIGINAL_SOURCE_SYSTEM_ID NUMBER(38,0) NOT NULL,
	MDM_EMPLOYEE_KEY VARCHAR(32),
	EMPLOYEE_PID VARCHAR(32),
	EMPLOYEE_NUMBER VARCHAR(50),
	FIRST_NAME VARCHAR(50),
	LAST_NAME VARCHAR(50),
	EMPLOYEE_CATEGORY VARCHAR(15) COMMENT 'Corporate, Admin, Field',
	DERIVED_EMPLOYEE_CATEGORY VARCHAR(15),
	EMPLOYEE_TYPE VARCHAR(20),
	DERIVED_WORK_STATE VARCHAR(2),
	EMPLOYEE_OFFICE_CODE VARCHAR(5),
	PRIMARY_BRANCH_KEY VARCHAR(32),
	PRIMARY_BRANCH_STATE VARCHAR(3),
	PRIMARY_BRANCH_NAME VARCHAR(100),
	PRIMARY_BRANCH_SYSTEM_CODE VARCHAR(20),
	PRIMARY_SUPERVISOR_KEY VARCHAR(32),
	PRIMARY_SUPERVISOR_SYSTEM_CODE VARCHAR(20),
	PRIMARY_SUPERVISOR_NAME VARCHAR(100),
	EMPLOYEE_DOB DATE,
	CURRENT_AGE NUMBER(38,0),
	AGE_AT_TERMINATION NUMBER(38,0),
	EMPLOYEE_HIRE_DATE DATE,
	EMPLOYEE_REHIRE_DATE DATE,
	EMPLOYEE_BENEFIT_START_DATE DATE,
	EMPLOYEE_FIRST_CHECK_DATE DATE,
	EMPLOYEE_LAST_CHECK_DATE DATE,
	EMPLOYEE_LAST_WORKED_DATE DATE,
	EMPLOYEE_TERMINATE_DATE DATE,
	DERIVED_HIRE_DATE DATE,
	DERIVED_LATEST_REHIRE_DATE DATE,
	DERIVED_REHIRE_FLAG BOOLEAN NOT NULL DEFAULT FALSE,
	DERIVED_FIRST_CHECK_DATE DATE,
	DERIVED_LAST_CHECK_DATE DATE,
	DERIVED_FIRST_SERVICE_DATE DATE,
	DERIVED_LAST_SERVICE_DATE DATE,
	DERIVED_LATEST_TERMINATE_DATE DATE,
	TENURE_IN_MONTHS NUMBER(38,0),
	EMPLOYEE_TENURE_BUCKET VARCHAR(16),
	DAYS_INACTIVE NUMBER(38,0),
	MONTHS_OF_ACTIVE_SERVICE NUMBER(38,0),
	DELIVERED_CLS_SERVICES_FLAG BOOLEAN,
	DELIVERED_HH_SERVICES_FLAG BOOLEAN,
	DELIVERED_HC_SERVICES_FLAG BOOLEAN,
	DELIVERED_OTHER_SERVICES_FLAG BOOLEAN,
	DAYS_SINCE_LAST_PAYCHECK NUMBER(38,0),
	ACTIVE_EMPLOYEE_FLAG BOOLEAN NOT NULL,
	DERIVED_ACTIVE_EMPLOYEE_FLAG BOOLEAN NOT NULL DEFAULT FALSE,
	DERIVED_UNION_FLAG BOOLEAN NOT NULL DEFAULT FALSE,
	PAYROLL_ID VARCHAR(20),
	PAYROLL_EMPLOYEE_ID VARCHAR(50),
	PAYROLL_SYSTEM_CODE VARCHAR(20),
	PAYROLL_SOURCE_SYSTEM_ID NUMBER(38,0),
	PAYROLL_EMPLOYEE_PID VARCHAR(32),
	PAYROLL_EMPLOYEE_NUMBER VARCHAR(50),
	DERIVED_PAY_RATE_SALARY NUMBER(15,3) COMMENT 'This column should be encoded, similar to SSN',
	DERIVED_PAY_RATE_HOURLY NUMBER(15,3) COMMENT 'This column should be encoded, similar to SSN',
	DERIVED_PAY_RATE_AVG_HOURLY NUMBER(15,3) COMMENT 'This column should be encoded, similar to SSN',
	DERIVED_PAY_RATE_MIN_HOURLY NUMBER(15,3) COMMENT 'This column should be encoded, similar to SSN',
	DERIVED_PAY_RATE_MAX_HOURLY NUMBER(15,3) COMMENT 'This column should be encoded, similar to SSN',
	DERIVED_EXEMPT_FLAG BOOLEAN NOT NULL DEFAULT FALSE,
	TOTAL_WAGES_CURRENT_YEAR NUMBER(15,3),
	TOTAL_WAGES_PREVIOUS_YEAR NUMBER(15,3),
	TOTAL_WAGES_2_YEARS_PREVIOUS NUMBER(15,3),
	TOTAL_REG_HOURS_ROLLING_12_MONTHS NUMBER(7,2),
	AVG_WEEKLY_REG_HOURS_ROLLING_12_MONTHS NUMBER(7,2),
	TOTAL_OVERTIME_HOURS_ROLLING_12_MONTHS NUMBER(7,2),
	AVG_WEEKLY_OVERTIME_HOURS_ROLLING_12_MONTHS NUMBER(7,2),
	TOTAL_COMPENSATION_ROLLING_12_MONTHS NUMBER(12,2),
	AVG_HOURLY_PAY_RATE_ROLLING_12_MONTHS NUMBER(12,2),
	AVG_HOURLY_OVERTIME_RATE_ROLLING_12_MONTHS NUMBER(12,2),
	BONUS_COMPENSATION_ROLLING_12_MONTHS NUMBER(12,2),
	TOTAL_REG_HOURS_PREV_YR NUMBER(7,2),
	AVG_WEEKLY_REG_HOURS_PREV_YR NUMBER(7,2),
	TOTAL_OVERTIME_HOURS_PREV_YR NUMBER(7,2),
	AVG_WEEKLY_OVERTIME_HOURS_PREV_YR NUMBER(7,2),
	TOTAL_COMPENSATION_PREV_YR NUMBER(12,2),
	AVG_HOURLY_PAY_RATE_PREV_YR NUMBER(12,2),
	AVG_HOURLY_OVERTIME_RATE_PREV_YR NUMBER(12,2),
	BONUS_COMPENSATION_PREV_YR NUMBER(12,2),
	TOTAL_REG_HOURS_CURR_YR NUMBER(7,2),
	AVG_WEEKLY_REG_HOURS_CURRENT_YR NUMBER(7,2),
	TOTAL_OVERTIME_HOURS_CURR_YR NUMBER(7,2),
	AVG_WEEKLY_OVERTIME_HOURS_CURRENT_YR NUMBER(7,2),
	TOTAL_COMPENSATION_CURR_YR NUMBER(12,2),
	AVG_HOURLY_PAY_RATE_CURRENT_YR NUMBER(12,2),
	AVG_HOURLY_OVERTIME_RATE_CURRENT_YR NUMBER(12,2),
	BONUS_COMPENSATION_CURRENT_YR NUMBER(12,2),
	APPLICANT_ID VARCHAR(50),
	APPLICANT_KEY VARCHAR(16777216),
	APPLICANT_SOURCE_SYSTEM_ID VARCHAR(50),
	APPLICANT_HIRED_DATE TIMESTAMP_NTZ(9),
	DATE_APPLIED TIMESTAMP_NTZ(9),
	APPLICATION_TO_HIRE_DAYS NUMBER(38,0),
	FIRST_SERVICE_AFTER_REHIRE DATE,
	HIRE_TO_FIRST_SERVICE_DAYS NUMBER(38,0),
	NEXT_SCHEDULED_SERVICE_DATE DATE,
	APPLICATION_JOB_KEY VARCHAR(32),
	PHONE1 VARCHAR(32),
	PHONE2 VARCHAR(32),
	PHONE3 VARCHAR(32)
);