CREATE OR REPLACE TABLE DW_PROD.HAH.FACT_INVOICE_CREDITS (
	CREDIT_KEY VARCHAR(32) NOT NULL,
	REPORT_DATE DATE NOT NULL,
	BRANCH_KEY VARCHAR(32) NOT NULL,
	CLIENT_KEY VARCHAR(32) NOT NULL,
	CONTRACT_KEY VARCHAR(32) NOT NULL,
	INVOICE_KEY VARCHAR(32),
	SOURCE_SYSTEM_ID NUMBER(38,0) NOT NULL,
	SYSTEM_CODE VARCHAR(20) NOT NULL,
	PERIOD VARCHAR(6),
	PERIOD_DATE DATE,
	PAYMENT_DATE DATE,
	BRANCH_NAME VARCHAR(100),
	CLIENT_NUMBER VARCHAR(50),
	CONTRACT_CODE VARCHAR(10),
	SERVICE_AREA VARCHAR(20),
	INVOICE_TYPE VARCHAR(20),
	NUMBER_OF_INVOICES NUMBER(38,0),
	INVOICE_NUMBER VARCHAR(25),
	CREDIT_TYPE VARCHAR(20),
	CREDIT_AMOUNT NUMBER(38,3),
	PAYMENT_NUMBER NUMBER(38,0),
	PAYMENT_NOTES VARCHAR(500),
	CHECK_NUMBER VARCHAR(20),
	AUDIT_NUMBER NUMBER(38,0),
	WRITEOFF_REASON_CODE VARCHAR(50),
	WRITEOFF_REASON_DESCRIPTION VARCHAR(100),
	ETL_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_INSERTED_BY VARCHAR(100) NOT NULL,
	ETL_LAST_UPDATED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_LAST_UPDATED_BY VARCHAR(100) NOT NULL,
	ETL_DELETED_FLAG BOOLEAN NOT NULL,
	constraint PK_FACT_PAYMENT primary key (CREDIT_KEY)
);