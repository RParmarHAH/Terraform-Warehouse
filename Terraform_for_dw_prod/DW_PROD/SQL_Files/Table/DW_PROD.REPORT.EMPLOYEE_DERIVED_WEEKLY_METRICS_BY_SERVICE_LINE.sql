CREATE OR REPLACE TABLE DW_PROD.REPORT.EMPLOYEE_DERIVED_WEEKLY_METRICS_BY_SERVICE_LINE (
	SERVICE_WEEK DATE,
	EMPLOYEE_KEY VARCHAR(32),
	SOURCE_SYSTEM_ID NUMBER(38,0),
	SYSTEM_CODE VARCHAR(20),
	EMPLOYEE_ID VARCHAR(50),
	EMPLOYEE_PID VARCHAR(32),
	EMPLOYEE_NUMBER VARCHAR(50),
	PAYROLL_ID VARCHAR(20),
	BRANCH_KEY VARCHAR(32),
	BRANCH_NAME VARCHAR(100),
	BRANCH_STATE_CODE VARCHAR(2),
	SERVICE_LINE VARCHAR(50),
	NUMBER_OF_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_CLIENTS NUMBER(38,0),
	SUM_OF_HOURS_SERVED NUMBER(9,3),
	ETL_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_INSERTED_BY VARCHAR(100) NOT NULL,
	ETL_LAST_UPDATED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_LAST_UPDATED_BY VARCHAR(100) NOT NULL,
	ETL_DELETED_FLAG BOOLEAN NOT NULL
);