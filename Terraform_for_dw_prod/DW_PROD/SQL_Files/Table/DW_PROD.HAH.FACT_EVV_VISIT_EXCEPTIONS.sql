CREATE OR REPLACE TABLE DW_PROD.HAH.FACT_EVV_VISIT_EXCEPTIONS (
	VISIT_KEY VARCHAR(32) NOT NULL,
	EXCEPTION_REASON_CODE VARCHAR(20) NOT NULL,
	REPORT_DATE DATE NOT NULL,
	BRANCH_KEY VARCHAR(32) NOT NULL,
	CLIENT_KEY VARCHAR(32) NOT NULL,
	CONTRACT_KEY VARCHAR(32) NOT NULL,
	EMPLOYEE_KEY VARCHAR(32) NOT NULL,
	SUPERVISOR_KEY VARCHAR(32) NOT NULL,
	SERVICE_DATE DATE NOT NULL,
	CLIENT_NUMBER VARCHAR(50),
	CONTRACT_CODE VARCHAR(10),
	EMPLOYEE_ID VARCHAR(50),
	SYSTEM_CODE VARCHAR(20) NOT NULL,
	EXCEPTION_REASON_DESCRIPTION VARCHAR(100),
	ETL_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_INSERTED_BY VARCHAR(100) NOT NULL,
	ETL_LAST_UPDATED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_LAST_UPDATED_BY VARCHAR(100) NOT NULL,
	ETL_DELETED_FLAG BOOLEAN NOT NULL,
	constraint PK_FACT_EVV_VISIT_EXCEPTIONS primary key (VISIT_KEY, EXCEPTION_REASON_CODE)
);