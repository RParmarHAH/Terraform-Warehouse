CREATE OR REPLACE TABLE DW_PROD.REPORT.CLIENT_DERIVED_MONTHLY_VISIT_METRICS_FJN (
	SERVICE_MONTH DATE,
	CLIENT_KEY VARCHAR(32),
	SOURCE_SYSTEM_ID NUMBER(38,0),
	BRANCH_KEY VARCHAR(32),
	OFFICE_NAME VARCHAR(100),
	STATE_CODE VARCHAR(2),
	REFERRAL_DATE DATE,
	LIFETIME_FIRST_SERVICE_MONTH DATE,
	LIFETIME_LAST_SERVICE_MONTH DATE,
	LIFETIME_TENURE_IN_MONTHS NUMBER(38,0),
	LIFETIME_NUMBER_MONTHS_WITH_SERVICE NUMBER(38,0),
	LIFETIME_NUMBER_MONTHS_WO_SERVICE NUMBER(38,0),
	LIFETIME_NUMBER_OF_GAPS_IN_SERVICE NUMBER(38,0),
	LIFETIME_SMALLEST_GAP_IN_SERVICE NUMBER(38,0),
	LIFETIME_LARGEST_GAP_IN_SERVICE NUMBER(38,0),
	NEW_CLIENT_FLAG BOOLEAN,
	FIRST_MONTH_INACTIVE_FLAG BOOLEAN,
	ACTIVE_FLAG BOOLEAN,
	REACTIVATED_FLAG BOOLEAN,
	NUMBER_OF_SERVICE_LINES_PROVIDED NUMBER(38,0),
	HC_SERVICE_LINE_PROVIDED BOOLEAN,
	HH_SERVICE_LINE_PROVIDED BOOLEAN,
	CLS_SERVICE_LINE_PROVIDED BOOLEAN,
	NA_SERVICE_LINE_PROVIDED BOOLEAN,
	IS_SERVICE_LINE_PROVIDED BOOLEAN,
	NS_SERVICE_LINE_PROVIDED BOOLEAN,
	NUMBER_OF_VISITS NUMBER(38,0),
	PREVIOUS_MONTH_NUMBER_OF_VISITS NUMBER(38,0),
	PREVIOUS_2_MONTH_NUMBER_OF_VISITS NUMBER(38,0),
	NEXT_MONTH_NUMBER_OF_VISITS NUMBER(38,0),
	NEXT_2_MONTH_NUMBER_OF_VISITS NUMBER(38,0),
	SUM_OF_HOURS_RECEIVED NUMBER(9,3),
	PREVIOUS_MONTH_SUM_OF_HOURS_RECEIVED NUMBER(9,3),
	PREVIOUS_2_MONTH_SUM_OF_HOURS_RECEIVED NUMBER(9,3),
	NEXT_MONTH_SUM_OF_HOURS_RECEIVED NUMBER(9,3),
	NEXT_2_MONTH_SUM_OF_HOURS_RECEIVED NUMBER(9,3),
	NUMBER_OF_HC_VISITS NUMBER(38,0),
	SUM_OF_HC_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_HH_VISITS NUMBER(38,0),
	SUM_OF_HH_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_CLS_VISITS NUMBER(38,0),
	SUM_OF_CLS_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_NA_VISITS NUMBER(38,0),
	SUM_OF_NA_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_IS_VISITS NUMBER(38,0),
	SUM_OF_IS_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_NS_VISITS NUMBER(38,0),
	SUM_OF_NS_HOURS_SERVED NUMBER(9,3)
);