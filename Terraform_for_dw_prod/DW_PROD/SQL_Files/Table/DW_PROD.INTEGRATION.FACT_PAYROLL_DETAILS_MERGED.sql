CREATE OR REPLACE TABLE DW_PROD.INTEGRATION.FACT_PAYROLL_DETAILS_MERGED cluster by (REPORT_DATE)(
	PAYROLL_DETAIL_KEY VARCHAR(32) NOT NULL,
	PAYROLL_KEY VARCHAR(32),
	REPORT_DATE DATE,
	EMPLOYEE_KEY VARCHAR(32),
	ORIGINAL_EMPLOYEE_KEY VARCHAR(32),
	BRANCH_KEY VARCHAR(32),
	ORIGINAL_BRANCH_KEY VARCHAR(32),
	SOURCE_SYSTEM_ID NUMBER(38,0),
	ORIGINAL_SOURCE_SYSTEM_ID NUMBER(38,0),
	PAYROLL_DATE DATE,
	EMPLOYEE_ID VARCHAR(32),
	ORIGINAL_EMPLOYEE_ID VARCHAR(32),
	BRANCH_NAME VARCHAR(100),
	ORIGINAL_BRANCH_NAME VARCHAR(100),
	SYSTEM_CODE VARCHAR(100),
	ORIGINAL_SYSTEM_CODE VARCHAR(100),
	PAY_PERIOD_START_DATE DATE,
	PAY_PERIOD_END_DATE DATE,
	CHECK_NUMBER VARCHAR(100),
	PAY_CODE VARCHAR(50),
	PAY_CODE_DESCRIPTION VARCHAR(100),
	PAY_CODE_TYPE VARCHAR(100),
	PAY_CODE_TYPE_DESCRIPTION VARCHAR(100),
	PAY_CODE_CATEGORY VARCHAR(100),
	NUMBER_OF_UNITS NUMBER(31,5),
	UNIT_TYPE_CODE VARCHAR(1),
	UNIT_TYPE_DESCRIPTION VARCHAR(20),
	RATE NUMBER(31,5),
	AMOUNT NUMBER(31,5),
	ETL_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_DATE TIMESTAMP_NTZ(9),
	ETL_INSERTED_BY VARCHAR(16777216),
	ETL_LAST_UPDATED_DATE TIMESTAMP_NTZ(9),
	ETL_LAST_UPDATED_BY VARCHAR(16777216),
	ETL_DELETED_FLAG BOOLEAN NOT NULL,
	constraint PK_PAYROLL_DETAIL_KEY primary key (PAYROLL_DETAIL_KEY)
);