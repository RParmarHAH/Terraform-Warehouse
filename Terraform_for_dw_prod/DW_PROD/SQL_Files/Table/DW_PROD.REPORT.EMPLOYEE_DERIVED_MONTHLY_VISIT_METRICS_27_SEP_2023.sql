CREATE OR REPLACE TABLE DW_PROD.REPORT.EMPLOYEE_DERIVED_MONTHLY_VISIT_METRICS_27_SEP_2023 (
	SERVICE_MONTH DATE,
	EMPLOYEE_KEY VARCHAR(32),
	SOURCE_SYSTEM_ID NUMBER(38,0),
	ORIGINAL_SOURCE_SYSTEM_ID NUMBER(38,0),
	EMPLOYEE_ID VARCHAR(50),
	SYSTEM_CODE VARCHAR(20),
	EMPLOYEE_PID VARCHAR(32),
	EMPLOYEE_NUMBER VARCHAR(50),
	PAYROLL_ID VARCHAR(20),
	EMPLOYEE_CATEGORY VARCHAR(15),
	DERIVED_EMPLOYEE_CATEGORY VARCHAR(15),
	FIRST_NAME VARCHAR(50),
	LAST_NAME VARCHAR(50),
	EMPLOYEE_DOB DATE,
	EMPLOYEE_GENDER VARCHAR(6),
	EMPLOYEE_ETHNICITY VARCHAR(50),
	BRANCH_KEY VARCHAR(32),
	BRANCH_NAME VARCHAR(100),
	BRANCH_STATE_CODE VARCHAR(2),
	FIRST_SERVICE_MONTH DATE,
	LAST_SERVICE_MONTH DATE,
	TENURE_IN_MONTHS NUMBER(38,0),
	NUMBER_MONTHS_WITH_SERVICE NUMBER(38,0),
	NUMBER_MONTHS_WO_SERVICE NUMBER(38,0),
	NUMBER_OF_GAPS_IN_SERVICE NUMBER(38,0),
	SMALLEST_GAP_IN_SERVICE NUMBER(38,0),
	LARGEST_GAP_IN_SERVICE NUMBER(38,0),
	NEW_HIRE_FLAG BOOLEAN,
	FIRST_MONTH_INACTIVE_FLAG BOOLEAN,
	ACTIVE_FLAG BOOLEAN,
	REACTIVATED_FLAG BOOLEAN,
	NUMBER_OF_SERVICE_LINES_PROVIDED NUMBER(38,0),
	HC_SERVICE_LINE_PROVIDED BOOLEAN,
	HH_SERVICE_LINE_PROVIDED BOOLEAN,
	CLS_SERVICE_LINE_PROVIDED BOOLEAN,
	NA_SERVICE_LINE_PROVIDED BOOLEAN,
	IS_SERVICE_LINE_PROVIDED BOOLEAN,
	NS_SERVICE_LINE_PROVIDED BOOLEAN,
	OTHER_SERVICE_LINE_PROVIDED BOOLEAN,
	NUMBER_OF_VISITS NUMBER(38,0),
	PREVIOUS_MONTH_NUMBER_OF_VISITS NUMBER(38,0),
	PREVIOUS_2_MONTH_NUMBER_OF_VISITS NUMBER(38,0),
	NEXT_MONTH_NUMBER_OF_VISITS NUMBER(38,0),
	NEXT_2_MONTH_NUMBER_OF_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_CLIENTS NUMBER(38,0),
	PREVIOUS_MONTH_NUMBER_OF_DISTINCT_CLIENTS NUMBER(38,0),
	PREVIOUS_2_MONTH_NUMBER_OF_DISTINCT_CLIENTS NUMBER(38,0),
	NEXT_MONTH_NUMBER_OF_DISTINCT_CLIENTS NUMBER(38,0),
	NEXT_2_MONTH_NUMBER_OF_DISTINCT_CLIENTS NUMBER(38,0),
	SUM_OF_HOURS_SERVED NUMBER(9,3),
	PREVIOUS_MONTH_SUM_OF_HOURS_SERVED NUMBER(9,3),
	PREVIOUS_2_MONTH_SUM_OF_HOURS_SERVED NUMBER(9,3),
	NEXT_MONTH_SUM_OF_HOURS_SERVED NUMBER(9,3),
	NEXT_2_MONTH_SUM_OF_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_HC_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_HC_CLIENTS NUMBER(38,0),
	SUM_OF_HC_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_HH_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_HH_CLIENTS NUMBER(38,0),
	SUM_OF_HH_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_CLS_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_CLS_CLIENTS NUMBER(38,0),
	SUM_OF_CLS_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_NA_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_NA_CLIENTS NUMBER(38,0),
	SUM_OF_NA_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_IS_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_IS_CLIENTS NUMBER(38,0),
	SUM_OF_IS_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_NS_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_NS_CLIENTS NUMBER(38,0),
	SUM_OF_NS_HOURS_SERVED NUMBER(9,3),
	NUMBER_OF_OTHER_VISITS NUMBER(38,0),
	NUMBER_OF_DISTINCT_OTHER_CLIENTS NUMBER(38,0),
	SUM_OF_OTHER_HOURS_SERVED NUMBER(9,3),
	FUTURE_HOURS NUMBER(18,2),
	HOURS_MISSED NUMBER(18,2),
	FUTURE_VISITS NUMBER(18,0),
	VISITS_MISSED NUMBER(18,0),
	EMPLOYEE_ACQUIRED_FLAG BOOLEAN,
	EMPLOYEE_ACQUISITION_NAME VARCHAR(32),
	UNION_FLAG BOOLEAN,
	REHIRED_FLAG BOOLEAN DEFAULT FALSE,
	REHIRED_DATE DATE,
	APPLICANT_ID VARCHAR(50),
	APPLICANT_KEY VARCHAR(16777216),
	APPLICANT_HIRED_DATE TIMESTAMP_NTZ(9),
	DATE_APPLIED TIMESTAMP_NTZ(9),
	APPLICATION_TO_HIRE_DAYS NUMBER(38,0),
	FIRST_SERVICE_AFTER_REHIRE DATE,
	HIRE_TO_FIRST_SERVICE_DAYS NUMBER(38,0),
	DERIVED_FIRST_SERVICE_DATE DATE,
	NEXT_SCHEDULED_SERVICE_DATE DATE,
	APPLICATION_JOB_KEY VARCHAR(32),
	OVER_TIME_HOUR NUMBER(38,0)
);