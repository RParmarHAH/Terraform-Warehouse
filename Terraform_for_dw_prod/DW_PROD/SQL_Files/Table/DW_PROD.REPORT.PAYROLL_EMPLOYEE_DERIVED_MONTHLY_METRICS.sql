CREATE OR REPLACE TABLE DW_PROD.REPORT.PAYROLL_EMPLOYEE_DERIVED_MONTHLY_METRICS (
	PAYROLL_MONTH DATE,
	EMPLOYEE_KEY VARCHAR(32),
	SOURCE_SYSTEM_ID NUMBER(38,0),
	ORIGINAL_SOURCE_SYSTEM_ID NUMBER(38,0),
	EMPLOYEE_ID VARCHAR(50),
	SYSTEM_CODE VARCHAR(50),
	EMPLOYEE_PID VARCHAR(32),
	EMPLOYEE_NUMBER VARCHAR(50),
	PAYROLL_ID VARCHAR(20),
	EMPLOYEE_CATEGORY VARCHAR(50),
	DERIVED_EMPLOYEE_CATEGORY VARCHAR(50),
	EMPLOYEE_FIRST_NAME VARCHAR(50),
	EMPLOYEE_LAST_NAME VARCHAR(50),
	EMPLOYEE_DOB DATE,
	EMPLOYEE_GENDER VARCHAR(12),
	EMPLOYEE_ETHNICITY VARCHAR(50),
	BRANCH_KEY VARCHAR(32),
	BRANCH_NAME VARCHAR(100),
	BRANCH_STATE_CODE VARCHAR(2),
	FIRST_PAYROLL_MONTH DATE,
	LAST_PAYROLL_MONTH DATE,
	TENURE_IN_MONTHS NUMBER(10,0),
	NUMBER_OF_MONTHS_WITH_PAYROLL NUMBER(10,0),
	NUMBER_OF_MONTHS_WITHOUT_PAYROLL NUMBER(10,0),
	NUMBER_OF_GAPS_IN_PAYROLL NUMBER(10,0),
	SMALLEST_GAP_IN_PAYROLL NUMBER(10,0),
	LARGEST_GAP_IN_PAYROLL NUMBER(10,0),
	PREVIOUS_MONTH_OF_PAYROLL DATE,
	NEXT_MONTH_OF_PAYROLL DATE,
	TOTAL_HOURS_PAID NUMBER(9,3),
	PREVIOUS_MONTH_TOTAL_HOURS_PAID NUMBER(9,3),
	PREVIOUS_2_MONTH_TOTAL_HOURS_PAID NUMBER(9,3),
	NEXT_MONTH_TOTAL_HOURS_PAID NUMBER(9,3),
	NEXT_2_MONTH_TOTAL_HOURS_PAID NUMBER(9,3),
	BILLABLE_HOURS NUMBER(9,3),
	TRAINING_HOURS_UNITS NUMBER(9,3),
	ACTIVE_FLAG BOOLEAN,
	OT NUMBER(9,3),
	UNION_FLAG BOOLEAN,
	EXEMPT_FLAG BOOLEAN,
	EMPLOYEE_TYPE VARCHAR(100),
	ACQUIRED_SYSTEM VARCHAR(50),
	ETL_TASK_KEY NUMBER(38,0),
	ETL_INSERTED_TASK_KEY NUMBER(38,0),
	ETL_INSERTED_DATE TIMESTAMP_NTZ(9),
	ETL_INSERTED_BY VARCHAR(16777216),
	ETL_LAST_UPDATED_DATE TIMESTAMP_NTZ(9),
	ETL_LAST_UPDATED_BY VARCHAR(16777216),
	ETL_DELETED_FLAG NUMBER(1,0)
);