CREATE OR REPLACE TABLE DW_PROD.REPORT.UTILIZATION (
	PERIOD_BEGIN_DATE DATE NOT NULL,
	STATE VARCHAR(2) NOT NULL,
	BRANCH_KEY VARCHAR(32) NOT NULL,
	ORIGINAL_BRANCH_KEY VARCHAR(32) NOT NULL,
	OFFICE_NUMBER NUMBER(38,0) NOT NULL,
	OFFICE_NAME VARCHAR(100) NOT NULL,
	SUPERVISOR_KEY VARCHAR(32),
	SUPERVISOR_CODE VARCHAR(100),
	CLIENT_KEY VARCHAR(32) NOT NULL,
	ORIGINAL_CLIENT_KEY VARCHAR(32) NOT NULL,
	CLIENT_NUMBER VARCHAR(50) NOT NULL,
	ORIGINAL_CLIENT_NUMBER VARCHAR(50) NOT NULL,
	ORIGINAL_SOURCE_SYSTEM_ID NUMBER(38,3),
	SOURCE_SYSTEM_ID NUMBER(38,3),
	CONTRACT_KEY VARCHAR(32) NOT NULL,
	CONTRACT_CODE VARCHAR(40) NOT NULL,
	VISITS_SCHEDULED NUMBER(18,0),
	VISITS_COMPLETED NUMBER(18,0),
	VISITS_CANCELLED NUMBER(18,0),
	VISITS_IN_REVIEW NUMBER(18,0),
	VISITS_MISSED NUMBER(18,0),
	VISITS_RESCHEDULED NUMBER(18,0),
	FUTURE_VISITS NUMBER(18,0),
	FUTURE_CANCELLED_VISITS NUMBER(18,0),
	FUTURE_HOLD_VISITS NUMBER(18,0),
	HOURS_SCHEDULED NUMBER(18,2),
	HOURS_SERVED NUMBER(38,3),
	HOURS_CANCELLED NUMBER(18,2),
	HOURS_IN_REVIEW NUMBER(18,2),
	HOURS_MISSED NUMBER(18,2),
	HOURS_RESCHEDULED NUMBER(18,2),
	FUTURE_HOURS NUMBER(18,2),
	FUTURE_HOURS_NO_CAREGIVER NUMBER(18,2),
	FUTURE_CANCELLED_HOURS NUMBER(18,2),
	FUTURE_HOLD_HOURS NUMBER(18,2),
	HOURS_BILLED NUMBER(38,3),
	HOURS_AUTHORIZED NUMBER(38,3),
	HOURS_AUTHORIZED_NON_ADJUSTED NUMBER(38,3),
	UTILIZATION NUMBER(38,9),
	OVER_AUTHED NUMBER(1,0) NOT NULL,
	OVER_AUTHED_ADJUSTED NUMBER(1,0),
	OVER_AUTHED_HOURS NUMBER(38,3),
	OVER_AUTHED_HOURS_ADJUSTED NUMBER(38,3),
	SERVED_WITHOUT_AUTH NUMBER(1,0) NOT NULL,
	VISITS_ALL NUMBER(38,3),
	VISITS_CLEAN_SHIFTS NUMBER(38,3),
	VISITS_NEED_MAINTENANCE NUMBER(38,3),
	CLIENT_SERVED_FLAG BOOLEAN,
	ABSOLUTE_FIRST_SERVICE_DATE DATE,
	ABSOLUTE_LAST_SERVICE_DATE DATE,
	NPS NUMBER(38,0),
	ETL_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_INSERTED_BY VARCHAR(100) NOT NULL,
	ETL_LAST_UPDATED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_LAST_UPDATED_BY VARCHAR(100) NOT NULL,
	ETL_DELETED_FLAG BOOLEAN NOT NULL,
	constraint PK_UTILIZATION_PERIOD_BEGIN_DATE_STATE_CLIENT_KEY_CONTRACT_KEY primary key (PERIOD_BEGIN_DATE, STATE, CLIENT_KEY, CONTRACT_KEY),
	constraint FK_UTILIZATION_STATE foreign key (STATE) references DW_PROD.HAH.DIM_STATE(STATE_ISO_CODE)
);