CREATE OR REPLACE TABLE DW_PROD.STAGE.DATAFLEXSYNCDATA_FACT_VISIT_HISTORY (
	VISIT_KEY VARCHAR(32) NOT NULL,
	REPORT_DATE DATE NOT NULL,
	BRANCH_KEY VARCHAR(32) NOT NULL,
	CLIENT_KEY VARCHAR(32) NOT NULL,
	CONTRACT_KEY VARCHAR(32) NOT NULL,
	EMPLOYEE_KEY VARCHAR(32) NOT NULL,
	SOURCE_SYSTEM_ID NUMBER(38,0) NOT NULL,
	SUPERVISOR_KEY VARCHAR(32) NOT NULL,
	SERVICE_DATE DATE NOT NULL,
	PAYROLL_DATE DATE,
	BRANCH_NAME VARCHAR(100),
	CLIENT_NUMBER NUMBER(38,0),
	CONTRACT_CODE VARCHAR(10),
	EMPLOYEE_ID VARCHAR(50),
	SYSTEM_CODE VARCHAR(20) NOT NULL,
	SUPERVISOR_CODE VARCHAR(50),
	CLEAN_SHIFT_FLAG BOOLEAN NOT NULL,
	STATUS_CODE VARCHAR(5),
	STATUS_DESCRIPTION VARCHAR(100),
	CANCEL_REASON_CODE VARCHAR(20) COMMENT 'Reason code for schedule cancellation',
	CANCEL_REASON_DESCRIPTION VARCHAR(100),
	CANCEL_REASON_NOTES VARCHAR(16777216),
	EXCEPTION_REASON_FLAG BOOLEAN NOT NULL DEFAULT FALSE,
	RESOLUTION_CODE VARCHAR(20),
	RESOLUTION_DESCRIPTION VARCHAR(100),
	REJECTION_CODE VARCHAR(20),
	REJECTION_DESCRIPTION VARCHAR(500),
	BILL_CODE VARCHAR(10),
	BILL_RATE NUMBER(15,3),
	OVERHEAD_RATE NUMBER(15,3),
	HOURS_SERVED NUMBER(38,3),
	COMMENTS VARCHAR(5000),
	IS_EVV_FLAG VARCHAR(1) COMMENT 'Record came from EVV feed',
	TIMESHEET_TYPE VARCHAR(1) COMMENT 'R = Regular, U = Make up, M = ?',
	TRACKING_ID NUMBER(38,0) COMMENT 'This an ID used by Chen''s code to link Sandata records to dataflex records',
	ETL_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_TASK_KEY NUMBER(38,0) NOT NULL,
	ETL_INSERTED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_INSERTED_BY VARCHAR(100) NOT NULL,
	ETL_LAST_UPDATED_DATE TIMESTAMP_NTZ(9) NOT NULL,
	ETL_LAST_UPDATED_BY VARCHAR(100) NOT NULL,
	ETL_DELETED_FLAG BOOLEAN NOT NULL
);