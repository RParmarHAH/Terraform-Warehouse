create or replace view DW_PROD.INTEGRATION.VW_DIM_CLIENT_GA(
	ID,
	CLIENT_NUMBER,
	SYSTEM_CODE,
	SOURCE_SYSTEM_ID,
	CLIENT_PID,
	CLIENT_DOB,
	CLIENT_FIRST_NAME,
	CLIENT_LAST_NAME,
	CLIENT_ADDRESS1,
	CLIENT_CITY,
	CLIENT_HOME_PHONE,
	LINKED_ID_SOURCE,
	LINKED_ID_MATCH
) as
SELECT TRIM(CLIENT_KEY) ID,TRIM(CLIENT_NUMBER) CLIENT_NUMBER,TRIM(SYSTEM_CODE) SYSTEM_CODE,TRIM(SOURCE_SYSTEM_ID) SOURCE_SYSTEM_ID,TRIM(CLIENT_PID) CLIENT_PID,TRIM(CLIENT_DOB) CLIENT_DOB,TRIM(CLIENT_FIRST_NAME) CLIENT_FIRST_NAME,TRIM(CLIENT_LAST_NAME) CLIENT_LAST_NAME,TRIM(CLIENT_ADDRESS1) CLIENT_ADDRESS1,TRIM(CLIENT_CITY) CLIENT_CITY,REGEXP_REPLACE( COALESCE(TRIM(CLIENT_HOME_PHONE),TRIM(CLIENT_CELL_PHONE)),'\\\\(|\\\\)|\\\\-|\\\\ ','') CLIENT_HOME_PHONE,TRIM(LINKED_ID_SOURCE) LINKED_ID_SOURCE ,TRIM(LINKED_ID_MATCH) LINKED_ID_MATCH  FROM (
  SELECT CASE WHEN SPLIT_PART(LINKED_ID::VARCHAR,'-',2) = 'SHC' THEN 'SHC_SAVANNAH' WHEN SPLIT_PART(LINKED_ID::VARCHAR,'-',2) = 'AL' THEN 'AL' WHEN SPLIT_PART(LINKED_ID::VARCHAR,'-',2) = 'IL' THEN 'IL' END     AS LINKED_ID_SOURCE,   SPLIT_PART(LINKED_ID::VARCHAR,'-',3) AS LINKED_ID_MATCH,*
  FROM DW_PROD.HAH.DIM_CLIENT WHERE (SOURCE_SYSTEM_ID =9 AND UPPER(SYSTEM_CODE) ='GEORGIA (1002)' AND (LINKED_ID NOT LIKE '%CLIENT%'  OR  LINKED_ID IS NULL) )
UNION SELECT SYSTEM_CODE AS LINKED_ID_SOURCE, CLIENT_NUMBER::VARCHAR AS LINKED_ID_MATCH,* FROM DW_PROD.HAH.DIM_CLIENT WHERE (SOURCE_SYSTEM_ID =3 AND SYSTEM_CODE ='GA') OR (SOURCE_SYSTEM_ID IN (1,2) ));