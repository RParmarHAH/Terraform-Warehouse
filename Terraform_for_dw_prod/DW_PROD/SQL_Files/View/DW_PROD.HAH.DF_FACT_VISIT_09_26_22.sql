create or replace view DW_PROD.HAH.DF_FACT_VISIT_09_26_22(
	VISIT_KEY,
	REPORT_DATE,
	BRANCH_KEY,
	CLIENT_KEY,
	CONTRACT_KEY,
	EMPLOYEE_KEY,
	SOURCE_SYSTEM_ID,
	SUPERVISOR_KEY,
	SERVICE_DATE,
	PAYROLL_DATE,
	BRANCH_NAME,
	CLIENT_NUMBER,
	CONTRACT_CODE,
	EMPLOYEE_ID,
	SYSTEM_CODE,
	SUPERVISOR_CODE,
	CLEAN_SHIFT_FLAG,
	STATUS_CODE,
	STATUS_DESCRIPTION,
	CANCEL_REASON_CODE,
	CANCEL_REASON_DESCRIPTION,
	CANCEL_REASON_NOTES,
	EXCEPTION_REASON_FLAG,
	RESOLUTION_CODE,
	RESOLUTION_DESCRIPTION,
	REJECTION_CODE,
	REJECTION_DESCRIPTION,
	BILL_CODE,
	BILL_RATE,
	OVERHEAD_RATE,
	HOURS_SERVED,
	COMMENTS,
	IS_EVV_FLAG,
	TIMESHEET_TYPE,
	TRACKING_ID,
	ETL_TASK_KEY,
	ETL_INSERTED_TASK_KEY,
	ETL_INSERTED_DATE,
	ETL_INSERTED_BY,
	ETL_LAST_UPDATED_DATE,
	ETL_LAST_UPDATED_BY,
	ETL_DELETED_FLAG
) as 
SELECT V.* FROM (DW_Prod.HAH.FACT_Visit AT (OFFSET => -60*60*12)) V
INNER JOIN DW_Prod.HAH.DIM_Branch AS b ON V.Branch_key = b.Branch_Key
WHERE b.Office_State_Code = 'IL'
AND v.Service_Date >= CAST( '2022-08-28' AS DATE)
--GROUP BY 1
ORDER BY 1, 2;