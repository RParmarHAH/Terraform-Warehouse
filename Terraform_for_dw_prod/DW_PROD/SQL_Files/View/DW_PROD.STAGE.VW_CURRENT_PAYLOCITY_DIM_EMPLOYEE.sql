create or replace view DW_PROD.STAGE.VW_CURRENT_PAYLOCITY_DIM_EMPLOYEE(
	EMPLOYEE_KEY
) as
WITH EMPLOYEE_CHECK_DATE AS 
(
SELECT
		COMPANYID,
		EMPLOYEEID AS EMPLOYEE_ID,
		MIN(CHECKDATE) AS FIRST_CHECK_DATE,
		MAX(CHECKDATE) AS LAST_CHECK_DATE
FROM
		DISC_PROD.PAYLOCITY.PAY_STATEMENT_SUMMARY
GROUP BY
		COMPANYID,
		EMPLOYEEID
)
SELECT
	DISTINCT
MD5(ED.COMPANYID || '-' || TRIM(EMPLOYEEID) || '-' || ' PAYLOCITY') AS EMPLOYEE_KEY
FROM DISC_DEDUPE_PROD.PAYLOCITY.EMPLOYEE_MASTER_LIST AS ED;