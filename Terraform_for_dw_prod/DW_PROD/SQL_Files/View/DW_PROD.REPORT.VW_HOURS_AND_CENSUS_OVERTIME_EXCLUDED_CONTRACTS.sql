create or replace view DW_PROD.REPORT.VW_HOURS_AND_CENSUS_OVERTIME_EXCLUDED_CONTRACTS(
	CONTRACT_KEY,
	SYSTEM_CODE,
	CONTRACT_CODE,
	REVENUE_CATEGORY,
	PAYOR_CODE
) as 
WITH INCLUDED_CONTRACTS AS (
	SELECT 'AL' AS DBNAME, 'Z' AS CONTRACTCODE UNION ALL
    SELECT 'IL' AS DBNAME, '37' AS CONTRACTCODE UNION ALL
    SELECT 'IL' AS DBNAME, 'RC' AS CONTRACTCODE UNION ALL
    SELECT 'IN' AS DBNAME, '8N' AS CONTRACTCODE UNION ALL
    SELECT 'IN' AS DBNAME, 'DN' AS CONTRACTCODE UNION ALL
    SELECT 'IN' AS DBNAME, 'R3' AS CONTRACTCODE UNION ALL
    SELECT 'IN' AS DBNAME, 'R4' AS CONTRACTCODE UNION ALL
    SELECT 'IN' AS DBNAME, 'R6' AS CONTRACTCODE UNION ALL
    SELECT 'IN' AS DBNAME, 'RB' AS CONTRACTCODE UNION ALL
    SELECT 'IN' AS DBNAME, 'RC' AS CONTRACTCODE UNION ALL
    SELECT 'IN' AS DBNAME, 'RI' AS CONTRACTCODE UNION ALL
    SELECT 'KY' AS DBNAME, 'CS' AS CONTRACTCODE UNION ALL
    SELECT 'KY' AS DBNAME, 'DP' AS CONTRACTCODE UNION ALL
    SELECT 'KY' AS DBNAME, 'F2' AS CONTRACTCODE UNION ALL
    SELECT 'KY' AS DBNAME, 'PA' AS CONTRACTCODE UNION ALL
    SELECT 'MI' AS DBNAME, '5' AS CONTRACTCODE UNION ALL
    SELECT 'MI' AS DBNAME, '6' AS CONTRACTCODE UNION ALL
    SELECT 'MI' AS DBNAME, 'Q' AS CONTRACTCODE UNION ALL
    SELECT 'MI' AS DBNAME, 'R' AS CONTRACTCODE UNION ALL
    SELECT 'MI' AS DBNAME, 'Y' AS CONTRACTCODE UNION ALL
    SELECT 'MO' AS DBNAME, 'CD' AS CONTRACTCODE UNION ALL
    SELECT 'MO' AS DBNAME, 'DH' AS CONTRACTCODE UNION ALL
    SELECT 'MO' AS DBNAME, 'HS' AS CONTRACTCODE UNION ALL
    SELECT 'MO' AS DBNAME, 'IP' AS CONTRACTCODE UNION ALL
    SELECT 'MO' AS DBNAME, 'R' AS CONTRACTCODE UNION ALL
    SELECT 'MO' AS DBNAME, 'U' AS CONTRACTCODE UNION ALL
    SELECT 'MO' AS DBNAME, 'UR' AS CONTRACTCODE UNION ALL
    SELECT 'MS' AS DBNAME, '3' AS CONTRACTCODE UNION ALL
    SELECT 'MS' AS DBNAME, '4' AS CONTRACTCODE UNION ALL
    SELECT 'MS' AS DBNAME, '5' AS CONTRACTCODE UNION ALL
    SELECT 'MS' AS DBNAME, '6' AS CONTRACTCODE UNION ALL
    SELECT 'MS' AS DBNAME, 'M' AS CONTRACTCODE UNION ALL
    SELECT 'MS' AS DBNAME, 'R1' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'AC' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'AD' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'B7' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'BA' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'BC' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'C1' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'C2' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'C3' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'C4' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'C5' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'C6' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'CA' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'CB' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'CC' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'CD' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'CE' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'HA' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'I1' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'I2' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'I3' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'I4' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'I5' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'I6' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'P2' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'PA' AS CONTRACTCODE UNION ALL
    SELECT 'TN' AS DBNAME, 'PB' AS CONTRACTCODE 
), EXCLUDED_CONTRACTS AS (
	SELECT CONTRACTS.CONTRACT_KEY, CONTRACTS.SYSTEM_CODE, CONTRACTS.CONTRACT_CODE, CONTRACTS.REVENUE_CATEGORY, CONTRACTS.PAYOR_CODE
	FROM DISC_PROD.DATAFLEXSYNCDATA.DFCONTRACTS DFCONTRACTS
	JOIN HAH.DIM_CONTRACT CONTRACTS
		ON CONTRACTS.SYSTEM_CODE = DFCONTRACTS.DBNAME AND CONTRACTS.CONTRACT_CODE = DFCONTRACTS.CONTRACTCODE 
	LEFT JOIN INCLUDED_CONTRACTS CONTRACTS_TO_INCLUDE
		ON CONTRACTS_TO_INCLUDE.DBNAME = DFCONTRACTS.DBNAME 
			AND CONTRACTS_TO_INCLUDE.CONTRACTCODE = DFCONTRACTS.CONTRACTCODE 
	WHERE (DFCONTRACTS.REVENUECATEGORY = 'CLS' OR DFCONTRACTS.PAYORCODE = 'BH')
		AND CONTRACTS_TO_INCLUDE.DBNAME IS NULL
) 
	SELECT CONTRACT_KEY, SYSTEM_CODE, CONTRACT_CODE, REVENUE_CATEGORY, PAYOR_CODE 
	FROM EXCLUDED_CONTRACTS;