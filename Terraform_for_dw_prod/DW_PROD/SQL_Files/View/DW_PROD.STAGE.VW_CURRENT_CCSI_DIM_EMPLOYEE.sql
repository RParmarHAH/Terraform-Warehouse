create or replace view DW_PROD.STAGE.VW_CURRENT_CCSI_DIM_EMPLOYEE(
	EMPLOYEE_KEY,
	EMPLOYEE_ID
) as
SELECT DISTINCT
     MD5(RECORD_NUMBER::STRING || '-' || NVL(AREA,'C')::STRING || '-' || 'CCSI') AS Employee_key
     ,TRY_CAST(DIM_EMPLOYEE_NUMBER AS NUMBER) AS Employee_ID 
FROM DISC_DEDUPE_PROD.CCSI.EMP_MASTER_LIST_CCSI EMP
LEFT JOIN DISC_PROD.CCSI.BRANCH_MAPPING B ON B.BRANCH_CODE = EMP.AREA
LEFT OUTER JOIN HAH.DIM_State AS st ON st.State_ISO_Code = UPPER( SUBSTRING(EMP.State, 1, 2))
LEFT OUTER JOIN HAH.DIM_Zip_Code AS zip ON UPPER( zip.Zip_Code) = UPPER( SUBSTRING(ZipCODE, 1, 5))
WHERE TRY_CAST(EMP.DIM_EMPLOYEE_NUMBER AS NUMBER) IS NOT NULL AND EMP.ETL_LAST_UPDATED_DATE >= '1900-01-01';