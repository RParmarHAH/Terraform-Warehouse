create or replace view DW_PROD.INTEGRATION.VW_DIM_EMPLOYEE_GA_FIRST(
	ID,
	SYSTEM_CODE,
	SOURCE_SYSTEM_ID,
	EMPLOYEE_ID,
	EMPLOYEE_PID,
	EMPLOYEE_DOB,
	EMPLOYEE_FIRST_NAME,
	EMPLOYEE_LAST_NAME,
	EMPLOYEE_ADDRESS1,
	EMPLOYEE_CITY,
	EMPLOYEE_HOME_PHONE,
	EMPLOYEE_PERSONAL_EMAIL
) as 
with q1 as (select DISTINCT EMPLOYEE_KEY AS ID,SYSTEM_CODE,SOURCE_SYSTEM_ID,EMPLOYEE_ID,EMPLOYEE_PID,EMPLOYEE_DOB,EMPLOYEE_FIRST_NAME,EMPLOYEE_LAST_NAME,EMPLOYEE_ADDRESS1,EMPLOYEE_CITY,COALESCE(EMPLOYEE_HOME_PHONE,EMPLOYEE_CELL_PHONE) AS EMPLOYEE_HOME_PHONE,EMPLOYEE_PERSONAL_EMAIL from DW_PROD.HAH.DIM_EMPLOYEE WHERE (SOURCE_SYSTEM_ID =3 AND SYSTEM_CODE ='GA') OR(SOURCE_SYSTEM_ID IN (1,2)) OR (SOURCE_SYSTEM_ID =9 AND SYSTEM_CODE ='GEORGIA (1002)')) select * from q1 where (EMPLOYEE_PID is not null or EMPLOYEE_DOB is not null);