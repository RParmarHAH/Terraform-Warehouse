create or replace view DW_PROD.INTEGRATION.GET_CROSSWALK_DATA(
	AMS_SOURCE_SYSTEM,
	PAYROLL_SOURCE_SYSTEM,
	EMPLOYEE_ENTERPRISE_ID,
	INACTIVE,
	EMPLOYEE_FIRST_NAME,
	EMPLOYEE_LAST_NAME,
	AMS_EMPLOYEE_ID,
	PAYROLL_EMPLOYEE_ID,
	GATOR_EMPLOYEE_ACCOUNT_ID,
	COACHUPCARE_ID,
	CARIBOU_ID_SENT,
	SERVICENOW_ID,
	DERIVED_WORKDAY_ID,
	WORKDAY_USERNAME,
	WORKDAY_INTERNAL_ID,
	BROADSPIRE_ID,
	OKTA_ID,
	OKTA_USERNAME,
	ACTIVE_DIRECTORY_SID,
	EMPLOYEE_RISKONNECT_ID,
	PAYROLL_ID,
	FIRST_NAME,
	LAST_NAME,
	STATE_CODE,
	AMS_EMPLOYEE_KEY,
	AMS_SOURCE_SYSTEM_ID,
	AMS_SYSTEM_CODE,
	PAYROLL_EMPLOYEE_KEY,
	PAYROLL_SOURCE_SYSTEM_ID,
	PAYROLL_SYSTEM_CODE,
	APPLICANT_EMPLOYEE_KEY,
	APPLICANT_SOURCE_SYSTEM_ID,
	APPLICANT_SYSTEM_CODE,
	APPLICANT_EMPLOYEE_ID,
	AMS_IVR_ID,
	GATOR_EMPLOYEE_KEY,
	ACTIVE_DIRECTORY_EMAIL,
	MOST_RECENT_SERVICE_DATE,
	MOST_RECENT_PAYROLL_DATE,
	AMS_PUBLIC_ID,
	EXCEPTION_FLAG,
	AMS_PAYROLL_ID,
	EMPLOYEE_SSN
) as
WITH CTE AS  (
SELECT DISTINCT
    UPPER(SS_AMS.SOURCE_SYSTEM) AS AMS_SOURCE_SYSTEM
    ,UPPER(SS_PAYROLL.SOURCE_SYSTEM) AS PAYROLL_SOURCE_SYSTEM     
	--,CW.EMPLOYEE_ENTERPRISE_ID
	,CW.WORKDAY_INTERNAL_ID AS EMPLOYEE_ENTERPRISE_ID
	,CW.INACTIVE,CW.FIRST_NAME AS EMPLOYEE_FIRST_NAME,CW.LAST_NAME AS EMPLOYEE_LAST_NAME
	,UPPER(CW.AMS_EMPLOYEE_ID) AS AMS_EMPLOYEE_ID
	,CW.PAYROLL_EMPLOYEE_ID,CW.GATOR_EMPLOYEE_ACCOUNT_ID,CW.COACHUPCARE_ID,CW.CARIBOU_ID_SENT
                        	,CW.SERVICENOW_ID,CW.DERIVED_WORKDAY_ID,CW.WORKDAY_USERNAME,CW.WORKDAY_INTERNAL_ID,CW.BROADSPIRE_ID,CW.OKTA_ID,CW.OKTA_USERNAME
							,CW.ACTIVE_DIRECTORY_SID,CW.EMPLOYEE_RISKONNECT_ID,CW.PAYROLL_EMPLOYEE_ID AS PAYROLL_ID,CW.FIRST_NAME,CW.LAST_NAME
							,CW.BRANCH_STATE_CODE AS STATE_CODE
							,CW.AMS_EMPLOYEE_KEY,CW.AMS_SOURCE_SYSTEM_ID,CW.AMS_SYSTEM_CODE,CW.PAYROLL_EMPLOYEE_KEY,CW.PAYROLL_SOURCE_SYSTEM_ID
							,CW.PAYROLL_SYSTEM_CODE,CW.APPLICANT_EMPLOYEE_KEY,CW.APPLICANT_SOURCE_SYSTEM_ID,CW.APPLICANT_SYSTEM_CODE
							,CW.APPLICANT_EMPLOYEE_ID,CW.AMS_IVR_ID,CW.GATOR_EMPLOYEE_KEY,CW.ACTIVE_DIRECTORY_EMAIL
							,CW.MOST_RECENT_SERVICE_DATE,CW.MOST_RECENT_PAYROLL_DATE,CW.AMS_PUBLIC_ID,CW.EXCEPTION_FLAG
							,CW.AMS_PAYROLL_ID, HEX_DECODE_STRING(CW.EMPLOYEE_SSN) AS EMPLOYEE_SSN				
FROM
	DW_PROD.INTEGRATION.EMPLOYEE_CROSS_WALK CW
LEFT JOIN DW_PROD.HAH.VW_DIM_Source_System_to_Market SS_AMS
                    	ON
	SS_AMS.SOURCE_SYSTEM_ID = CW.AMS_SOURCE_SYSTEM_ID
LEFT JOIN DW_PROD.HAH.VW_DIM_Source_System_to_Market SS_PAYROLL
                    	ON
	SS_PAYROLL.SOURCE_SYSTEM_ID = CW.PAYROLL_SOURCE_SYSTEM_ID
WHERE CW.INACTIVE <> TRUE AND CW.DUP_FLAG <> TRUE)
SELECT * FROM CTE;