create or replace view DW_PROD.REPORT.VW_EMPLOYEE_SUPERVISOR_BY_SERVICE_MONTH(
	SERVICE_MONTH,
	EMPLOYEE_KEY,
	BRANCH_KEY,
	BRANCH_STATE,
	BRANCH_NAME,
	EMPLOYEE_SYSTEM_CODE,
	EMPLOYEE_ID,
	EMPLOYEE_LAST_NAME,
	EMPLOYEE_CATEGORY,
	SUPERVISOR_KEY,
	SUPERVISOR_SYSTEM_CODE,
	SUPERVISOR_CODE,
	SUPERVISOR_NAME,
	ETL_TASK_KEY,
	ETL_INSERTED_TASK_KEY,
	ETL_INSERTED_DATE,
	ETL_INSERTED_BY,
	ETL_LAST_UPDATED_DATE,
	ETL_LAST_UPDATED_BY,
	ETL_DELETED_FLAG
) as
SELECT 
SERVICE_MONTH,
EMPLOYEE_KEY,
BRANCH_KEY,
BRANCH_STATE	,
BRANCH_NAME	,
EMPLOYEE_SYSTEM_CODE	,
EMPLOYEE_ID	,
EMPLOYEE_LAST_NAME	,
EMPLOYEE_CATEGORY	,
SUPERVISOR_KEY	,
SUPERVISOR_SYSTEM_CODE	,
SUPERVISOR_CODE	,
SUPERVISOR_NAME	,
ETL_TASK_KEY	,
ETL_INSERTED_TASK_KEY	,
ETL_INSERTED_DATE	,
ETL_INSERTED_BY	,
ETL_LAST_UPDATED_DATE	,
ETL_LAST_UPDATED_BY	,
ETL_DELETED_FLAG	
FROM REPORT.EMPLOYEE_SUPERVISOR_BY_SERVICE_MONTH
WHERE SERVICE_MONTH BETWEEN DATE_TRUNC('YEAR',DATEADD('YEAR',-2,CURRENT_DATE)) AND CURRENT_DATE;